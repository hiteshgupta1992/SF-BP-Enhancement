<apex:component >
    <!-- Component Attributes -->
    <apex:attribute name="uniqueId" required="true" type="String" description="unique Id for components here."/>
    <apex:attribute name="vendor" required="true" type="Account" description="Selected customer Id."/>
    <apex:attribute name="accountFieldsMap" required="true" type="String" description="Map to hold Account field API name to related JSON field name."/>
    
    <script>
        // JSON object for Vendor
        var {!uniqueId}VendorJSONRecord;
        
        // Account fields map:
        var accountFieldsMap = {!accountFieldsMap};
        
        // Fields map to process:
        var {!uniqueId}processingFieldsMap;
        
        // API field attribute value to access:
        var {!uniqueId}attrAPIField;
        
        // Vendor Id
        var {!uniqueId}VendorId = "{!JSENCODE(vendor.Id)}";
        
        // Boolean to keep track if any changes made to form
        var {!uniqueId}IsFormModified = false;
    </script>
    
    <script>
        $(document).ready( function(){
            setTimeout(function(){
                $("#{!uniqueId}VendorName").focus();
                {!uniqueId}copyAddressToShipping(document.getElementById("{!uniqueId}CopyAddress"));
            }, 3000);
        });
        
        $("input[accapi='Name']").attr("tabindex", 1);
        $("#{!uniqueId}Active__c").attr("tabindex", 3);
        
        $("input[accapi='BillingStreet']").attr("tabindex", 4);
        $("input[accapi='BillingCity']").attr("tabindex", 5);
        $("#{!uniqueId}BillingCountry").attr("tabindex", 6);
        $("#{!uniqueId}BillingState").attr("tabindex", 7);
        $("input[accapi='BillingPostalCode']").attr("tabindex", 8);
        
        //Shipping
        $("#{!uniqueId}CopyAddress").attr("tabindex", 9);
        $("input[accapi='ShippingStreet']").attr("tabindex", 10);
        $("input[accapi='ShippingCity']").attr("tabindex", 11);
        $("#{!uniqueId}ShippingCountry").attr("tabindex", 12);
        $("#{!uniqueId}ShippingState").attr("tabindex", 13);
        $("input[accapi='ShippingPostalCode']").attr("tabindex", 14);
        
        //$("input[accapi='Type__c']").attr("tabindex", 7);
        $("input[accapi='Phone']").attr("tabindex", 15);
        $("input[accapi='Mobile__c']").attr("tabindex", 16);
        $("input[accapi='Fax']").attr("tabindex", 17);
        $("input[accapi='Email__c']").attr("tabindex", 18);
        $("input[accapi='Website']").attr("tabindex", 19);
        $("input[accapi='Preferred_Contact__c']").attr("tabindex", 20);
        
        $("input[accapi='Purchase_Tax__c']").attr("tabindex", 21);
        $("#{!uniqueId}is_Customer").attr("tabindex", 22);
        $("input[accapi='Price_Level__c']").attr("tabindex", 23);
        $("input[accapi='Sales_Tax__c']").attr("tabindex", 24);
        $("input[accapi='VIP__c']").attr("tabindex", 25);
        $("#{!uniqueId}VendorSaveButton").attr("tabindex", 26);
        
        function {!uniqueId}CountryStateDropDownChangeCallBack(){
            {!uniqueId}IsFormModified = true;
        }
            
        // Method to handle drop down changes in form
        function {!uniqueId}PreferredContactonChangeDropDown(){
            {!uniqueId}IsFormModified = true;
            
            {!uniqueId}validateSelectedContactMethod();
        }
        
        // Method to handle drop down changes in form
        function {!uniqueId}PriceLevelChangeDropDown(){
            {!uniqueId}IsFormModified = true;
        }
        
        // Method to handle drop down changes in form
        function {!uniqueId}SalesTaxChangeDropDown(){
            {!uniqueId}IsFormModified = true;
        }       
    </script>    
    <body>
    
        <!-- Table for Top level elements in Vendor form -->
        <table width="100%" >
            <col width="30%" />
            <col width="30%" />
            <col width="30%" />
            
            <tr>
                <td >
                    <input type="text" id="{!uniqueId}VendorName" class="k-input k-textbox requiredField" 
                            placeholder="Name" accApi="Name" title="Name"/>
                    <script>
                        $("#{!uniqueId}VendorName").val('{!JSENCODE(vendor.Name)}');
                        $("#{!uniqueId}VendorName").focusout(function() {
                        
                            var nameStr = $(this).val().trim();
                            $(this).val(nameStr);
                            var validationErr = {!uniqueId}validateName();
                            if(validationErr == null){
                                $("#{!uniqueId}TabNameDiv").text(nameStr);
                                $("#{!uniqueId}TabNameDiv").attr("title", nameStr);
                            } else {
                                $("#{!uniqueId}TabNameDiv").text("New Vendor");
                                $("#{!uniqueId}TabNameDiv").attr("title", "New Vendor");
                            }
                        });
                        
                        $("#{!uniqueId}VendorName").change(function() {
                            {!uniqueId}IsFormModified = true;
                        });
                        
                        // Validation method for "Name"
                        function {!uniqueId}validateName(){
                            var nameFieldRegEx = /^[a-zA-Z ]{2,30}$/;           
                            
                            var validationErr;
                            var nameStr = $("#{!uniqueId}VendorName").val();
                            if(nameStr.length != 0){
                                if(nameFieldRegEx.test(nameStr) ){
                                    validationErr = null;
                                }else{
                                    validationErr = "Invalid";
                                }
                            }
                            else{
                                validationErr = "Required";
                            }   
                            $("#{!uniqueId}NameErr").remove();
                            if(validationErr != null){
                                $("<font>", {id: "{!uniqueId}NameErr", class: "errDiv", text: validationErr, click: function () {}}).insertAfter("#{!uniqueId}VendorName");
                            }else{
                            
                            }
                            
                            return validationErr;
                        }
                    </script>
                </td>
                <td >
                    <input type="text" id="{!uniqueId}VendorCode" class="k-input k-textbox k-state-disabled" 
                            placeholder="Vendor Code" accApi="Vendor_Code__c" title="Vendor Code"/>
                    <script>
                        $("#{!uniqueId}VendorCode").val('{!JSENCODE(vendor.Vendor_Code__c)}');
                    </script>
                </td>
                <td>
                    <input type="checkbox" id="{!uniqueId}Active__c" class="k-input k-checkbox" checked="checked"
                             accApi="Active__c" title="Active"/>
                    Active
                    <script>
                        if({!uniqueId}VendorId.length != 0) {
                            $('#{!uniqueId}Active__c').prop('checked', {!vendor.Active__c});
                        }
                        {!uniqueId}SetActiveCheckboxTooltip();
                        
                        $("#{!uniqueId}Active__c").change(function() {
                            {!uniqueId}IsFormModified = true;
                            
                            {!uniqueId}SetActiveCheckboxTooltip();
                        });
                        
                        // Set tooltip for Active checkbox
                        function {!uniqueId}SetActiveCheckboxTooltip(){
                            var activeElem = $('#{!uniqueId}Active__c');
                            var isActive = activeElem.is(':checked');
                            if(isActive){
                                activeElem.attr("title", "Active");
                            }else{
                                activeElem.attr("title", "In-Active");
                            }
                        }
                    </script>
                </td>
            </tr>
            
            
            <tr>
                <td colspan="6" >
                    <div  style="width:98%">
                        <hr  style="border:solid 1px #F0F0F0"/>
                    </div>
                </td>
            </tr>
            
            <tr>
                <td>
                    <B>Billing Information</B>
                </td>
                <td>
                    <div style="float:left; width:125px; margin-top: 5px;">
                        <B>Shipping Address</B>
                    </div>
                    <div style="float:left; width:125px;">
                        <input type="checkbox" id="{!uniqueId}CopyAddress" class="k-input" title="Same as Billing Information" accApi="SA_same_as_BA__c"
                                onClick="{!uniqueId}IsFormModified = true; {!uniqueId}copyAddressToShipping(this);"/>
                        <script>
                            $("#{!uniqueId}CopyAddress").prop('checked', {!vendor.SA_same_as_BA__c});
                        </script>
                    </div>
                    <div style="clear:both"></div>
                </td>
                <td>
                    <B>Contact Information</B>
                </td>
            </tr>
            
            
            <tr>
                <td>
                    <input type="text" id="{!uniqueId}BillingStreet" class="k-input k-textbox"  maxlength="255"
                            placeholder="Billing Street" accApi="BillingStreet" title="Billing Street"/>
                    <script>
                        $("#{!uniqueId}BillingStreet").val('{!JSENCODE(vendor.BillingStreet)}');
                        $("#{!uniqueId}BillingStreet").change(function() {
                            {!uniqueId}IsFormModified = true;
                        });
                    </script>
                </td>
                
                
                <td>
                    <input type="text" id="{!uniqueId}ShippingStreet" class="k-input k-textbox" maxlength="255"
                            placeholder="Shipping Street" accApi="ShippingStreet" title="Shipping Street"/>
                    <script>
                        $("#{!uniqueId}ShippingStreet").val('{!JSENCODE(vendor.ShippingStreet)}');
                        $("#{!uniqueId}ShippingStreet").change(function() {
                            {!uniqueId}IsFormModified = true;
                        });
                    </script>
                </td>
                
                <td>
                    <input type="text" id="{!uniqueId}Phone" class="k-input requiredField" 
                            placeholder="Phone" accApi="Phone" title="Phone"/>
                    <script>
                        $("#{!uniqueId}Phone").kendoMaskedTextBox({
                            mask: "999-000-0000"
                        });
                        $("#{!uniqueId}Phone").val('{!JSENCODE(vendor.Phone)}');
                        
                        $("#{!uniqueId}Phone").focusout(function() {
                            {!uniqueId}IsFormModified = true;
                            var phoneStr = $(this).val().trim();
                            $(this).val(phoneStr);
                            var validationErr = {!uniqueId}validatePhone();
                        });

                        // Validation method for "Phone"
                        function {!uniqueId}validatePhone(){
                            //var phoneRegEx = /^([0-9\(\)\/\+ \-]*)$/;
                            var phoneStr = $("#{!uniqueId}Phone").val().trim();
                            
                            var validationErr;
                            if(phoneStr.length == 0){
                                validationErr = "Required";
                            } else if(!(phoneStr.indexOf('_')==-1)){
                                validationErr = "Invalid";
                            }
                            
                            $("#{!uniqueId}PhoneErr").remove();
                            if(validationErr != null){
                                $("<font>", {id: "{!uniqueId}PhoneErr", class: "errDiv", text: validationErr, click: function () {}}).insertAfter("#{!uniqueId}Phone");
                            }else{
                            }
                            
                            return validationErr;
                        }
                    </script>
                </td>
            </tr>
            
            <tr>
                <td>
                    <input type="text" id="{!uniqueId}BillingCity" class="k-input k-textbox" 
                            placeholder="Billing City" accApi="BillingCity" title="Billing City"/>
                    <script>
                        $("#{!uniqueId}BillingCity").val('{!JSENCODE(vendor.BillingCity)}');
                        $("#{!uniqueId}BillingCity").focusout(function() {
                            {!uniqueId}IsFormModified = true;
                            var cityStr = $(this).val().trim();
                            $(this).val(cityStr);
                            var validationErr = {!uniqueId}validateBillingCity();
                        });
                        
                        // Validation method for "BillingCity"
                        function {!uniqueId}validateBillingCity(){
                            var billingCityRegEx = /^[a-zA-Z ]{0,80}$/;
                            var billingCityStr = $("#{!uniqueId}BillingCity").val().trim();
                            
                            var validationErr;
                            if( !billingCityRegEx.test(billingCityStr) ){
                                validationErr = "Invalid";
                            }
                            
                            $("#{!uniqueId}BillingCityErr").remove();
                            if(validationErr != null){
                                $("<font>", {id: "{!uniqueId}BillingCityErr", class: "errDiv", text: validationErr, click: function () {}}).insertAfter("#{!uniqueId}BillingCity");
                            }else{
                            }
                            
                            return validationErr;
                        }
                    </script>
                </td>
                
                <td>
                    <input type="text" id="{!uniqueId}ShippingCity" class="k-input k-textbox" 
                            placeholder="Shipping City" accApi="ShippingCity" title="Shipping City"/>
                    <script>
                        $("#{!uniqueId}ShippingCity").val('{!JSENCODE(vendor.ShippingCity)}');
                        $("#{!uniqueId}ShippingCity").focusout(function() {
                            var cityStr = $(this).val().trim();
                            $(this).val(cityStr);
                            var validationErr = {!uniqueId}validateShippingCity();
                        });
                        
                        $("#{!uniqueId}ShippingCity").change(function() {
                            {!uniqueId}IsFormModified = true;
                        });
                        
                        // Validation method for "ShippingCity"
                        function {!uniqueId}validateShippingCity(){
                            var shippingCityRegEx = /^[a-zA-Z ]{0,80}$/;
                            var shippingCityStr = $("#{!uniqueId}ShippingCity").val().trim();
                            
                            var validationErr;
                            if( !shippingCityRegEx.test(shippingCityStr) ){
                                validationErr = "Invalid";
                            }
                            
                            $("#{!uniqueId}ShippingCityErr").remove();
                            if(validationErr != null){
                                $("<font>", {id: "{!uniqueId}ShippingCityErr", class: "errDiv", text: validationErr, click: function () {}}).insertAfter("#{!uniqueId}ShippingCity");
                            }else{
                            }
                            
                            return validationErr;
                        }
                    </script>
                </td>
                
                <td>
                    <input type="text" id="{!uniqueId}Mobile__c" class="k-input" 
                            placeholder="Cell" accApi="Mobile__c" title="Cell"/>
                    <script>
                        $("#{!uniqueId}Mobile__c").kendoMaskedTextBox({
                            mask: "999-000-0000"
                        });
                        $("#{!uniqueId}Mobile__c").val('{!JSENCODE(vendor.Mobile__c)}');
                        $("#{!uniqueId}Mobile__c").focusout(function() {
                            {!uniqueId}IsFormModified = true;
                            var mobStr = $(this).val().trim();
                            $(this).val(mobStr);
                            var validationErr = {!uniqueId}validateMobile();
                        });
                        
                        // Validation method for "Mobile"
                        function {!uniqueId}validateMobile(){
                            //var mobRegEx = /^(?:\+?88)?01[15-9]\d{8}$/;
                            var mobStr = $("#{!uniqueId}Mobile__c").val().trim();
                            
                            var validationErr;
                            if(mobStr.length != 0 && !(mobStr.indexOf('_')==-1)){
                                validationErr = "Invalid";
                            }
                            
                            $("#{!uniqueId}MobErr").remove();
                            if(validationErr != null){
                                $("<font>", {id: "{!uniqueId}MobErr", class: "errDiv", text: validationErr, click: function () {}}).insertAfter("#{!uniqueId}Mobile__c");
                            }else{
                            }
                            
                            return validationErr;
                        }
                    </script>
                </td>
            </tr>
            
            <tr>
                <td>
                    <input type="text" id="{!uniqueId}BillingCountry" accApi="BillingCountry" title="Billing Country" style="width: 160px;"/>
                </td>
            
                <td>
                    <input type="text" id="{!uniqueId}ShippingCountry" accApi="ShippingCountry" title="Shipping Country" style="width: 160px;"/>
                </td>
                
                <td>
                    <input type="text" id="{!uniqueId}Fax" class="k-input" 
                            placeholder="Fax" accApi="Fax" title="Fax"/>
                    <script>
                        $("#{!uniqueId}Fax").kendoMaskedTextBox({
                            mask: "999-000-0000"
                        });
                        $("#{!uniqueId}Fax").val('{!JSENCODE(vendor.Fax)}');
                        $("#{!uniqueId}Fax").focusout(function() {
                            {!uniqueId}IsFormModified = true;
                            var faxStr = $(this).val().trim();
                            $(this).val(faxStr);
                            var validationErr = {!uniqueId}validateFax();
                        });
                        
                        // Validation method for "Fax"
                        function {!uniqueId}validateFax(){
                            //var faxRegEx = /((\(\d{3}\) ?)|(\d{3}-))?\d{3}-\d{4}/;
                            var faxStr = $("#{!uniqueId}Fax").val().trim();
                            
                            var validationErr;
                            if(faxStr.length != 0 && !(faxStr.indexOf('_')==-1)){
                                validationErr = "Invalid";
                            }
                            
                            $("#{!uniqueId}FaxErr").remove();
                            if(validationErr != null){
                                $("<font>", {id: "{!uniqueId}FaxErr", class: "errDiv", text: validationErr, click: function () {}}).insertAfter("#{!uniqueId}Fax");
                            }else{
                            }
                            
                            return validationErr;
                        }
                    </script>
                </td>
            </tr>
            
            
            <tr>
                <td>
                    <input type="text" id="{!uniqueId}BillingState" accApi="BillingState" title="Billing State" style="width: 160px;"/>
                    <c:CountryStateDropdown uniqueId="Billing" countryElemId="{!uniqueId}BillingCountry" stateElemId="{!uniqueId}BillingState" callbackMethodName="{!uniqueId}CountryStateDropDownChangeCallBack"
                                            selectedCountryValue="{!JSENCODE(vendor.BillingCountry)}" selectedStateValue="{!JSENCODE(vendor.BillingState)}" />
                </td>
                
                <td>
                    <input type="text" id="{!uniqueId}ShippingState" accApi="ShippingState" title="Shipping State" style="width: 160px;"/>
                    <c:CountryStateDropdown uniqueId="Shipping" countryElemId="{!uniqueId}ShippingCountry" stateElemId="{!uniqueId}ShippingState" callbackMethodName="{!uniqueId}CountryStateDropDownChangeCallBack"
                                            selectedCountryValue="{!JSENCODE(vendor.ShippingCountry)}" selectedStateValue="{!JSENCODE(vendor.ShippingState)}" 
                                            countryDisabled="{!vendor.SA_same_as_BA__c}" stateDisabled="{!vendor.SA_same_as_BA__c}"/>
                </td>
                
                <td>
                    <input type="text" id="{!uniqueId}Email__c" class="k-input k-textbox requiredField" 
                            placeholder="Email" accApi="Email__c" title="Email"/>
                    <script>
                        $("#{!uniqueId}Email__c").val('{!JSENCODE(vendor.Email__c)}');
                        $("#{!uniqueId}Email__c").focusout(function() {
                            var emailStr = $(this).val().trim();
                            $(this).val(emailStr);
                            var validationErr = {!uniqueId}validateEmail();
                        });
                        
                        $("#{!uniqueId}Email__c").change(function() {
                            {!uniqueId}IsFormModified = true;
                        });
                        
                        // Validation method for "Email"
                        function {!uniqueId}validateEmail(){
                            var emailRegEx = /^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$/;
                            var emailStr = $("#{!uniqueId}Email__c").val().trim();
                            
                            var validationErr;
                            if(emailStr.length == 0){
                                validationErr = "Required";
                            }else if( emailRegEx.test(emailStr) ){
                                validationErr = null;
                            }else{
                                validationErr = "Invalid";
                            }
                            
                            $("#{!uniqueId}EmailErr").remove();
                            if(validationErr != null){
                                $("<font>", {id: "{!uniqueId}EmailErr", class: "errDiv", text: validationErr, click: function () {}}).insertAfter("#{!uniqueId}Email__c");
                            }else{
                            }
                            
                            return validationErr;
                        }
                    </script>
                </td>
            </tr>
            
            <tr>
                <td>
                    <input type="text" id="{!uniqueId}BillingPostalCode" class="k-input k-textbox requiredField" maxlength="6" 
                            placeholder="Postal/Zip Code" accApi="BillingPostalCode" title="Postal/Zip Code"/>
                    <script>
                        $("#{!uniqueId}BillingPostalCode").val('{!JSENCODE(vendor.BillingPostalCode)}');
                        $("#{!uniqueId}BillingPostalCode").focusout(function() {
                            var billingPostalCode = $(this).val().trim();
                            $(this).val(billingPostalCode);
                            var validationErr = {!uniqueId}validateBillingPostalCode();
                        });
                        
                        $("#{!uniqueId}BillingPostalCode").change(function() {
                            {!uniqueId}IsFormModified = true;
                        });
                        
                        $('#{!uniqueId}BillingPostalCode').keyup(function(){
                            this.value = this.value.toUpperCase();
                        });
                        
                        // Validation method for "validateBillingPostalCode"
                        function {!uniqueId}validateBillingPostalCode(){
                            var billingPostalCodeFieldRegEx = /^[a-zA-Z0-9 ]{4,6}$/;
                            var billingPostalCode = $("#{!uniqueId}BillingPostalCode").val().trim();
                            
                            var validationErr;
                            if(billingPostalCode.length == 0){
                                validationErr = "Required";
                            }else if( billingPostalCodeFieldRegEx.test(billingPostalCode) ){
                                validationErr = null;
                            }else{
                                validationErr = "Invalid";
                            }
                            
                            $("#{!uniqueId}BillingPostalCodeErr").remove();
                            if(validationErr != null){
                                $("<font>", {id: "{!uniqueId}BillingPostalCodeErr", class: "errDiv", text: validationErr, click: function () {}}).insertAfter("#{!uniqueId}BillingPostalCode");
                            }else{
                            }
                            
                            return validationErr;
                        }
                    </script>
                </td>
                
                
                <td>
                    <input type="text" id="{!uniqueId}ShippingPostalCode" class="k-input k-textbox requiredField" maxlength="6" 
                            placeholder="Postal/Zip Code" accApi="ShippingPostalCode" title="Postal/Zip Code"/>
                    <script>
                        $("#{!uniqueId}ShippingPostalCode").val('{!JSENCODE(vendor.ShippingPostalCode)}');
                        $("#{!uniqueId}ShippingPostalCode").focusout(function() {
                            var shippingPostalCode = $(this).val().trim();
                            $(this).val(shippingPostalCode);
                            var validationErr = {!uniqueId}validateShippingPostalCode();
                        });
                        
                        $('#{!uniqueId}ShippingPostalCode').keyup(function(){
                            this.value = this.value.toUpperCase();
                        });
                        
                        $("#{!uniqueId}ShippingPostalCode").change(function() {
                            {!uniqueId}IsFormModified = true;
                        });
                        
                        // Validation method for "validateShippingPostalCode"
                        function {!uniqueId}validateShippingPostalCode(){
                            var shippingPostalCodeFieldRegEx = /^[a-zA-Z0-9 ]{4,6}$/;
                            var shippingPostalCode = $("#{!uniqueId}ShippingPostalCode").val().trim();
                            
                            var validationErr;
                            if(shippingPostalCode.length == 0){
                                validationErr = "Required";
                            }else if( shippingPostalCodeFieldRegEx.test(shippingPostalCode) ){
                                validationErr = null;
                            }else{
                                validationErr = "Invalid";
                            }
                            
                            $("#{!uniqueId}ShippingPostalCodeErr").remove();
                            if(validationErr != null){
                                $("<font>", {id: "{!uniqueId}ShippingPostalCodeErr", class: "errDiv", text: validationErr, click: function () {}}).insertAfter("#{!uniqueId}ShippingPostalCode");
                            }else{
                            }
                            
                            return validationErr;
                        }
                    </script>
                </td>
                <td>
                    <input type="text" id="{!uniqueId}Website__c" class="k-input k-textbox" 
                            placeholder="Website" accApi="Website" title="Website"/>
                    <script>
                        $("#{!uniqueId}Website__c").val('{!JSENCODE(vendor.Website)}');
                        $("#{!uniqueId}Website__c").focusout(function() {
                            var websiteStr = $(this).val().trim();
                            $(this).val(websiteStr);
                            var validationErr = {!uniqueId}validateWebAddress();
                        });
                        
                        $("#{!uniqueId}Website__c").change(function() {
                            {!uniqueId}IsFormModified = true;
                        });
                        
                        // Validation method for "Web Address"
                        function {!uniqueId}validateWebAddress(){
                            var WebsiteRegEx = /[-a-zA-Z0-9@:%_\+.~#?&//=]{2,256}\.[a-z]{2,4}\b(\/[-a-zA-Z0-9@:%_\+.~#?&//=]*)?/;
                            var websiteStr = $("#{!uniqueId}Website__c").val().trim();
                            
                            var validationErr;
                            if(websiteStr.length == 0 ||  WebsiteRegEx.test(websiteStr) ){
                                validationErr = null;
                            }else{
                                validationErr = "Invalid";
                            }
                            
                            $("#{!uniqueId}WebsiteErr").remove();
                            if(validationErr != null){
                                $("<font>", {id: "{!uniqueId}WebsiteErr", class: "errDiv", text: validationErr, click: function () {}}).insertAfter("#{!uniqueId}Website__c");
                            }else{
                            }
                            
                            return validationErr;
                        }
                    </script>
                </td>
            </tr>
            
            <tr>
                <td>
                
                </td>
                <td>
                
                </td>
                <td>
                    <input type="text" id="{!uniqueId}PreferredMethod" accApi="Preferred_Contact__c" 
                            title="Preferred contact method" style="width: 160px;"/>
                    <c:SObjectFieldDropdown uniqueId="PreferredContact" elementId="{!uniqueId}PreferredMethod" callbackMethodName="{!uniqueId}PreferredContactonChangeDropDown"
                        sObjName="Account" fieldName="Preferred_Contact__c" preSelectedValue="{!JSENCODE(vendor.Preferred_Contact__c)}" />
                </td>
                
            </tr>
            
            <tr>
                <td colspan="6" >
                    <div  style="width:98%">
                        <hr  style="border:solid 1px #F0F0F0"/>
                    </div>
                </td>
            </tr>
        </table>
        
        <table width="100%">
            <col width="15%" />
            <col width="30%" />
            <col width="45%" />
            
            <tr>
                <td>
                    Purchase Tax Group
                </td>
                <td>
                    <input type="text" id="{!uniqueId}PurchaseTax" accApi="Purchase_Tax__c" conApi="Purchase_Tax__c" 
                            title="Purchase Tax Group" style="width: 160px;"/>
                    
                    <c:SObjectLookupDropdown uniqueId="PurchaseTax" elementId="{!uniqueId}PurchaseTax" callbackMethodName="{!uniqueId}SalesTaxChangeDropDown"
                        sObjName="Sales_Tax__c" displayFieldName="Name__c" preSelectedValue="{!JSENCODE(vendor.Purchase_Tax__c)}" />
                </td>
                
                <td>
                    <input type="checkbox" id="{!uniqueId}is_Customer" class="k-input k-checkbox" accApi="Is_Customer__c"/>
                    Is Customer
                    <script>
                        $('#{!uniqueId}is_Customer').prop('checked', {!vendor.Is_Customer__c});
                        {!uniqueId}SetActiveCustomerPanel();
                        
                        $("#{!uniqueId}is_Customer").change(function() {
                            {!uniqueId}IsFormModified = true;
                            
                            {!uniqueId}SetActiveCustomerPanel();
                        });
                        
                        // Set tooltip for Active checkbox
                        function {!uniqueId}SetActiveCustomerPanel(){
                            var activeElem = $('#{!uniqueId}is_Customer');
                            var isCustomer = activeElem.is(':checked');
                            
                            if($("#{!uniqueId}PriceLevel").data("kendoDropDownList") != null){
                                $("#{!uniqueId}PriceLevel").data("kendoDropDownList").enable(isCustomer);
                            }
                            if($("#{!uniqueId}SalesTax").data("kendoDropDownList") != null){
                                $("#{!uniqueId}SalesTax").data("kendoDropDownList").enable(isCustomer);
                            }
                            
                            if(isCustomer){
                                $('#{!uniqueId}VIP__c').removeAttr("disabled");
                            }else{
                                $('#{!uniqueId}VIP__c').attr("disabled", "disabled");
                            }
                        }
                        
                        if( {!uniqueId}VendorId != "" && {!vendor.Is_Customer__c} ){
                            $('#{!uniqueId}is_Customer').attr("disabled", "disabled");
                        }
                    </script>
                </td>
            </tr>
        </table>
        
        <table width="100%" id="{!uniqueId}customerPanel" >
            <col width="30%" />
            <col width="35%" />
            <col width="25%" />
            <col width="10%" />
            
            <tr>
                <td colspan="4" >
                    <div  style="width:98%">
                        <hr  style="border:solid 1px #F0F0F0"/>
                    </div>
                </td>
            </tr>
            
            <tr>
                <td>
                    Price Level
                    &nbsp;&nbsp;
                    <input type="text" id="{!uniqueId}PriceLevel" accApi="Price_Level__c" conApi="Price_Level__c" 
                            title="Price Level" style="width: 160px;"/>
                    
                    <c:SObjectLookupDropdown uniqueId="PriceLevel" elementId="{!uniqueId}PriceLevel" callbackMethodName="{!uniqueId}PriceLevelChangeDropDown"
                        sObjName="Price_Level__c" displayFieldName="Name__c" preSelectedValue="{!JSENCODE(vendor.Price_Level__c)}" disabled="{!!vendor.Is_Customer__c}"/>
                </td>
                
                <td>
                    Sales Tax Group
                    &nbsp;&nbsp;
                    <input type="text" id="{!uniqueId}SalesTax" accApi="Sales_Tax__c" conApi="Sales_Tax__c" 
                            title="Sales Tax Group" style="width: 160px;"/>
                    
                    <c:SObjectLookupDropdown uniqueId="SalesTax" elementId="{!uniqueId}SalesTax" callbackMethodName="{!uniqueId}SalesTaxChangeDropDown"
                        sObjName="Sales_Tax__c" displayFieldName="Name__c" preSelectedValue="{!JSENCODE(vendor.Sales_Tax__c)}" disabled="{!!vendor.Is_Customer__c}"/>
                </td>
                
                <td>
                    VIP#
                    &nbsp;&nbsp;
                    <input type="text" id="{!uniqueId}VIP__c" class="k-input k-textbox" maxlength="30"
                            placeholder="VIP#" accApi="VIP__c" conApi="VIP__c" title="VIP#"/>
                    <script>
                        $("#{!uniqueId}VIP__c").val('{!JSENCODE(vendor.VIP__c)}');
                        $("#{!uniqueId}VIP__c").focusout(function() {
                            var vipStr = $(this).val().trim();
                            $(this).val(vipStr);
                            var validationErr = {!uniqueId}validateVIP();
                        });
                        
                        $("#{!uniqueId}VIP__c").change(function() {
                            {!uniqueId}IsFormModified = true;
                        });
                        
                        // Validation method for "VIP#"
                        function {!uniqueId}validateVIP(){
                            var vipFieldRegEx = /^[a-zA-Z0-9 ]{0,30}$/;
                            var vipStr = $("#{!uniqueId}VIP__c").val().trim();
                            
                            var validationErr;
                            if( vipFieldRegEx.test(vipStr) ){
                                validationErr = null;
                            }else{
                                validationErr = "Invalid";
                            }
                            
                            $("#{!uniqueId}VIPErr").remove();
                            if(validationErr != null){
                                $("<font>", {id: "{!uniqueId}VIPErr", class: "errDiv", text: validationErr, click: function () {}}).insertAfter("#{!uniqueId}VIP__c");
                            }else{
                            }
                            
                            return validationErr;
                        }
                    </script>
                </td>
                
                <td>
                    <div style="float: right;" id="{!uniqueId}VendorSaveButtonDiv_Lower"> 
                        <input type="button" id="{!uniqueId}VendorSaveButton" value="Save" onClick="{!uniqueId}saveVendorRecord();" class="k-button customerDetailButton"/>      
                    </div>
                </td>
            </tr>
        </table>
    </body>
    
     <script>
        // Method used to copy Billing address to shipping address
        function {!uniqueId}copyAddressToShipping(element){
            if(element.checked) {
                $("#{!uniqueId}ShippingStreet").attr('disabled', 'disabled');
                $("#{!uniqueId}ShippingCity").attr('disabled', 'disabled');
                $("#{!uniqueId}ShippingPostalCode").attr('disabled', 'disabled');
                
                if($("#{!uniqueId}ShippingCountry") != null && $("#{!uniqueId}ShippingCountry").data("kendoDropDownList") != null){
                    $("#{!uniqueId}ShippingCountry").data("kendoDropDownList").enable(false);
                }
                if($("#{!uniqueId}ShippingCountry") != null && $("#{!uniqueId}ShippingCountry").data("kendoDropDownList") != null){
                    $("#{!uniqueId}ShippingState").data("kendoDropDownList").enable(false);
                }
                
                $("#{!uniqueId}ShippingPostalCodeErr").remove();
            } else {
                $("#{!uniqueId}ShippingStreet").removeAttr('disabled', 'disabled');
                $("#{!uniqueId}ShippingCity").removeAttr('disabled', 'disabled');
                $("#{!uniqueId}ShippingPostalCode").removeAttr('disabled', 'disabled');
                if($("#{!uniqueId}ShippingCountry") != null && $("#{!uniqueId}ShippingCountry").data("kendoDropDownList") != null){
                    $("#{!uniqueId}ShippingCountry").data("kendoDropDownList").enable(true);
                }
                if($("#{!uniqueId}ShippingCountry") != null && $("#{!uniqueId}ShippingCountry").data("kendoDropDownList") != null){
                    $("#{!uniqueId}ShippingState").data("kendoDropDownList").enable(true);
                }
            }
        }
        
        // Method to validate if selected preferred contact is not empty
        function {!uniqueId}validateSelectedContactMethod(){
            var selectedContactMethod = $("#{!uniqueId}PreferredMethod").data("kendoDropDownList").text();
            var selectedContact = $("input[placeHolder='"+selectedContactMethod+"'][Id*='{!uniqueId}']");
            
            $("#{!uniqueId}PreferredContactErr").remove();
            if(selectedContact.val().trim().length == 0){
                validationErr = "Cannot be empty since preferred contact";
                $("<font>", {id: "{!uniqueId}PreferredContactErr", class: "errDiv", text: validationErr, click: function () {}}).insertAfter(selectedContact);
                selectedContact.attr("prevErrElem", "Error");
            }else{
                validationErr = null;
            }
            
            return validationErr;
        }
        
        // method to save the customer record
        function {!uniqueId}saveVendorRecord(){
            if({!uniqueId}validateForm()){
                // Disable Save button
                $("#{!uniqueId}VendorSaveButton").attr("disabled", "disabled");
                
                {!uniqueId}createVendorJSON();
                var vendorRecValue = JSON.stringify({!uniqueId}vendorJSONRecord);
                saveVendorDetails(vendorRecValue, "{!uniqueId}", {!uniqueId}VendorSaveCallBack);
                {!uniqueId}IsFormModified = false;
            }
        }
        
        // Save callback method for Vendor
        function {!uniqueId}VendorSaveCallBack(savedVendorId){
            {!uniqueId}VendorId = savedVendorId;

            if( $("#{!uniqueId}is_Customer").is(':checked') ){
                // Make the Customer checkbox disabled in the case if Vendor-cum-Customer
                $('#{!uniqueId}is_Customer').attr("disabled", "disabled");
                {!uniqueId}SetActiveCustomerPanel();
            }
            
            // Enable Save button
            $("#{!uniqueId}VendorSaveButton").removeAttr("disabled");
        }
        
        // method to check if any changes in the form and then remove tab
        function {!uniqueId}preRemoveSelecedTab(selectedTab, selectedVendorId){
            anyChangesInCustomerClosingTab = {!uniqueId}IsFormModified;
            selectedVendorId = (selectedVendorId == null || selectedVendorId == "null" || selectedVendorId.length == 0) ? {!uniqueId}VendorId : selectedVendorId;
            removeSelecedTab(selectedTab, selectedVendorId, anyChangesInCustomerClosingTab);
        }
        
        // Method to validate form, returns true if validated successfully
        function {!uniqueId}validateForm(){
            var sucessfullyValidated = true;
            var validationErr;
            
            // Validate FirstName:
            validationErr = {!uniqueId}validateName();
            if(validationErr != null){
                sucessfullyValidated = false;
            }
            
            // Validate Phone:
            validationErr = {!uniqueId}validatePhone();
            if(validationErr != null){
                sucessfullyValidated = false;
            }
            
            // Validate Mobile:
            validationErr = {!uniqueId}validateMobile();
            if(validationErr != null){
                sucessfullyValidated = false;
            }
            
            // Validate Fax:
            validationErr = {!uniqueId}validateFax();
            if(validationErr != null){
                sucessfullyValidated = false;
            }
            
            // Validate Email:
            validationErr = {!uniqueId}validateEmail();
            if(validationErr != null){
                sucessfullyValidated = false;
            }
            
            // Validate Website
            validationErr = {!uniqueId}validateWebAddress();
            if(validationErr != null){
                sucessfullyValidated = false;
            }
            
            // Validate VIP#:
            validationErr = {!uniqueId}validateVIP();
            if(validationErr != null){
                sucessfullyValidated = false;
            }
            
            // Validate BillingPostalCode:
            validationErr = {!uniqueId}validateBillingPostalCode();
            if(validationErr != null){
                sucessfullyValidated = false;
            }
            
            /// Validate ShippingPostalCode:
            if(!$('#{!uniqueId}CopyAddress').is(':checked')){
                validationErr = {!uniqueId}validateShippingPostalCode();
                if(validationErr != null){
                    sucessfullyValidated = false;
                }   
            }

            // Validate selected preferred contact method:
            validationErr = {!uniqueId}validateSelectedContactMethod();
            if(validationErr != null){
                sucessfullyValidated = false;
            }
            return sucessfullyValidated;
        }
        
        // Method to create a JSON objct for all fields
        function {!uniqueId}createVendorJSON(){
            {!uniqueId}processingFieldsMap = accountFieldsMap;
            {!uniqueId}attrAPIField = "accApi";
            {!uniqueId}vendorJSONRecord = {};
            
            if({!uniqueId}VendorId.length != 0){
                {!uniqueId}vendorJSONRecord[{!uniqueId}processingFieldsMap["Id"] ] = {!uniqueId}VendorId;
            }
            
            fieldJQElem = $("#{!uniqueId}VendorName");
            fieldJSONStr = fieldJQElem.val().trim();
            {!uniqueId}vendorJSONRecord[ {!uniqueId}processingFieldsMap[fieldJQElem.attr({!uniqueId}attrAPIField)] ] = fieldJSONStr;
            
            fieldJQElem = $("#{!uniqueId}Active__c");
            fieldJSONStr = fieldJQElem.is(':checked');
            {!uniqueId}vendorJSONRecord[ {!uniqueId}processingFieldsMap[fieldJQElem.attr({!uniqueId}attrAPIField)] ] = fieldJSONStr;
            
            fieldJQElem = $("#{!uniqueId}BillingStreet");
            fieldJSONStr = fieldJQElem.val().trim();
            {!uniqueId}vendorJSONRecord[ {!uniqueId}processingFieldsMap[fieldJQElem.attr({!uniqueId}attrAPIField)] ] = fieldJSONStr;
            
            fieldJQElem = $("#{!uniqueId}BillingCity");
            fieldJSONStr = fieldJQElem.val().trim();
            {!uniqueId}vendorJSONRecord[ {!uniqueId}processingFieldsMap[fieldJQElem.attr({!uniqueId}attrAPIField)] ] = fieldJSONStr;
            
            fieldJQElem = $("#{!uniqueId}BillingCountry");
            fieldJSONStr = fieldJQElem.data("kendoDropDownList").text();
            {!uniqueId}vendorJSONRecord[ {!uniqueId}processingFieldsMap[fieldJQElem.attr({!uniqueId}attrAPIField)] ] = fieldJSONStr;
            
            fieldJQElem = $("#{!uniqueId}BillingState");
            fieldJSONStr = fieldJQElem.data("kendoDropDownList").text();
            {!uniqueId}vendorJSONRecord[ {!uniqueId}processingFieldsMap[fieldJQElem.attr({!uniqueId}attrAPIField)] ] = fieldJSONStr;
            
            fieldJQElem = $("#{!uniqueId}BillingPostalCode");
            fieldJSONStr = fieldJQElem.val().trim();
            {!uniqueId}vendorJSONRecord[ {!uniqueId}processingFieldsMap[fieldJQElem.attr({!uniqueId}attrAPIField)] ] = fieldJSONStr;
            
            fieldJQElem = $("#{!uniqueId}CopyAddress");
            fieldJSONStr = fieldJQElem.is(':checked');
            {!uniqueId}vendorJSONRecord[ {!uniqueId}processingFieldsMap[fieldJQElem.attr({!uniqueId}attrAPIField)] ] = fieldJSONStr;
            
            fieldJQElem = $("#{!uniqueId}is_Customer");
            fieldJSONStr = fieldJQElem.is(':checked');
            {!uniqueId}vendorJSONRecord[ {!uniqueId}processingFieldsMap[fieldJQElem.attr({!uniqueId}attrAPIField)] ] = fieldJSONStr;
            
            var fieldAddSameElem = $("#{!uniqueId}CopyAddress");
            var isShippingAddSameAsBilling = fieldAddSameElem.is(':checked');
            
            fieldJQElem = $("#{!uniqueId}ShippingStreet");
            fieldJSONStr = (isShippingAddSameAsBilling) ? $("#{!uniqueId}BillingStreet").val().trim() : fieldJQElem.val().trim();
            {!uniqueId}vendorJSONRecord[ {!uniqueId}processingFieldsMap[fieldJQElem.attr({!uniqueId}attrAPIField)] ] = fieldJSONStr;

            fieldJQElem = $("#{!uniqueId}ShippingCity");
            fieldJSONStr = (isShippingAddSameAsBilling) ? $("#{!uniqueId}BillingCity").val().trim() : fieldJQElem.val().trim();
            {!uniqueId}vendorJSONRecord[ {!uniqueId}processingFieldsMap[fieldJQElem.attr({!uniqueId}attrAPIField)] ] = fieldJSONStr;
            
            fieldJQElem = $("#{!uniqueId}ShippingCountry");
            fieldJSONStr = ((isShippingAddSameAsBilling) ? $("#{!uniqueId}BillingCountry") : fieldJQElem).data("kendoDropDownList").text();
            {!uniqueId}vendorJSONRecord[ {!uniqueId}processingFieldsMap[fieldJQElem.attr({!uniqueId}attrAPIField)] ] = fieldJSONStr;
            
            fieldJQElem = $("#{!uniqueId}ShippingState");
            fieldJSONStr = ((isShippingAddSameAsBilling) ? $("#{!uniqueId}BillingState") : fieldJQElem).data("kendoDropDownList").text();
            {!uniqueId}vendorJSONRecord[ {!uniqueId}processingFieldsMap[fieldJQElem.attr({!uniqueId}attrAPIField)] ] = fieldJSONStr;
            
            fieldJQElem = $("#{!uniqueId}ShippingPostalCode");
            fieldJSONStr = (isShippingAddSameAsBilling) ? $("#{!uniqueId}BillingPostalCode").val().trim() : fieldJQElem.val().trim();
            {!uniqueId}vendorJSONRecord[ {!uniqueId}processingFieldsMap[fieldJQElem.attr({!uniqueId}attrAPIField)] ] = fieldJSONStr;
            
            fieldJQElem = $("#{!uniqueId}Phone");
            fieldJSONStr = fieldJQElem.val().trim();
            {!uniqueId}vendorJSONRecord[ {!uniqueId}processingFieldsMap[fieldJQElem.attr({!uniqueId}attrAPIField)] ] = fieldJSONStr;
            
            fieldJQElem = $("#{!uniqueId}Mobile__c");
            fieldJSONStr = fieldJQElem.val().trim();
            {!uniqueId}vendorJSONRecord[ {!uniqueId}processingFieldsMap[fieldJQElem.attr({!uniqueId}attrAPIField)] ] = fieldJSONStr;
            
            fieldJQElem = $("#{!uniqueId}Fax");
            fieldJSONStr = fieldJQElem.val().trim();
            {!uniqueId}vendorJSONRecord[ {!uniqueId}processingFieldsMap[fieldJQElem.attr({!uniqueId}attrAPIField)] ] = fieldJSONStr;
            
            fieldJQElem = $("#{!uniqueId}Email__c");
            fieldJSONStr = fieldJQElem.val().trim();
            {!uniqueId}vendorJSONRecord[ {!uniqueId}processingFieldsMap[fieldJQElem.attr({!uniqueId}attrAPIField)] ] = fieldJSONStr;
            
            fieldJQElem = $("#{!uniqueId}Website__c");
            fieldJSONStr = fieldJQElem.val().trim();
            {!uniqueId}vendorJSONRecord[ {!uniqueId}processingFieldsMap[fieldJQElem.attr({!uniqueId}attrAPIField)] ] = fieldJSONStr;
            
            fieldJQElem = $("#{!uniqueId}PreferredMethod");
            fieldJSONStr = fieldJQElem.data("kendoDropDownList").text();
            {!uniqueId}vendorJSONRecord[ {!uniqueId}processingFieldsMap[fieldJQElem.attr({!uniqueId}attrAPIField)] ] = fieldJSONStr;
            
            var fieldisCustomer = $('#{!uniqueId}is_Customer');
            var isVendorCustomer = fieldisCustomer.is(':checked');
            
            fieldJQElem = $("#{!uniqueId}PriceLevel");
            fieldJSONStr = (isVendorCustomer) ? fieldJQElem.data("kendoDropDownList").value() : "" ;
            {!uniqueId}vendorJSONRecord[ {!uniqueId}processingFieldsMap[fieldJQElem.attr({!uniqueId}attrAPIField)] ] = fieldJSONStr;
            
            fieldJQElem = $("#{!uniqueId}SalesTax");
            fieldJSONStr = (isVendorCustomer) ? fieldJQElem.data("kendoDropDownList").value() : "" ;
            {!uniqueId}vendorJSONRecord[ {!uniqueId}processingFieldsMap[fieldJQElem.attr({!uniqueId}attrAPIField)] ] = fieldJSONStr;
            
            fieldJQElem = $("#{!uniqueId}PurchaseTax");
            fieldJSONStr = (isVendorCustomer) ? fieldJQElem.data("kendoDropDownList").value() : "" ;
            {!uniqueId}vendorJSONRecord[ {!uniqueId}processingFieldsMap[fieldJQElem.attr({!uniqueId}attrAPIField)] ] = fieldJSONStr;
            
            fieldJQElem = $("#{!uniqueId}VIP__c");
            fieldJSONStr = (isVendorCustomer) ? fieldJQElem.val().trim() : "" ;
            {!uniqueId}vendorJSONRecord[ {!uniqueId}processingFieldsMap[fieldJQElem.attr({!uniqueId}attrAPIField)] ] = fieldJSONStr;    
        }
    </script>    
</apex:component>