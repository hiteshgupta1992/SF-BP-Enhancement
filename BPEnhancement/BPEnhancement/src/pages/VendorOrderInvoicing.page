<apex:page standardStylesheets="false"
           showChat="false" showHeader="false" sidebar="false" Controller="VendorInvoicingCtrl">
           
        <html ng-app="vendorOrderInvoicingApp">
            <head>
                <title>Vendor Order Invoicing</title>    
            </head>
            
            <c:Css_and_Js ></c:Css_and_Js> 
            <apex:includeScript value="{!$Resource.niceScroll}"/>  
            <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.0-beta.6/angular-animate.js"></script>
            <apex:includeScript value="{!$Resource.d3}"/>
            
            <c:PageStyle />
            <c:VendorOrderStyle />
            <c:AutoCompleteSuggestion /> 
            <c:dirPagination />
            <c:PopUp />
            <c:COPopup />
            <c:PartPopUpOnVendorOrder />
            <c:dirpriceCallBack />
            <c:Invoice_history_mini_page_layout />
            <style>
                .linetext h3 {  
                  position: relative; 
                  text-align: center;
                }
                
                .linetext h3 span {
                  background: #fff;
                  padding: 0 15px;
                  position: relative;
                  z-index: 1;
                  font-size:14px;
                }
                
                .linetext h3:before {
                  background: #000;
                  content: "";
                  display: block;
                  height: 1px;
                  position: absolute;
                    top: 50%;
                  width: 100%;
                }
                
                .linetext h3:before {
                  left: 0;
                }
                .sections-link .sub-heading{
                	border-left:none;
                }
            
            
            </style>
            
            
            <script>
                $(document).ready(function () {
                    $("body").niceScroll({
                        mousescrollstep : 50
                    });
                    var top_for_scroll = 0;
                    top_for_scroll = $('#collapsible-header').height() + $('#fixed-seacrh-row').height() + $('#sticky-heading').height();
                        $(document).on("scroll", onScroll);
                        setTimeout(function () {
                            $('.sections-link a[href*=#]:not([href=#])').click(function (e) {
                                //e.preventDefault();
                                debug('top_for_scroll '+top_for_scroll);
                                $(document).off("scroll");
                                var target = $(this).attr("href");
                                $($(this).attr("rel")).show();
                                $('html, body').stop().animate({
                                    scrollTop : $(target).offset().top - top_for_scroll -20
                                }, 1000, function () {
                                    //window.location.hash = target;
                                    $(document).on("scroll", onScroll);
                                    onScroll();
                                    return false;
                                });
                            })
                            debug('Jquery Loaded');
                        }, 1000);
                });
        
                function onScroll(event){
                     var heading = ''; 
                   		var scrollPos = $(document).scrollTop();
                  	 
                    if (scrollPos < $('#VOI_General_Block').position().top + $('#VOI_General_Block').height() + $('#VOI_Vendor_Order_Receiving_Block').height()  + 50) {
                        heading = 'A   Info';
                        
                    } else if (scrollPos < $('#VOI_Vendor_invoicing_Block').position().top + $('#VOI_Vendor_invoicing_Block').height() + 50) {
                        heading = 'B  Invoicing';


                    } else if (scrollPos < $('#VO_Finalize_Section').position().top + $('#VO_Finalize_Section').height() + 50) {
                        heading = ' C  Finailize';
                   }





                    $('#sticky-heading h1 .header_icon_text').html(heading);
            
                   

                }
            
            
            </script>
        
<script>

    var vendorOrderInvoicingApp = angular.module('vendorOrderInvoicingApp',  ['BPGlobalHeader','ngDialog', 'searchToAddModule', 'dir.priceInput', 'dir.listPagination', 'ngAnimate', 'ui-notification', 'partsChart']);
    
    
      vendorOrderInvoicingApp.directive('numberOnlyInput', function () {
            return {
                restrict: 'EA',
                template: '<input type="text" class="form-control" ng-model="inputValue" />',
                scope: {
                    inputValue: '='

                },
                link: function (scope) {
                    scope.$watch('inputValue', function(newValue,oldValue) {
                        var arr = String(newValue).split("");
                        var pieces = String(newValue).split(".");
                        if (arr.length === 0) return;
                        if(arr[0] == '-'){
                            scope.inputValue = oldValue;
                        }
                        else if (isNaN(newValue)) {
                            scope.inputValue = oldValue;
                        }
                        else if(typeof(pieces[1]) != "undefined" && pieces[1].length > 2){
                            scope.inputValue = oldValue;
                        }
                    });
                }
            };
        });
    
    //controller starts
    vendorOrderInvoicingApp.controller('vendorOrderInvoicingController', function ($scope, $sce, $q, $timeout, Notification,vendorOrderInvoicingService, ngDialog) {
                $scope.VORModel = {};
                //$scope.VORModel.VOR_Header['VendorName']="vendor test";
				 $scope.parseInt = parseInt;
                $scope.VORModel.VIHeader = {};
                 $scope.VendorOrderModel = {};
                 // $scope.VORModel.VOR_Header.VORId=null;
                   
                $scope.SearchToadd = {};
                $scope.typeToSearch = "";
                $scope.PreferredObject = "Vendor";
                $scope.SearchableObjects = 'Vendor';
                
                // Map variable to hold order of sorting
                var sortOrderMap = {
                    "ASC"   :   "DESC",
                    "DESC"  :   ""
                };
                
                // Pagination and sort related JSON
            $scope.VORModel.setDefaultPageSortAttrs = {};

            // Method to set default page sort attributes JSON
            $scope.VORModel.setDefaultPageSortAttrs = function() {
                $scope.VORModel.receivingPageSortAttrsJSON = {
                    ChangesCount    :   0,
                    CurrentPage     :   1,
                    PageSize        :   10,
                    Sorting :   [{
                        FieldName       :   "Order",
                        SortDirection   :   "ASC"
                    }]
                };
                try{
                    $scope.VORModel.receivingPageSortAttrsJSON.PageSize = '{!JSENCODE(TEXT(Related_List_Page_Size))}';
                } catch (ex){}
                
                $scope.VORModel.groupItemsPageSortAttrsJSON = {
                    ChangesCount    :   0,
                    CurrentPage     :   1,
                    PageSize        :   10,
                    Sorting :   [{
                        FieldName       :   "Order",
                        SortDirection   :   "ASC"
                    }]
                };
                try{

                    $scope.VORModel.groupItemsPageSortAttrsJSON.PageSize = '{!JSENCODE(TEXT(Related_List_Page_Size))}';
                } catch (ex){}
            }
                
                $scope.VORModel.initFunction = function(){
                        $scope.VORModel.setDefaultPageSortAttrs();
                       
                        $scope.VORModel.VIHeader.VIHeaderId = location.search.split('id=')[1] ? location.search.split('id=')[1] : null;
                        if($scope.VORModel.VIHeader.VIHeaderId != null && $scope.VORModel.VIHeader.VIHeaderId.trim().length != 15 && $scope.VORModel.VIHeader.VIHeaderId.trim().length != 18){
                            $scope.VORModel.VIHeader.VIHeaderId = null;
                        }
                       // $scope.SearchToAddCallback = $scope.VORModel.searchToAddCallback;
                        //$scope.VORModel.setDefaultPageSortAttrs();  
                        var vendorId=null;
                        var viHeaderId=$scope.VORModel.VIHeader.VIHeaderId;
                        var vrHeaderId =null;
                        $scope.SearchToAddCallback = $scope.VORModel.searchToAddCallback;
                        
                            vendorOrderInvoicingService.getVendorInvoicing( viHeaderId, 
                                                                            vrHeaderId,
                                                                            $scope.VORModel.receivingPageSortAttrsJSON,
                                                                            $scope.VORModel.groupItemsPageSortAttrsJSON
                                                                        )
                                .then(function (successfulResult) {
                                                      
                                                      debug(successfulResult);
                                                      $scope.VORModel.PopulatePageModel(successfulResult)
                                                 });
                              }                      
                          
                 
                 
                $scope.VORModel.searchToAddCallback = function (selectedRecord){
                    if(selectedRecord.originalObject.Info == 'Vendor') {
                    	
                    	if($scope.VORModel.VIGroupList.length == 0  || $scope.VORModel.VIGroupList =='undefined') {
                            var selectedRecordId = selectedRecord.originalObject.Value;
                            debug('In add Vendor   viHeaderId - > ');
                            
                            debug($scope.VORModel.VIHeader);
                            if($scope.VORModel.VIHeader == undefined) {
                            	viHeaderId = null 
                            } else {
                            	viHeaderId= $scope.VORModel.VIHeader.VIHeaderId;
                            }
                            
                            debug(viHeaderId);
                            
                            if (selectedRecordId.length == 18) {
                                selectedRecordId = selectedRecordId.substring(0, 15);
                            }
                            
                            vendorOrderInvoicingService.addVendor(selectedRecordId , viHeaderId,
                                                                    $scope.VORModel.receivingPageSortAttrsJSON,
                                                                    $scope.VORModel.groupItemsPageSortAttrsJSON
                                                                    )
                                    .then(function (successfulResult) {
                                          debug(successfulResult);
                                          $scope.VORModel.PopulatePageModel(successfulResult)
                                     });
                              $scope.VORModel.resetSearchBox();
                        } else {
                           Notification.error('Cannot add vendor first remove item from invoice');
                        }   
                  	}
                }    
                
                          
               $scope.VORModel.resetSearchBox = function () {
                    $scope.typeToSearch = "";
                    $scope.PreferredObject = "";
                }
                
                          
                $scope.VORModel.PopulatePageModel = function(result) {
                	debug('In Populate Method');
                	debug(result);
                	
                	if(result.VIHeaderRec.length > 0) {
                		var url = '?id=' + result.VIHeaderRec[0].VIHeaderId;
						window.history.pushState("string", "Title" , url);
						
						$scope.VORModel.VIHeader = result.VIHeaderRec[0];
						$scope.VORModel.VIHeader.VIHeaderId = result.VIHeaderRec[0].VIHeaderId;
                	}
                	
                	if($scope.VORModel.VIHeader != 'undefiend') {
                		$scope.VORModel.PopulateGrid(null,result);
                	}
                	
                	//debug($scope.VORModel.VIHeader);
                	
            		/*if($scope.VORModel.VIHeader != 'undefiend') {
						if(($scope.VORModel.VIHeader.VIHeaderId == null || $scope.VORModel.VIHeader.VIHeaderId == 'undefined') && result.VIHeaderRec.length > 0) {
	            			
            			}
            			if(result.VIHeaderRec.length > 0 ){
            				
                   			$scope.VORModel.PopulateGrid(null,result);	
            			}
            		}*/
                }
                
                
        
        // data initialization
            
         $scope.labelDataValue = {
                QtyComitted : 0,
                QtyAvalable : 0,
                Instock : 0,
                QtyOnOrder : 0,
                ReOrderMin : 0,
                ReOrderMax : 0,
                maxPoint : 0,
            };
            
            $scope.partChartsDetails = {
                QtyComitted : {
                    startAngle : 0,
                    endAngle : 0
                },
                QtyAvalable : {
                    startAngle : 0,
                    endAngle : 0
                },
                Instock : {
                    startAngle : 0,
                    endAngle : 0
                },
                QtyOnOrder : {
                    startAngle : 0,
                    endAngle : 0
                },
            };
            
            $scope.chartData = {
                QtyComitted : {
                    Angle : 4.3617251235193315
                },
                QtyAvalable : {
                    Angle : 6.397068040872217
                },
                Instock : {
                    Angle : 6.397068040872217
                },
                QtyOnOrder : {
                    Angle : 7.0
                },
                minPoint : {
                    Angle : 2.827433388230814
                },
                maxPoint : {
                    Angle : 12.00741192144774
                },
                ReOrderMin : {
                    Angle : 0
                },
                ReOrderMax : {
                    Angle : 0
                }
            };
            
            
                         $scope.VORModel.loadChartData = function () {
            
                var index = [];
            
                var MaxOrder = $scope.VendorOrderModel.partInfoDetail.AutoReorderTo;
                MaxOrder = MaxOrder + (MaxOrder * .1);
            
                $scope.partChartsDetails.MaxOrder = MaxOrder;
            
                debug('max' + $scope.partChartsDetails.MaxOrder)
            
                /*  $scope.partChartsDetails ={QtyComitted : {startAngle:2.827433388230814 , endAngle :4.3617251235193315  } ,
                QtyAvalable : {startAngle:4.3617251235193315 , endAngle : 6.397068040872217},
                Instock :{startAngle:2.827433388230814 , endAngle : 6.397068040872217},
                QtyOnOrder :{startAngle:6.397068040872217 , endAngle : 7.0},
                };  */
            
                $scope.chartData = {
                    QtyComitted : {
                        Angle : 4.3617251235193315
                    },
                    QtyAvalable : {
                        Angle : 6.397068040872217
                    },
                    Instock : {
                        Angle : 6.397068040872217
                    },
                    QtyOnOrder : {
                        Angle : 7.0
                    },
                    minPoint : {
                        Angle : 2.827433388230814
                    },
                    maxPoint : {
                        Angle : 12.00741192144774
                    },
                    ReOrderMin : {
                        Angle : 0
                    },
                    ReOrderMax : {
                        Angle : 0
                    }
            
                };
            
                $scope.labelDataValue = {
                    QtyComitted : $scope.VendorOrderModel.partInfoDetail.QtyCommited,
                    QtyAvalable : $scope.VendorOrderModel.partInfoDetail.QtyAvailable,
                    Instock : $scope.VendorOrderModel.partInfoDetail.InStockQty,
                    QtyOnOrder : $scope.VendorOrderModel.partInfoDetail.QtyOnOrder,
                    ReOrderMin : $scope.VendorOrderModel.partInfoDetail.AutoReorderAt,
                    ReOrderMax : $scope.VendorOrderModel.partInfoDetail.AutoReorderTo,
                    maxPoint : $scope.VendorOrderModel.MaxOrder
                };
            
                debug($scope.labelDataValue)
            
                index.splice(1, 0, {
                    key : 'QtyComitted',
                    value : $scope.VendorOrderModel.partInfoDetail.QtyCommited,
                    lastAngle : 'init'
            
                });
            
                index.splice(2, 0, {
                    key : 'QtyAvalable',
                    value : $scope.VendorOrderModel.partInfoDetail.QtyAvailable,
                    lastAngle : 'QtyComitted'
            
                })
            
                index.splice(3, 0, {
                    key : 'Instock',
                    value : $scope.VendorOrderModel.partInfoDetail.InStockQty,
                    lastAngle : 'init'
            
                })
                index.splice(4, 0, {
                    key : 'QtyOnOrder',
                    value : $scope.VendorOrderModel.partInfoDetail.QtyOnOrder,
                    lastAngle : 'QtyAvalable'
            
                })
            
                index.splice(5, 0, {
                    key : 'maxOrder',
                    value : $scope.VendorOrderModel.partInfoDetail.AutoReorderTo,
                    lastAngle : 'QtyOnOrder'
            
                })
            
                index.splice(6, 0, {
                    key : 'ReOrderMin',
                    value : $scope.VendorOrderModel.partInfoDetail.AutoReorderAt,
                    lastAngle : 'ReOrderMin'
            
                })
            
                index.splice(7, 0, {
                    key : 'ReOrderMax',
                    value : $scope.VendorOrderModel.partInfoDetail.AutoReorderTo,
                    lastAngle : 'ReOrderMax'
            
                })
            
                $scope.temp = {}
            
                for (i = 0; i < index.length; i++) {
            
                    var firstangle = index[i].value;
                    var lastangle = index[i].lastAngle;
                    var key = index[i].key;
            
                    if (lastangle == 'init') {
            
                        var maxOrder = $scope.partChartsDetails.MaxOrder;
            
                        var endAngleVal = ((.45 * Math.PI * 2) + ((Math.PI * 2) * (0.009 * ((firstangle / maxOrder) * 100))));
            
                        $scope.temp[key] = {
                            startAngle : 2.827433388230814,
                            endAngle : endAngleVal
                        }
            
                        $scope.chartData[key] = {
                            Angle : endAngleVal
                        }
            
                    } else {
            
                        if (key == lastangle) {
            
                            var angleValue = ((.45 * Math.PI * 2) + (Math.PI * 2) * (0.009 * ((firstangle / maxOrder) * 100)))
                            $scope.chartData[key] = {
                                Angle : angleValue
                            };
                        } else {
            
                            var startAngleVal = $scope.temp[lastangle].endAngle;
                            var endAngleval = (startAngleVal +
                                ((Math.PI * 2) * (0.009 * ((firstangle / maxOrder) * 100))));
            
                            $scope.temp[key] = {
                                startAngle : startAngleVal,
                                endAngle : endAngleval
                            }
            
                            $scope.chartData[key] = {
                                Angle : $scope.temp[key].endAngle
                            };
            
                        }
                    }
            

            
            
                }


                
                
                
                
                
                
              $scope.chartData['minPoint'] = {
                    Angle : 2.827433388230814
                };
                $scope.chartData['maxPoint'] = {
                    Angle : 8.482300164692441
                };
            
                angular.copy($scope.temp, $scope.partChartsDetails);

            }
                
                
                //Update Header data
                $scope.VORModel.updateVIHeaderDetails=function(){
                
                            var viHeaderId=$scope.VORModel.VIHeader.VIHeaderId;
                            var InvoiceDateString=$scope.VORModel.VIHeader.InvoiceDate;
                            var InvoiceNumber=$scope.VORModel.VIHeader.InvoiceNumber;
                            
                            vendorOrderInvoicingService.updateVIHeader( viHeaderId,  InvoiceNumber,  InvoiceDateString,
                            												$scope.VORModel.receivingPageSortAttrsJSON,
                                                                            $scope.VORModel.groupItemsPageSortAttrsJSON).then(function(successfulResult){
                                    
                                    $scope.VORModel.VIHeader = successfulResult.VIHeaderRec[0];
                            
                            });
                
                }
                
                
                  $scope.VORModel.onClickSelectAllVO = function(event) {
                        if(event.target.attributes.class.value.indexOf("disabled_chk_tick") != -1){
                            return;
                            event.stopPropagation();
                        }
                        
                        $scope.VORModel.currentSelectedVOIndex = null;
                        $scope.VORModel.currentSelectedVOId = null;
                        
                        // First popup for confirmation if really want to unselect vendor order from receiving,
                        // if any of item is already selected in receiving items grid
                        if( $scope.VORModel.isAllVOSelected == true ){                  // Check with TRUE, as the selected box is not toggelled yet
                            // ToDo: Loop through items grid if any items from the current VENDOR ORDER is selected already
                            angular.element('#VODeselectConfirmBox').show();
                        } else {
                            $scope.VORModel.isAllVOSelected = !$scope.VORModel.isAllVOSelected;
                            $scope.VORModel.VODeselectConfirm();
                        }
                     }
                    
                    
                //Select VR on CLick         
                 $scope.VORModel.onClickSelectVO = function(event, indexVal, vendorOrderId) {
                 
                        var viHeaderId=$scope.VORModel.VIHeader.VIHeaderId;
                        
                        if($scope.VORModel.VRHeaderList[indexVal].InProgressVIHeaderId ==null){
                                    vendorOrderInvoicingService.addToItemsSubsection(viHeaderId,vendorOrderId,$scope.VORModel.receivingPageSortAttrsJSON,
                                                                        $scope.VORModel.groupItemsPageSortAttrsJSON)
                                    .then(function(successfulResult){
                                            $scope.VORModel.PopulateGrid(null,successfulResult);
                                    });
                        }
                        else{
                                vendorOrderInvoicingService.removeFromItemSubSection(viHeaderId,vendorOrderId,$scope.VORModel.receivingPageSortAttrsJSON,
                                                                        $scope.VORModel.groupItemsPageSortAttrsJSON)
                                        .then(function(successfulResult){
                                                $scope.VORModel.PopulateGrid(null,successfulResult);
                                        });
                        }
            } 
            
            //Open Item in Mode
            $scope.VORModel.editGroupItem=function(event, index){
                if($scope.VORModel.VIHeader.Status == 'Invoiced'){
                    return;
                }
                
                var isEditModeEnabled = false;
                debug('1233'); 
                if(event.target['type']=='text')
                {
                
                }   
                else{
                         for (i = 0; i < $scope.VORModel.VIGroupListItems_editRow.length; i++) {
                                if ($scope.VORModel.VIGroupListItems_editRow[i].isEdit == true) {
                                    isEditModeEnabled = true;
                                }
                               $scope.VORModel.VIGroupListItems_editRow[i].isEdit = false;
                            }
                            if (!isEditModeEnabled) {
                            
                                $scope.VORModel.VIGroupListItems_editRow[index].isEdit = true;
                            }
                            else{
                                
                                    $scope.VORModel.UpdateVIGroupItem(index);
                            }
            
                }
            }
            
            $scope.VORModel.UpdateVIGroupItem=function(index){
                
                
                var viHeaderId=$scope.VORModel.VIHeader.VIHeaderId;
                var vrHeaderId=null
                var jsonString= $scope.VORModel.VIGroupList[index];
                
                vendorOrderInvoicingService.updateVIGroup(viHeaderId, vrHeaderId, jsonString, $scope.VORModel.receivingPageSortAttrsJSON,$scope.VORModel.groupItemsPageSortAttrsJSON)
                .then(function(successResult){
                        $scope.VORModel.PopulateGrid(null,successResult);
                });
                
            
            }
            $scope.VORModel.editRowTabOutLast=function(event,index){
                        
                        if (!event.shiftKey && event.keyCode == 9){
                                $scope.VORModel.UpdateVIGroupItem(index);
                        }
            
            }
            
            // Grid Populate function
            $scope.VORModel.PopulateGrid = function(gridName,result){
                    $scope.VORModel.totalVendorOrderInvoicing = result.totalVendorOrderInvoicing;
                    $scope.VORModel.totalGroupItems = result.totalGroupItems;
                    
                    if(gridName==null || gridName=='VOListGrid'){
                            $scope.VORModel.VRHeaderList =result.VRHeaderList;
                    }
                    if(gridName==null || gridName=='VOInvoicingGrid'){
                         $scope.VORModel.VIGroupList = result.VIGroupList;
                         $scope.VORModel.populateItemsSubSectionEditableModel(result.VIGroupList)
                    }
                     $scope.VORModel.ItemsTotal=result.ItemsTotal;
                     $scope.VORModel.PurchaseTax=result.PurchaseTax;
                     $scope.VORModel.Total=result.Total;
                    
            }
            
            // Populate Edit Sub Section
            $scope.VORModel.populateItemsSubSectionEditableModel = function(VIGroupList) {
              $scope.VORModel.VIGroupListItems_editRow = [];
              for (var i = 0; i < VIGroupList.length; i++) {
                  $scope.VORModel.VIGroupListItems_editRow.push({
                      isEdit : false,
                      radioValue : 0,
                      optionSelected : 0
                  });
              }
              debug($scope.VORModel.VIGroupListItems_editRow);
          }
          
          $scope.VORModel.loadAllGridDetails = function(gridName, callBackMethod) {
                // If Vendor receivinig Id is not null: record already exists, then only load grid details
                if ($scope.VORModel.VIHeader.VIHeaderId != null) {
                    vendorOrderInvoicingService.getVendorInvoicing( $scope.VORModel.VIHeader.VIHeaderId, 
                                                                    null,
                                                                    $scope.VORModel.receivingPageSortAttrsJSON,
                                                                    $scope.VORModel.groupItemsPageSortAttrsJSON
                                                                )
                    .then(function (successfulResult) {
                        $scope.VORModel.PopulatePageModel(successfulResult);
                        
                        if(callBackMethod != null && callBackMethod != undefined){
                            callBackMethod();
                        }
                    });
                }
            }
          
          // Method to handle any updates in sort controls
          $scope.VORModel.Receiving_PageSortControlsAction = function () {
              var newSortOrder = sortOrderMap[$scope.VORModel.receivingPageSortAttrsJSON.Sorting[0].SortDirection];
              if(newSortOrder == null || newSortOrder == undefined){
                  newSortOrder = "ASC";
              }
              $scope.VORModel.receivingPageSortAttrsJSON.Sorting[0].SortDirection = newSortOrder;
              
              // Set current page to 1
              $scope.VORModel.receivingPageSortAttrsJSON.CurrentPage = 1;
              $scope.VORModel.Receiving_paginationControlsAction();
          }

          // Method to handle any updates in sort controls
          $scope.VORModel.Receiving_paginationControlsAction = function () {
              $scope.VORModel.loadAllGridDetails(null, $scope.VORModel.Receiving_UpdatePaginationControls);
          }
          

          // Update pagination count for Vendor Orders grid
          $scope.VORModel.Receiving_UpdatePaginationControls = function () {
              setTimeout(function () {
                  $scope.VORModel.receivingPageSortAttrsJSON.ChangesCount++;
              }, 10);
          }
          
          
          // Method to handle any updates in sort controls
          $scope.VORModel.GroupItems_PageSortControlsAction = function () {
              var newSortOrder = sortOrderMap[$scope.VORModel.groupItemsPageSortAttrsJSON.Sorting[0].SortDirection];
              if(newSortOrder == null || newSortOrder == undefined){
                  newSortOrder = "ASC";
              }
              $scope.VORModel.groupItemsPageSortAttrsJSON.Sorting[0].SortDirection = newSortOrder;
              
              // Set current page to 1
              $scope.VORModel.groupItemsPageSortAttrsJSON.CurrentPage = 1;
              $scope.VORModel.GroupItems_paginationControlsAction();
          }

          // Method to handle any updates in sort controls
          $scope.VORModel.GroupItems_paginationControlsAction = function () {
              $scope.VORModel.loadAllGridDetails(null, $scope.VORModel.GroupItems_UpdatePaginationControls);
          }
          

          // Update pagination count for Vendor Orders grid
          $scope.VORModel.GroupItems_UpdatePaginationControls = function () {
              setTimeout(function () {
                  $scope.VORModel.groupItemsPageSortAttrsJSON.ChangesCount++;
              }, 10);
          }
          
          $scope.VORModel.hidePanel = function(event, id){
              var targetelement = angular.element(event.target).closest('h1').find('.fa:first');
              if(targetelement.hasClass('fa-chevron-right')){
                  targetelement.removeClass('fa-chevron-right');
                  targetelement.addClass('fa-chevron-down');
              } else {
                  targetelement.removeClass('fa-chevron-down');
                  targetelement.addClass('fa-chevron-right');
              }
              $('#'+id).toggle();
          }
          
        $scope.VORModel.finalizeOrder = function () {
            var voHeaderId = $scope.VORModel.VIHeader.VIHeaderId;
                
                vendorOrderInvoicingService.finalizeInvoiceAction(  $scope.VORModel.VIHeader.VIHeaderId,
                                                                    $scope.VORModel.receivingPageSortAttrsJSON,
                                                                    $scope.VORModel.groupItemsPageSortAttrsJSON
                                                                )
                .then(function (successfulResult) {
                    $scope.VORModel.PopulatePageModel(successfulResult);
                    
                    $scope.VORModel.setDefaultPageSortAttrs();
                    $scope.VORModel.Receiving_UpdatePaginationControls();
                    $scope.VORModel.GroupItems_UpdatePaginationControls();
                });
        }
        
           $scope.VORModel.showPartPopUp = function (event, partId) {
                $scope.applyCssOnPopUp(event, '.Vendor-Order-Part-Popup');
                
                vendorOrderInvoicingService.getPartRecord(partId).then(function (partRecord) {
                    if (partRecord.PartDetailRec != undefined) {

                       
                        $scope.VendorOrderModel.partInfoDetail = partRecord.PartDetailRec;
                        $scope.VORModel.loadChartData();
                    }
                }, function (errorSearchResult) {
                    $scope.VORModel.OverlayInfo = errorSearchResult;
                });
            } 
            
             $scope.VORModel.hidePartPopUp =function(){
            
                    angular.element('.Vendor-Order-Part-Popup').hide();
            
            }
            
              $scope.applyCssOnPopUp = function (event, className) {
                var targetEle = angular.element(event.target);
                var elementWidth = targetEle.width();
                if (targetEle.width() > targetEle.parent().width()) {
                    elementWidth = targetEle.parent().width() - 15;
                }
                angular.element(className).css('top', targetEle.offset().top - 22);
                angular.element(className).css('left', targetEle.offset().left + elementWidth + 20);
                angular.element(className).show();


            }
              
              
            // added by hitesh
            $scope.VORModel.showInvoiceDetail = function (vrHeaderId, event) {
				$scope.VORModel.InvoiceDetailInfo = {};
				var targetEle = angular.element(event.target);
				var elementWidth = targetEle.width();
				if (targetEle.width() > targetEle.parent().width()) {
					elementWidth = targetEle.parent().width() - 15;
				}
				angular.element('.Invoice-history-info-overlay').css('top', targetEle.offset().top - 275);
				angular.element('.Invoice-history-info-overlay').css('left', targetEle.offset().left + elementWidth + 68);
				angular.element('.Invoice-history-info-overlay').show();
				
				vendorOrderInvoicingService.getVRHeaderDetails(vrHeaderId).then(function (vrHeaderDetail) {
					$scope.VORModel.vrHeaderDetail = vrHeaderDetail;
					debug($scope.VORModel.vrHeaderDetail);
				}, function (errorSearchResult) {
					$scope.VORModel.vrHeaderDetail = errorSearchResult;
				});
			}

			$scope.VORModel.hideInvoiceDetail = function () {
				angular.element('.Invoice-history-info-overlay').hide();
			}
            
            // Method to show pop up box to confrim delete operation.
        $scope.VORModel.confirmDelete = function() {
            var dialog = ngDialog
                    .open({
                        template : '<div class="dialogBox"><h3>Delete Vendor Invoicing  '
                                + '</h3><hr/>'
                                + '<form >'
                                + '<span > Are you sure ? <hr/>'
                                + '<div style="text-align: right;">'
                                + '<button style="margin-right:10px;" type="button" class="btn btn-default greenBtn" ng-click="VORModel.vendorInvoicingDelete()'
                                + ' && closeThisDialog()">Delete</button>'
                                + '<button style="margin-right:10px;" type="button" class="btn btn-default grayBtn" ng-click="closeThisDialog()">Cancel</button>'
                                + '</div>' + '</form>' + '</div>',
                        showClose : false,
                        scope : $scope,
                        plain : true
                    });
        };  
        
        // added By Anurag
         $scope.VORModel.vendorInvoicingDelete = function() {
        
           var viHeaderId = $scope.VORModel.VIHeader.VIHeaderId;
            debug(viHeaderId);
         	vendorOrderInvoicingService.deleteVendorInvoice(viHeaderId).then(function (successfulSearchResult) {
                    Notification.success("Vendor Invoice Deleted Successfully");
                    debug(successfulSearchResult);
                    window.location.href = "{!$Page.HomeSearch}";
               }, function (errorSearchResult) {
                   responseData = errorSearchResult;
                   Notification.error(errorSearchResult);
         });
         return true ;	
         };
         
    });
    // controller end
    
    //services
    vendorOrderInvoicingApp.service("vendorOrderInvoicingService", function ($q) {
            
            //Finalize Invoicing
            this.finalizeInvoiceAction= function (viHeaderId, receivingPageSortAttrsJSON, groupItemsPageSortAttrsJSON){
                viHeaderId = encodeString(viHeaderId);
                receivingPageSortAttrsJSON = encodeString(angular.toJson(receivingPageSortAttrsJSON));
                groupItemsPageSortAttrsJSON = encodeString(angular.toJson(groupItemsPageSortAttrsJSON));
                var deferred = $q.defer();
                Visualforce.remoting.Manager.invokeAction(
                    '{!$RemoteAction.VendorInvoicingCtrl.finalizeInvoiceAction}',
                                viHeaderId, receivingPageSortAttrsJSON, groupItemsPageSortAttrsJSON,
                    function (result, event) {
                        if (event.type == 'exception') {
                            deferred.reject(event.message);
                        } else {
                            var partRec = decodeString(result);
                            var find = '\'';
                            var re = new RegExp(find, 'g');
                            partRec = partRec.replace(re, '');
                            deferred.resolve(JSON.parse(partRec));
                        }
                    }, {
                        escape : true
                });
                return deferred.promise;
            }
            
            //Get Part popup Data
            this.getVendorInvoicing= function (viHeaderId,vrHeaderId,receivingPageSortAttrsJSON, groupItemsPageSortAttrsJSON){
                viHeaderId = encodeString(viHeaderId);
                vrHeaderId = encodeString(vrHeaderId);
                receivingPageSortAttrsJSON = encodeString(angular.toJson(receivingPageSortAttrsJSON));
                groupItemsPageSortAttrsJSON = encodeString(angular.toJson(groupItemsPageSortAttrsJSON));
                var deferred = $q.defer();
                Visualforce.remoting.Manager.invokeAction(
                    '{!$RemoteAction.VendorInvoicingCtrl.getVendorInvoicingDetails}',
                                viHeaderId,vrHeaderId, receivingPageSortAttrsJSON, groupItemsPageSortAttrsJSON,
                    function (result, event) {
                        if (event.type == 'exception') {
                            deferred.reject(event.message);
                        } else {
                            var partRec = decodeString(result);
                            var find = '\'';
                            var re = new RegExp(find, 'g');
                            partRec = partRec.replace(re, '');
                            deferred.resolve(JSON.parse(partRec));
                        }
                    }, {
                        escape : true
                });
                return deferred.promise;
            }
            
        
        
        //Add Vendor Recceiving to Item sub section grid
        this.addToItemsSubsection=function(viHeaderId,vrHeaderId,receivingPageSortAttrsJSON, groupItemsPageSortAttrsJSON){
             viHeaderId = encodeString(viHeaderId);
             vrHeaderId = encodeString(vrHeaderId);
             receivingPageSortAttrsJSON = encodeString(angular.toJson(receivingPageSortAttrsJSON));
             groupItemsPageSortAttrsJSON = encodeString(angular.toJson(groupItemsPageSortAttrsJSON));
             var deferred = $q.defer();
                Visualforce.remoting.Manager.invokeAction(
                    '{!$RemoteAction.VendorInvoicingCtrl.addToItemsSubsection}',
                                viHeaderId,vrHeaderId, receivingPageSortAttrsJSON, groupItemsPageSortAttrsJSON,
                    function (result, event) {
                        if (event.type == 'exception') {
                            deferred.reject(event.message);
                        } else {
                            var partRec = decodeString(result);
                            var find = '\'';
                            var re = new RegExp(find, 'g');
                            partRec = partRec.replace(re, '');
                            deferred.resolve(JSON.parse(partRec));
                        }
                    }, {
                        escape : true
                });
                return deferred.promise;
        }
        
        //Remove Vendor Recceiving to Item sub section grid
        this.removeFromItemSubSection=function(viHeaderId,vrHeaderId,receivingPageSortAttrsJSON, groupItemsPageSortAttrsJSON){
             viHeaderId = encodeString(viHeaderId);
             vrHeaderId = encodeString(vrHeaderId);
             receivingPageSortAttrsJSON = encodeString(angular.toJson(receivingPageSortAttrsJSON));
             groupItemsPageSortAttrsJSON = encodeString(angular.toJson(groupItemsPageSortAttrsJSON));
             var deferred = $q.defer();
                Visualforce.remoting.Manager.invokeAction(
                    '{!$RemoteAction.VendorInvoicingCtrl.removeFromItemSubSection}',
                                viHeaderId,vrHeaderId, receivingPageSortAttrsJSON, groupItemsPageSortAttrsJSON,
                    function (result, event) {
                        if (event.type == 'exception') {
                            deferred.reject(event.message);
                        } else {
                            var partRec = decodeString(result);
                            var find = '\'';
                            var re = new RegExp(find, 'g');
                            partRec = partRec.replace(re, '');
                            deferred.resolve(JSON.parse(partRec));
                        }
                    }, {
                        escape : true
                });
                return deferred.promise;
        }
    
    
    
    //update VI Header
    this.updateVIHeader= function( viHeaderId,  InvoiceNumber,  InvoiceDateString,receivingPageSortAttrsJSON, groupItemsPageSortAttrsJSON) {
    			viHeaderId = encodeString(viHeaderId);
    			InvoiceNumber = encodeString(InvoiceNumber);
    			InvoiceDateString = encodeString(InvoiceDateString);
    			receivingPageSortAttrsJSON = encodeString(angular.toJson(receivingPageSortAttrsJSON));
    			groupItemsPageSortAttrsJSON = encodeString(angular.toJson(groupItemsPageSortAttrsJSON));
                 var deferred = $q.defer();
                Visualforce.remoting.Manager.invokeAction(
                    '{!$RemoteAction.VendorInvoicingCtrl.updateVIHeader}',
                               viHeaderId,  InvoiceNumber,  InvoiceDateString, receivingPageSortAttrsJSON, groupItemsPageSortAttrsJSON,
                    function (result, event) {
                        if (event.type == 'exception') {
                            deferred.reject(event.message);
                        } else {
                            var partRec = decodeString(result);
                            var find = '\'';
                            var re = new RegExp(find, 'g');
                            partRec = partRec.replace(re, '');
                            deferred.resolve(JSON.parse(partRec));
                        }
                    }, {
                        escape : true
                });
                return deferred.promise;
    
    
    };
    
    //Update VI Group
    this.updateVIGroup = function( viHeaderId, vrHeaderId, jsonString,receivingPageSortAttrsJSON, groupItemsPageSortAttrsJSON){
    			viHeaderId = encodeString(viHeaderId);
    			vrHeaderId = encodeString(vrHeaderId);
    			jsonString = encodeString(angular.toJson(jsonString));
    			receivingPageSortAttrsJSON = encodeString(angular.toJson(receivingPageSortAttrsJSON));
    			groupItemsPageSortAttrsJSON = encodeString(angular.toJson(groupItemsPageSortAttrsJSON));
                 var deferred = $q.defer();
                Visualforce.remoting.Manager.invokeAction(
                    '{!$RemoteAction.VendorInvoicingCtrl.updateVIGroup}',
                                viHeaderId, vrHeaderId,jsonString, receivingPageSortAttrsJSON, groupItemsPageSortAttrsJSON,
                    function (result, event) {
                        if (event.type == 'exception') {
                            deferred.reject(event.message);
                        } else {
                            var partRec = decodeString(result);
                            var find = '\'';
                            var re = new RegExp(find, 'g');
                            partRec = partRec.replace(re, '');
                            deferred.resolve(JSON.parse(partRec));
                        }
                    }, {
                        escape : true
                });
                return deferred.promise;
    
    }
    
    //Add Vendor To Vendor invoicing
    this.addVendor=function( vendorId , viHeaderId,receivingPageSortAttrsJSON, groupItemsPageSortAttrsJSON){
                
                debug(vendorId +' '+ viHeaderId+' '+receivingPageSortAttrsJSON+' '+groupItemsPageSortAttrsJSON)
                vendorId = encodeString(vendorId);
    			viHeaderId = encodeString(viHeaderId);
                receivingPageSortAttrsJSON = encodeString(angular.toJson(receivingPageSortAttrsJSON));
    			groupItemsPageSortAttrsJSON = encodeString(angular.toJson(groupItemsPageSortAttrsJSON));
                 var deferred = $q.defer();
                Visualforce.remoting.Manager.invokeAction(
                    '{!$RemoteAction.VendorInvoicingCtrl.addVendor}',
                                vendorId , viHeaderId, receivingPageSortAttrsJSON, groupItemsPageSortAttrsJSON,
                    function (result, event) {
                        if (event.type == 'exception') {
                            deferred.reject(event.message);
                        } else {
                            var partRec = decodeString(result);
                            var find = '\'';
                            var re = new RegExp(find, 'g');
                            partRec = partRec.replace(re, '');
                            deferred.resolve(JSON.parse(partRec));
                        }
                    }, {
                        escape : true

                });
                return deferred.promise;
    
    }
    
        //View part popup
        
         this.getPartRecord = function (partId){
                    partId = encodeString(partId);
                    var deferred = $q.defer();
                    Visualforce.remoting.Manager.invokeAction(
                        '{!$RemoteAction.VendorInvoicingCtrl.getPartByPartId}',
                                    partId,
                        function (result, event) {
                            if (event.type == 'exception') {
                                deferred.reject(event.message);
                            } else {
                                var partRec = decodeString(result);
                                var find = '\'';
                                var re = new RegExp(find, 'g');
                                partRec = partRec.replace(re, '');
                                deferred.resolve(JSON.parse(partRec));
                            }
                        }, {
                            escape : true
                    });
                    return deferred.promise;
                }
                
         // View VR Header Group popup
         this.getVRHeaderDetails = function (vrHeaderId){
             vrHeaderId = encodeString(vrHeaderId);
             var deferred = $q.defer();
             Visualforce.remoting.Manager.invokeAction(
                 '{!$RemoteAction.VendorInvoicingCtrl.getVRDetailForPopUp}',
                             vrHeaderId,
                 function (result, event) {
                     if (event.type == 'exception') {
                         deferred.reject(event.message);
                     } else {
                         var vrHeaderRec = decodeString(result);
                         var find = '\'';
                         var re = new RegExp(find, 'g');
                         vrHeaderRec = vrHeaderRec.replace(re, '');
                         deferred.resolve(JSON.parse(vrHeaderRec));
                     }
                 }, {
                     escape : true
             });
             return deferred.promise;
         }
                
	    this.deleteVendorInvoice = function (viHeaderId){
	             viHeaderId = encodeString(viHeaderId);
	             var deferred = $q.defer();
	             Visualforce.remoting.Manager.invokeAction(
	                 '{!$RemoteAction.VendorInvoicingCtrl.deleteVendorOrderInvoicing}', viHeaderId,
	                 function (result, event) {
	                     if (event.type == 'exception') {
	                         deferred.reject(event.message);
	                     } else {
	                         var vrHeaderRec = decodeString(result);
	                         deferred.resolve(vrHeaderRec);
	                     }
	                 }, {
	                     escape : true
	             });
	             return deferred.promise;
	         }
	    
});



</script>




 
    <body ng-controller="vendorOrderInvoicingController"  ng-init="VORModel.initFunction()" >
        
        <!-- Header start -->
        <c:BPGlobalHeader />
        <!-- Header End -->
        
        <!-- START: Page Content -->
        <div class="row" id="VOR_sidebar_div2">
            
            <!-- START: Side panel start -->   
            <div class="col-lg-3 col-md-3 col-sm-3 sidepanel" id="workflow-sidepanel">
                <div class="row" id="VOR_workflow_sidepanel_div1">
                    <div class="customerSelector" id="VOR_workflow_sidepanel_div2" ng-if="VORModel.VIHeader.VendorId == null" >
                        <div id="VOR_workflow_sidepanel_div3">
                            <div class="customerImage" id="VOR_workflow_sidepanel_div4">
                            </div>
                            <div class="add-new" id="VOR_workflow_sidepanel_div5">
                                <span  style="font-style: italic;" id="VOR_workflow_sidepanel_span_no_customer">No Vendor</span>
                                <div id="VOR_workflow_sidepanel_div6">
                                    <img src="{!URLFOR($Resource.icon_images, 'images/hashimg1.png')}" style="height:32px; width:20px;" id="VOR_workflow_sidepanel_vendor_image"/>
                                    <a href="" ng-click="VORModel.RelatedList_addAction($event, 'Vendor')" id="VOR_workflow_sidepanel_add_vendor_link">Add One!</a>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="selectedUserBox"  ng-if="VORModel.VIHeader.VendorId != null"  id="VOR_workflow_sidepanel_div8" >
                        <div class="customerImage" id="VOR_workflow_sidepanel_div9">
                            <img src="{!URLFOR($Resource.UserImage, 'profile-pic.jpg')}" style="height:32px; width:32px;" id="VOR_workflow_sidepanel_user_image"/>
                        </div>
                        <div class="userinfo" id="VOR_workflow_sidepanel_div10">
                            <a href="" id="VOR_workflow_sidepanel_cust_name_link"> {{VORModel.VIHeader.VendorName}}
                            </a>
                        </div>
                        <div class="customerImage" id="VOR_workflow_sidepanel_div11">
                            <img src="{!URLFOR($Resource.icon_images, 'images/hashimg.png')}" style="height:32px; width:20px;" id="VOR_workflow_sidepanel_user_image_link"/>
                        </div>
                    </div>
                </div>
                <div class="row" id="VOR_workflow_sidepanel_div12">
                    <div class="selectedUserBox" id="VOR_workflow_sidepanel_div13">
                        <div class="customerImage" id="VOR_workflow_sidepanel_div14">
                            <img src="{!URLFOR($Resource.UserImage, 'profile-pic.jpg')}" style="height:32px; width:32px;" id="VOR_workflow_sidepanel_user_img"/>
                        </div>
                        <div class="userinfo" id="VOR_workflow_sidepanel_div15">
                            <a href="" id="VOR_workflow_sidepanel_user_name_link">{!$User.FirstName} {!$User.LastName}</a>
                        </div>
                        <div class="customerImage" id="VOR_workflow_sidepanel_cust_image_div">
                            <img src="{!URLFOR($Resource.icon_images, 'images/hashimg.png')}" style="height:32px; width:20px;" id="VOR_workflow_sidepanel_cust_image1"/>
                        </div>
                    </div>
                </div>
                <div class="row " style="margin-top:10px;" id="VOR_workflow_sidepanel_info_div1" >
                    <div class="status_Info" id="VOR_workflow_sidepanel_info_div1_div1">
                        <img src="{!URLFOR($Resource.icon_images, 'images/hashimg.png')}" style="height:32px; width:20px;" id="VOR_workflow_sidepanel_cust_image1"/>
                        <span style="text-transform: uppercase">  <strong id="VOR_workflow_sidepanel_info_div1_p_1">{{VORModel.VIHeader.Status}}</strong></span>
                    </div>
                </div >
                <br/>
                <div class="row sections-link" id="workflow-actions" >
                    <div class="heading" id="VOR_workflow_workflow_actions_div1">
                        <a href="#VOI_Info_Block" rel="#VOI_Info_Block" id="VOR_workflow_workflow_actions_link1" ng-click="VORModel.setHighlightedSection = 'Info'">
                            <span id="VOR_workflow_workflow_actions_span1_1" ng-class="{'color-orange' : VORModel.setHighlightedSection == 'Info'}">A &nbsp; Info </span>
                        </a>    
                    </div>
                    <div class="sub-heading" id="VOR_workflow_workflow_actions_div2">
                        <a href="#VOI_General_Block" rel="#VOI_General_Block" id="VOR_workflow_workflow_actions_link2" ng-click="VORModel.setHighlightedSection = 'General'">
                            <span class="link" id="VOR_workflow_workflow_actions_span2_1" ng-class="{'color-orange' : VORModel.setHighlightedSection == 'General'}"><strong id="VOR_workflow_workflow_actions_p2"></strong> &nbsp; General</span>
                        </a>
                        <!-- <span class="icons" id="VOR_workflow_workflow_actions_span2_1">
                            <i class="fa fa-circle online" id="VOR_workflow_workflow_actions_p3"></i>
                        </span> -->
                    </div>
                    <div class="sub-heading" id="VOR_workflow_workflow_actions_div3" ng-if="VORModel.VIHeader.Status != 'Invoiced'">
                        <a href="#VOI_Vendor_Order_Receiving_Block" rel="#VOI_Vendor_Order_Receiving_Block" id="VOR_workflow_workflow_actions_link3" ng-click="VORModel.setHighlightedSection = 'VOR Receivinig'">
                            <span class="link" id="VOR_workflow_workflow_actions_span3_1" ng-class="{'color-orange' : VORModel.setHighlightedSection == 'VOR Receivinig'}"><strong id="VOR_workflow_workflow_actions_p3"></strong> &nbsp; Receivings</span>
                        </a>
                        <!-- <span class="icons" id="VOR_workflow_workflow_actions_span3_1">
                            <i class="fa fa-circle online" id="VOR_workflow_workflow_actions_p5"></i>
                        </span> -->
                    </div>
                    
                    <div class="heading" id="VOR_workflow_workflow_actions_div4">
                        <a href="#VOI_Items_Block" rel="#VOI_Vendor_invoicing_Block" id="VOR_workflow_workflow_actions_link6" ng-click="VORModel.setHighlightedSection = 'Received'">
                            <span id="VOR_workflow_workflow_actions_span4_1" ng-class="{'color-orange' : VORModel.setHighlightedSection == 'Received'}">B &nbsp; Invoice </span>
                        </a>    
                    </div>
                    <div class="sub-heading" id="VOR_workflow_workflow_actions_div5">
                        <a href="#VOI_Items_Block" rel="#VOI_Items_Block" id="VOR_workflow_workflow_actions_link7" ng-click="VORModel.setHighlightedSection = 'Items'">
                            <span class="link" id="VOR_workflow_workflow_actions_span5_1" ng-class="{'color-orange' : VORModel.setHighlightedSection == 'Items'}"><strong id="VOR_workflow_workflow_actions_p4"></strong> &nbsp; Items</span>
                        </a>
                        <!-- <span class="icons" id="VOR_workflow_workflow_actions_span5_1">
                            <i class="fa fa-circle online" id="VOR_workflow_workflow_actions_p4"></i>
                        </span> -->
                    </div>

                    <div class="sub-heading" id="VOR_workflow_workflow_actions_div7" 
                        ng-show="VORModel.VIHeader.VendorId != null" >
                        <a href="#VOR_Outstanding_Items_Block" rel="#VOR_Outstanding_Items_Block"
                         id="VOR_workflow_workflow_actions_link8" ng-click="VORModel.setHighlightedSection = 'Outstanding'">
                            <span class="link" id="VOR_workflow_workflow_actions_span8" ng-class="{'color-orange' : VORModel.setHighlightedSection == 'Outstanding'}"><strong id="VOR_workflow_workflow_actions_p8"></strong>  
                                &nbsp; Other Charges
                            </span>
                        </a>
                        <!-- <span class="icons" id="VOR_workflow_workflow_actions_span6_1">
                            <i class="fa fa-circle offline" id="VOR_workflow_workflow_actions_p3_1"></i>
                        </span> -->
                    </div>
                    
                    <div class="heading" id="VOR_workflow_workflow_actions_div{{8 + VORModel.SelectedVendorOrdersList.length}}">
                        <a href="#VO_Finalize_Section" rel="#VOR_Finalize_Block" id="VOR_workflow_workflow_actions_link{{9 + VORModel.SelectedVendorOrdersList.length}}" ng-click="VORModel.setHighlightedSection = 'Finalize'">
                            <span id="VOR_workflow_workflow_actions_span{{8 + VORModel.SelectedVendorOrdersList.length}}_1" ng-class="{'color-orange' : VORModel.setHighlightedSection == 'Finalize'}">C &nbsp; Finalize </span>
                        </a>    
                    </div>
                </div>
                <div class="left-panel-price" id="VOR_left-panel-price"> 
                    <div class="row total_price" id="VOR_left-panel-price_total_price">
                        <div class="col-lg-5 col-md-5 form-label" id="VOR_left-panel-price_total_price_form-label">
                            <strong style="text-transform: uppercase">ITEMS</strong>
                        </div>
                        <div class="col-lg-4 col-md-4 price" id="VOR_left-panel-price_total_price_price">
                            <span id="VOR_left-panel-price_total_price_price_span">${{VORModel.ItemsTotal}}</span> 
                        </div>
                        <div class="col-lg-3 col-md-3">
                            &nbsp;
                        </div>
                        
                         <div class="col-lg-5 col-md-5 form-label" id="VOR_left-panel-price_total_price_form-label">
                            <strong style="text-transform: uppercase">OTHER CHARGES</strong>
                        </div>
                        <div class="col-lg-4 col-md-4 price" id="VOR_left-panel-price_total_price_price">
                            <span id="VOR_left-panel-price_total_price_price_span">$0</span>
                        </div>
                        <div class="col-lg-3 col-md-3">
                            &nbsp;
                        </div>
                         <div class="col-lg-9 col-md-9 form-label" id="VOR_left-panel-price_total_price_form-label">
                            <hr/>
                        </div>
                         <div class="col-lg-5 col-md-5 form-label" id="VOR_left-panel-price_total_price_form-label">
                            
                        </div>
                        <div class="col-lg-4 col-md-4 price" id="VOR_left-panel-price_total_price_price">
                            <span id="VOR_left-panel-price_total_price_price_span">${{VORModel.ItemsTotal}}</span>
                        </div>
                        <div class="col-lg-3 col-md-3">
                            &nbsp;
                        </div>
                         <div class="col-lg-5 col-md-5 form-label" id="VOR_left-panel-price_total_price_form-label">
                            <strong style="text-transform: uppercase">TAXES</strong>
                        </div>
                        <div class="col-lg-4 col-md-4 price" id="VOR_left-panel-price_total_price_price">
                            <span id="VOR_left-panel-price_total_price_price_span">${{VORModel.PurchaseTax}}</span>
                        </div>
                        <div class="col-lg-3 col-md-3">
                            &nbsp;
                        </div> 
                        <div class="col-lg-9 col-md-9 form-label" id="VOR_left-panel-price_total_price_form-label">
                            <hr/>
                        </div>
                        <div class="col-lg-5 col-md-5 form-label" id="VOR_left-panel-price_total_price_form-label">
                            
                        </div>
                        <div class="col-lg-4 col-md-4 price" id="VOR_left-panel-price_total_price_price">
                            <span id="VOR_left-panel-price_total_price_price_span">${{VORModel.Total}}</span>
                        </div>
                        <div class="col-lg-3 col-md-3">
                            &nbsp;
                        </div>
                    </div>
                </div>
            </div>
            <!-- END: Left Side Bar -->
            
            
            <div class="col-lg-9 col-md-9 col-sm-9 topPadding" style="position: absolute; top: 30px; right: 0;">
                <div class="row sub-search-row" id="fixed-seacrh-row">
                    <div class="col-lg-3 col-md-3 order-number" id="VOR_fixed-seacrh-row_order-number">
                        <span id="VOR_fixed-seacrh-row_order-number_span" ng-show="VORModel.VIHeader.VIHeaderNumber != null && VORModel.VIHeader.VIHeaderNumber != ''">
                            {{VORModel.VIHeader.VIHeaderNumber}}
                        </span>
                        <span id="VOR_fixed-seacrh-row_order-number_span" ng-show="VORModel.VIHeader.InvoiceNumber == null || VORModel.VIHeader.InvoiceNumber == ''"></span>
                    </div>
                    <div class="col-lg-6 col-md-6 col-sm-6 col-xs-6 sub-search" id="VOR_fixed-seacrh-row_sub-search">
                        <div id="VOR_fixed-seacrh-row_sub-search_padded-row" class="padded-row" style="width:100%">
                            <c:AutoSuggestVendorOrder />
                        </div>
                    </div>
                    <div class="new-div" id="VOR_fixed-seacrh-row_sub-search_new-div">
                        <a href="">New</a>
                    </div>
                    <div class="icons-div pull-right" id="VOR_fixed-seacrh-row_sub-search_icons-div">
                        <div>
                            <a id="VOR_fixed-seacrh-row_sub-search_icons-div_a" href=""><i class="fa fa-floppy-o"></i></a>
                        </div>
                        <div>
                            <a aria-expanded="false" class="dropdown-toggle" data-toggle="dropdown" href="#" role="button" ng-if = "VORModel.totalGroupItems == 0">
                            <span class="fa fa-cog"></span>
                            </a>
                           
                            <ul id="VOR_fixed-seacrh-row_sub-search_icons-div_link_dropdown" class="link_dropdown dropdown-menu" role="menu" >
                                <li><a href="" ng-click = "VORModel.confirmDelete()">Delete Vendor Invoicing</a></li>
                            </ul>
                             <a aria-expanded="false"  role="button" ng-if = "VORModel.totalGroupItems!= 0">
                            <span class="fa fa-cog"></span>
                            </a>
                        </div>
                    </div>
                </div>
                
                <div class="row dynamic_heading heading_panel backgroundOrange" id="sticky-heading">
                    <div class="row" style="height: 30px; background-color: white"> </div>
                    <div class="left_heading col-lg-12 col-md-12" id="VOR_dynamic_heading_panel_left_heading">
                        <h1 id="VOR_dynamic_heading_panel_left_heading_h1">
                            <span class="heading_icon handCursor" ng-click="VORModel.hidePanel($event, 'VOI_Info_Block')">
                                <i class="fa fa-chevron-circle-right"></i>
                            </span>
                            <p class="header_icon_text"> A Info</p>  
                        </h1>
                    </div>
                </div>
                
                <!-- scrollable content  --> 
            <div class="row content" id="VOI_Info_Block">
                    <!-- START: General Section -->
                    <div class="row VO-form" id="VOI_General_Block">
                        <div class="row heading_panel_secondary">
                            <div class="left_heading_secondary">
                                <h1 >General </h1>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-lg-8 col-md-8">
                                <!-- START: Vendor selection section -->
                                <div class="row general_section_row">
                                    <div class="col-lg-4 col-md-4 form-label Info_section_left_div required" id="VOR_info_form-label_VENDOR">
                                        <strong class="req-label">VENDOR</strong>
                                        <i class="fa fa-question-circle gray" data-toggle="tooltip" title="Vendor"></i>
                                    </div>

                                    <div class="customerSelector" id="VOR_info_customerSelector" ng-if="VORModel.VIHeader.VendorId ==null">
                                        <div>
                                            <div class="customerImage" id="customer-order-info_customerSelector_customerImage">
                                            </div>
                                            <div class="add-new" id="customer-order-info_customerSelector_customerImage_add-new">
                                                <span id="customer-order-info_customerSelector_customerImage_add-new_span"  style="font-style: italic;">No Vendor</span>
                                                <div>
                                                    <img src="{!URLFOR($Resource.icon_images, 'images/hashimg1.png')}" style="height:32px; width:20px;" />
                                                    <a  id="customer-order-info_customerSelector_customerImage_add-new_addone" href=""
                                                        ng-click="VORModel.RelatedList_addAction($event, 'Vendor')">Add One!</a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="selectedUserBox" id="customer-order-info_selectedUserBox" ng-if="VORModel.VIHeader.VendorId !=null" >
                                        <div class="customerImage" id="customer-order-info_selectedUserBox_customerImage">
                                            <img src="{!URLFOR($Resource.UserImage, 'profile-pic.jpg')}" style="height:32px; width:32px;" />
                                        </div>
                                        <div class="userinfo" id="customer-order-info_selectedUserBox_userinfo">
                                            <a href="">{{VORModel.VIHeader.VendorName}}</a>
                                        </div>
                                        <div id="customer-order-info_selectedUserBox_customerImage" class="customerImage">
                                            <img src="{!URLFOR($Resource.icon_images, 'images/hashimg.png')}" style="height:32px; width:20px;" />
                                        </div>
                                    </div>
                                </div>
                                <!-- END: Vendor selection section -->
                                
                                <!-- START: Owner selection section -->
                                <div class="row general_section_row">
                                    <div class="col-lg-4 col-md-4 form-label Info_section_left_div" id="VOR_info_form-label_OWNER">
                                        <strong>OWNER</strong>
                                        <i class="fa fa-question-circle gray" data-toggle="tooltip" title="Owner"></i>
                                    </div>
                                    <div class="selectedUserBox" id="VOR_info_form-label_OWNER_selectedUserBox">
                                        <div class="customerImage" id="VOR_info_form-label_OWNER_selectedUserBox_customerImage">
                                            <img src="{!URLFOR($Resource.UserImage, 'profile-pic.jpg')}" style="height:32px; width:32px;" />
                                        </div>
                                        <div id="VOR_info_form-label_OWNER_selectedUserBox_userinfo" class="userinfo">
                                            <a href="">{!$User.FirstName} {!$User.LastName}</a>
                                        </div>
                                        <div id="VOR_info_form-label_OWNER_selectedUserBox_customerImage"  class="customerImage">
                                            <img src="{!URLFOR($Resource.icon_images, 'images/hashimg.png')}" style="height:32px; width:20px;" />
                                        </div>
                                    </div>
                                </div>
                                <!-- END: Owner selection section -->
                                
                                <!-- START: STATUS -->
                                <div class="row general_section_row">
                                    <div class="col-lg-4 col-md-4 form-label Info_section_left_div" id="VOR_info_form-label_STATUS">
                                        <strong>STATUS</strong>
                                        <i class="fa fa-question-circle gray" data-toggle="tooltip" title="Status"></i>
                                    </div>
                                    <div class="status_Info" id="VOR_info_form-label_STATUS_selection">
                                        <img src="{!URLFOR($Resource.icon_images, 'images/hashimg.png')}" style="height:32px; width:20px;" id="VOR_info_form-label_STATUS_selectedUserBox_customerImage"/>
                                        <span style="text-transform: uppercase">
                                            <strong id="VOR_info_form-label_STATUS_info">{{VORModel.VIHeader.Status}}</strong>
                                        </span>
                                    </div>
                                </div>
                                <!-- END: STATUS -->
                                
                                <!-- START: Packing Slip # -->
                                <div class="row general_section_row">
                                    <div class="col-lg-4 col-md-4 form-label Info_section_left_div required" id="VOR_info_form-label_PACKING_SLIP">
                                        <strong class="req-label">INVOICE #</strong>
                                        <i class="fa fa-question-circle gray" data-toggle="tooltip" title="{!$ObjectType.Vendor_Receiving_Header__c.fields.Packing_Slip_Number__c.label}"></i>
                                    </div>
                                    <div id="VOR_info_form-label_PACKING_SLIP_selection">
                                        <input type="text" class="form-control" id="InvoiceNumber" placeholder="INVOICE"
                                                maxlength="255" ng-model="VORModel.VIHeader.InvoiceNumber" rel="InvoiceNumberId"
                                                ng-class="{'redborder' : VORModel.VendorOrderReceivingFormValidationModal['InvoiceNumber']['isError'] == true}" 
                                                data-toggle="tooltip" title="{{VORModel.VIHeader['InvoiceNumber']['ErrorMessage']}}"
                                                style="width: 38%;"
                                                ng-blur="VORModel.updateVIHeaderDetails()"/>
                                    </div>  
                                </div>
                                <!-- END: Packing Slip # -->
                                <!-- START: Receiving From Invoice -->
                                  <div class="row general_section_row">
                                    <div class="col-lg-4 col-md-4 form-label Info_section_left_div required" id="VOR_info_form-label_PACKING_SLIP">
                                        <strong class="req-label">INVOICE DATE</strong>
                                        <i class="fa fa-question-circle gray" data-toggle="tooltip" title="{!$ObjectType.Vendor_Receiving_Header__c.fields.Packing_Slip_Number__c.label}"></i>
                                    </div>
                                    <div id="VOR_info_form-label_PACKING_SLIP_selection">
                                        <input type="text" class="form-control" id="InvoiceDate" placeholder="INVOICE DATE"
                                                maxlength="255" ng-model="VORModel.VIHeader.InvoiceDate" rel="InvoiceDateId"
                                                ng-class="{'redborder' : VORModel.VendorOrderReceivingFormValidationModal['InvoiceDate']['isError'] == true}" 
                                                data-toggle="tooltip" title="{{VORModel.VIHeader['InvoiceDate']['ErrorMessage']}}"
                                                style="width: 38%;" 
                                                ng-blur="VORModel.updateVIHeaderDetails()"/>
                                    </div>
                                </div>
                                  <!-- END: Receiving From Invoice -->
                            </div>
                            <div class="col-lg-4 col-md-4">
                                <!-- Calender -->
                            </div>
                        </div>
                    </div>
         
                     <!-- END: General Section -->
                     <!-- Start Invoing grid panel -->
                            
                <div class="VOR_outer_block VO-form" id="VOI_Vendor_Order_Receiving_Block"
                         ng-show="VORModel.VIHeader.VendorId != null" ng-if="VORModel.VIHeader.Status != 'Invoiced'">
                        <div class="row heading_panel_secondary" style="border: 0px;">
                            <div class="left_heading_secondary pull-left" >
                                <h1 >Receivings</h1>
                            </div>
                            <div class="right_sub pull-right" id="VOR_Vendor_Received_Block_heading_panel_right_sub">
                                <div class="dropdown" id="VIHeader_dropdown_div_bulkremove" style="float: left; margin: 5px;">
                                    <a aria-expanded="false" class="dropdown-toggle" data-toggle="dropdown" href="#" role="button" 
                                       style="padding-top: 10px; padding-bottom: 10px;" id="VIHeader_dropdown_link">
                                        <span class="fa fa-cog  Orange Customtool" style="font-size:20px;"  id="VIHeader_dropdown_span"></span>
                                    </a>
                                </div>
                                
                                <i class="fa fa-question-circle question_mark Orange Customtool custom-question"></i>
                            </div>
                        </div>
                        
                        <div class="gid_container" id="VOR_Vendor_Received_Block_grid_container_Empty_Div" 
                            ng-show="VORModel.vendorOrdersList.length == 0">
                            No records found
                        </div>
                        
                        <!-- START: Grid -->
                        <div id="1" ng-show="VORModel.VRHeaderList.length != 0">
                            <div class="general_section_row gid_container">
                                <table class="table" id="ReceivingForVendorOrders_Grid">
                                    <col width="5%"  />
                                    <col width="25%" />
                                    <col width="15%" />
                                    <col width="15%" />
                                    <col width="10%" />
                                    <col width="10%" />
                                    <col width="10%" />
                                    
                                    <tr  class="tableHeader">
                                        <th>
                                            <div class="form-group small" >
<!--                                                 <label class="checkbox"> -->
<!--                                                     <span class="chk_tick" ng-class="{'chked' : VORModel.isAllVOSelected == true, 'disabled_chk_tick' : VORModel.isAllVOSelected == null}"  -->
<!--                                                                             ng-click="VORModel.onClickSelectAllVO($event);" -->
<!--                                                                             style="margin-top: -15px; height: 30px; width: 30px;"> -->
<!--                                                         <i class="fa fa-check-square chksqure" style="font-size: 40px;"></i> -->
<!--                                                     </span> -->
<!--                                                 </label> -->
                                            </div>
                                        </th>
                                        <th style="cursor: pointer;" ng-click="VORModel.Receiving_PageSortControlsAction();">
                                            <i class="fa fa-sort-asc" ng-show="VORModel.receivingPageSortAttrsJSON.Sorting[0].SortDirection == 'ASC'"/>
                                            <i class="fa fa-sort-desc" ng-show="VORModel.receivingPageSortAttrsJSON.Sorting[0].SortDirection == 'DESC'"/>
                                            <i class="fa fa-sort" ng-show="VORModel.receivingPageSortAttrsJSON.Sorting[0].SortDirection == ''"/>
                                            PACKAGING SLIP #
                                        </th>
                                        <th>ORDER # </th>
                                        <th>DATE</th>
                                        <th>LINE ITEMS</th>
                                        <th>TOTAL COST</th>
                                        <th>RECEIVED BY</th>
                                    </tr>
                                    <tbody ng-repeat="vRHeader in VORModel.VRHeaderList" >
                                        <!-- START: Vendor Orders list -->
                                        
                                        <tr class="clickable_row" id="rowGroup{{$index}}" rel="VOR_Vendor_Received_row{{$index}}_edit" >
                                            <td colspan="1">  
                                                <div class="form-group small" >
                                                    <label class="checkbox">
                                                        <span class="chk_tick" ng-class="{'chked' : vRHeader.InProgressVIHeaderId !=null}" 
                                                                                ng-click="VORModel.onClickSelectVO($event, $index, vRHeader.VRHeaderId);"
                                                                                style="margin-top: -15px; height: 30px; width: 30px;">
                                                            <i class="fa fa-check-square chksqure" style="font-size: 40px;"></i>
                                                        </span>
                                                    </label>
                                                </div>
                                            
                                            </td>
                                            <td colspan="1">
                                            	<a ng-mouseover="VORModel.showInvoiceDetail(vRHeader.VRHeaderId,$event)"
                                                            ng-mouseleave="VORModel.hideInvoiceDetail()">
                                                            {{vRHeader.PackingSlipNumber}}
                                                </a>
                                            </td>
                                            <td colspan="1">{{vRHeader.OrderType}}</td>
                                            <td colspan="1">{{vRHeader.FinalizeDate}}</td>
                                            <td colspan="1">{{vRHeader.TotalNumberOfLineItems}}</td>
                                            <td colspan="1">${{vRHeader.TotalCost}}</td>
                                            <td colspan="1">{{vRHeader.ReceivedByName}}</td>
                                            
                                          
                                        </tr>
                                       
                                    </tbody>
                                </table>
                            </div>
                            
                            <!-- Pagination container -->
                            <div class="pagination_container" id="Receiving_For_Vendor_Orders_Pagination" ng-if="VORModel.totalVendorOrderInvoicing != undefined" >
                                <list-pagination id-value = "Receiving_For_Vendor_Orders_Pagination_" 
                                                 total-records-length = "VORModel.totalVendorOrderInvoicing"
                                                 page-size = "VORModel.receivingPageSortAttrsJSON.PageSize"
                                                 current-page = "VORModel.receivingPageSortAttrsJSON.CurrentPage"
                                                 changes-count = "VORModel.receivingPageSortAttrsJSON.ChangesCount"
                                                 pagination-control-method = "VORModel.Receiving_paginationControlsAction" />
                            </div>
                        </div>
                        <!-- END: Grid -->
                    </div>
                <div class="clearfix"></div>
                
                    <!-- start Invoicing section -->    
                    
                <div class=" Order_Section" id="VOI_Vendor_invoicing_Block">
                             <div  id="VI_order_section_heading">
                                <div class="row  heading_panel_Main  backgroundOrange" >
                                    <div class="row" style="height: 10px; background-color: white"> </div>
                                    <div class="left_heading col-lg-12 col-md-12" id="VI_dynamic_heading_panel_left_heading">
                                        <h1 id="CO_dynamic_heading_panel_left_heading_h1">
                                            <span class="heading_icon handCursor" ng-click="VORModel.hidePanel($event, 'Vendor_Orders')" >
                                                <i class="fa fa-chevron-circle-right"></i>
                                            </span>
                                            <p class="header_icon_text"> B Invoicing....TOTAL ${{VORModel.ItemsTotal}}</p>
                                        </h1>
                                    </div>
                                </div>
                            </div>
                            <div class="clearfix"></div>
                             <div class="VO_outer_block" id="Vendor_Orders">
                                <div class="VO-form" id="VOI_Items_Block">
                                    <div class="row heading_panel_secondary">
                                        <div class="left_heading_secondary pull-left" >
                                            <h1 >Items
                                                <i class="fa fa-plus-square plush_sign Orange handCursor" id="Order_Block_heading_panel_left_sub_h1_text_plus_icon"></i>
                                            </h1>
                                        </div>
                                        
                                        <div class="right_sub pull-right" id="Merchandise_block_heading_panel_right_sub">
                                                   <div class="dropdown" id="VOR_header_dropdown_div_bulkremove" style="float: left; margin: 5px;">
                                                        <a aria-expanded="false" class="dropdown-toggle" data-toggle="dropdown" href="#" role="button" 
                                                            style="padding-top: 10px; padding-bottom: 10px;" id="VOR_header_dropdown_link">
                                                            <span class="fa fa-cog  Orange Customtool" style="font-size:20px;"  id="VOR_header_dropdown_span"></span>

                                                            </a>
                                                            <ul class="link_dropdown dropdown-menu" role="menu" id="VOR_header_dropdown_ul" style="margin-left:-160px; display:none;">
                                                                <li><a href="#" id="VOR_header_dropdown_profile" ng-click="VORModel.removeAllReceived()">Remove All Item</a></li>


                                                            </ul>
                                                        </div>
                                                   <i class="fa fa-question-circle question_mark Orange Customtool custom-question"></i>


                                             </div>
                                    </div> 
                                    
                                    <div class="gid_container" id="VO_Order_block_grid_container_Empty_Div" 
                                        ng-show="VORModel.VIGroupList.length == 0">
                                        No records found
                                    </div>
                                     <div id="1" ng-show="VORModel.VIGroupList.length != 0">
                                        <div class=" general_section_row">
                                            <div class="gid_container" id="VO_Order_block_grid_container">
                                                <table class="table" id="VendorOrderItem_Grid">
                                                    <col width="3%"  />
                                                    <col width="3%"  />
                                                    <col width="20%" />
                                                    <col width="34%" />
                                                    <col width="40%" />
                                                    <tr  class="tableHeader">
                                                        <th></th>
                                                        <th></th>
                                                        <th style="cursor: pointer;" ng-click="VORModel.GroupItems_PageSortControlsAction();">
                                                            <i class="fa fa-sort-asc" ng-show="VORModel.groupItemsPageSortAttrsJSON.Sorting[0].SortDirection == 'ASC'"/>
                                                            <i class="fa fa-sort-desc" ng-show="VORModel.groupItemsPageSortAttrsJSON.Sorting[0].SortDirection == 'DESC'"/>
                                                            <i class="fa fa-sort" ng-show="VORModel.groupItemsPageSortAttrsJSON.Sorting[0].SortDirection == ''"/>
                                                            ITEM/DESC
                                                        </th>
                                                       
                                                        <th>
                                                                <div class="row">
                                                                    <div class="col-md-12" ><div class="linetext"><h3><span>Receiving</span> </h3> </div></div>
                                                                    <div class="col-md-5" >Packaging Slip# </div>
                                                                    <div class="col-md-3" >QTY </div>
                                                                    <div class="col-md-4" >COST </div>
                                                                </div>
                                                        </th>
                                                        <th>
                                                                <div class="row">
                                                                    <div class="col-md-12" ><div class="linetext"><h3><span>Vendor Invoicing</span> </h3> </div></div>
                                                                    <div class="col-md-3" >QTY </div>
                                                                    <div class="col-md-3" >COST </div>
                                                                    <div class="col-md-3" >DISCOUNT </div>
                                                                    <div class="col-md-3" >SUB-TOTAL </div>
                                                                </div>  
                                                        </th>
                                                        
                                                    </tr>
                                                        <tbody  ng-repeat="VIGroup in  VORModel.VIGroupList" >
                                                            <tr class="clickable_row" id="rowGroup{{$index}}" rel="vogroup_item_row{{$index}}_edit"  
                                                                ng-click="VORModel.editGroupItem($event, $index)">
                                                                <td id="VO_Group_block_grid_container_tbody_tr_td_1_{{$index}}" class="group_exapnded_tr">
                                                                    <i class="fa fa-wrench"></i>
                                                                </td >  
                                                                <td></td>
                                                                <td  id="VO_Group_block_grid_container_tbody_tr_td_2_{{$index}}" >
                                                                     <div>
                                                                        <a ng-mouseover="VORModel.showPartPopUp($event, VIGroup.PartId);" ng-mouseleave="VORModel.hidePartPopUp();">
                                                                            {{ VIGroup.Item}}
                                                                        </a>
                                                                        <div ng-if="VIGroup.PackageUnit !=null && VIGroup.PackageUnit !='NUll'"  style="color:red">{{VIGroup.OrderType}}</div>  
                                                                     </div>
                                                                    
                                                                </td>
                                                                <td>
                                                                        <div class="row">
                                                                            <div class="col-md-5" > {{ VIGroup.PackingNumber}} </div>
                                                                            <div class="col-md-3" >
                                                                                <div>
                                                                                        <div  style="width:40%;text-align:right;float:left">{{VIGroup.ReceivingQty}}</div> 
                                                                                        <div  style="width:50%;text-align:left;float:left" ng-if="VIGroup.PackageUnit !=null && VIGroup.PackageUnit !='NUll'">{{VIGroup.PackageUnit}}</div>
                                                                                </div>
                                                                             </div>
                                                                            <div class="col-md-4" >${{VIGroup.ReceivingCost}} </div>
                                                                        </div>  
                                                                </td>
                                                                <td>
                                                                        <div class="row">
                                                                            <div class="col-md-3" > 
                                                                                    <div >
                                                                                        <div  style="width:40%;text-align:right;float:left">{{VIGroup.InvoiceQty}}</div> 
                                                                                        <div  style="width:50%;text-align:left;float:left" ng-if="VIGroup.PackageUnit !=null && VIGroup.PackageUnit !='NUll'">{{VIGroup.PackageUnit}}</div>
                                                                                    </div>
                                                                             </div>
                                                                            <div class="col-md-3" >
                                                                                <div  ng-show="VORModel.VIGroupListItems_editRow[$index].isEdit !=true" >${{VIGroup.InvoiceCost}}</div>
                                                                                <div  ng-show="VORModel.VIGroupListItems_editRow[$index].isEdit ==true" >
                                                                                     <input ng-model="VIGroup.InvoiceCost"  class="form-control"  />
                                                                                </div>
                                                                            </div>
                                                                                <div class="col-md-3" >
                                                                                    <div  ng-show="VORModel.VIGroupListItems_editRow[$index].isEdit !=true" >{{VIGroup.Discount}}%</div>
                                                                                    <div  ng-show="VORModel.VIGroupListItems_editRow[$index].isEdit ==true"  ng-keydown="VORModel.editRowTabOutLast($event,$index)"> 
                                                                                        <input ng-model ="VIGroup.Discount"  class="form-control"  />
                                                                                    </div>
                                                                                </div>
                                                                            <div class="col-md-3" >${{VIGroup.SubTotal}} </div>
                                                                        </div>
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <td colspan="5" class="group_exapnded_tr" ng-show="VORModel.VIGroupListItems_editRow[$index].isEdit"> 
                                                                     <div class="show_Availableline">
                                                                         INVENTORY ITEM COST @  {{parseInt(VIGroup.InvoiceCost) + parseInt(VIGroup.Discount)}} - ${{VIGroup.DiscountAmout}} ({{VIGroup.Discount}}%) + ${{(VIGroup.SubTotal * 1)}}FX + ${{VIGroup.LcaAmount}}LCA =
                                                                                 {{VIGroup.SubTotal + (VIGroup.SubTotal * 1) + VIGroup.LcaAmount }} /{{ VIGroup.PackageUnit !=null ? VIGroup.PackageQty: 1}} = {{(VIGroup.SubTotal + (VIGroup.SubTotal * 1) + VIGroup.LcaAmount )/(VIGroup.PackageUnit !=null ? VIGroup.PackageQty: 1)}}
                                                                     </div>
                                                                </td>
                                                            </tr>
                                                              <tr ng-show="VORModel.VIGroupListItems_editRow[$index].isEdit"
                                                                class="edit_panel sample-show-hide" id="vogroup_item_row{{$index}}_edit">
                                                                    <td colspan="9" id="CO_Merchandise_block_grid_container_tbody_expandtr_td_1_{{$index}}">
                                                                        <div id="vogroup_tbody_expandtr_edit_box_{{$index}}" class="edit_box col-lg-9 col-md-9" >
                                                                            <div class="its-heading" id="CO_Merchandise_block_grid_container_tbody_expandtr_edit_box_its-heading_{{$index}}">
                                                                                <img src="{!URLFOR($Resource.icon_images, 'images/edit_icon.png')}" styleClass="img_action"/>
                                                                                <span>Actions (1 Actions Available)</span>
                                                                            </div>
                                                                            <div id=" vogroup_tbody_expandtr_edit_box_its-heading_edit-body_{{$index}} " class="edit-body">
                                                                                <form>
                                                                                    <div class="radio" id="vogroup_tbody_expandtr_edit_box_its-heading_edit-body_{{$index}}_radio_1">
                                                                                        <label>
                                                                                            <input type="radio" name="optionsRadios" id="optionsRadios2" value="2" /> 
                                                                                           
                                                                                            <span>Modify Receiving</span>
                                                                                        </label>
                                                                                    </div>
                                                                                    <div class="radio" id="vogroup_tbody_expandtr_edit_box_its-heading_edit-body_{{$index}}_radio_2">
                                                                                        <label>
                                                                                            <input type="radio" name="optionsRadios" id="optionsRadios2" value="2" />
                                                                                            
                                                                                            <span>Adjusting Inventory Item Costing</span>
                                                                                        </label>
                                                                                    </div>
                                                                                    <a href="" id="vogroup_tbody_expandtr_edit_box_its-heading_edit-body_{{$index}}_go_btn" class="btn btn-default editform_btn" role="button"
                                                                                        ng-click="VORModel.groupItemsGoAction($index)" >Go</a>                                
                                                                                </form>
                                                                            </div>
                                                                            <a href="" class="faq_link">
                                                                            <i class="fa fa-question-circle qmark"></i>
                                                                            </a>
                                                                        </div>
                                                                    </td>
                                                            </tr>
                                                        </tbody>  
                                                         
                                                </table>
                                    
                                            </div>
                                        </div>
                                        
                                        <!-- Pagination container -->
                                        <div class="pagination_container" id="Vendor_Order_Items_Pagination" ng-if="VORModel.totalGroupItems != undefined" >
                                            <list-pagination id-value = "Vendor_Order_Items_Pagination_" 
                                                             total-records-length = "VORModel.totalGroupItems"
                                                             page-size = "VORModel.groupItemsPageSortAttrsJSON.PageSize"
                                                             current-page = "VORModel.groupItemsPageSortAttrsJSON.CurrentPage"
                                                             changes-count = "VORModel.groupItemsPageSortAttrsJSON.ChangesCount"
                                                             pagination-control-method = "VORModel.GroupItems_paginationControlsAction" />
                                        </div>
                                        
                                    </div>
                        </div>          
                                         
                     </div>
                </div>
                </div>
             <!-- END Invoicing -->     
            
            <div class="Finalize_Section row" id="VO_Finalize_Section">
                     <div id="VR_order_section_heading">
                         <div class="row  heading_panel_Main  backgroundOrange" >
                             <div class="row" style="height: 10px; background-color: white"> </div>
                             <div class="left_heading col-lg-12 col-md-12" id="CO_dynamic_heading_panel_left_heading">
                                 <h1 id="CO_dynamic_heading_panel_left_heading_h1">
                                     <span class="heading_icon handCursor" ng-click="VORModel.hidePanel($event, 'VO_Order_finalize_container')" >
                                         <i class="fa fa-chevron-circle-right"></i>
                                     </span>
                                     <p class="header_icon_text">C Finalize Order</p>
                                 </h1>
                             </div>
                         </div>
                        </div>
                        
                        <div class="clearfix"></div>
                        
                        <div >
                            <div>
                                <div class="gid_container" id="VO_Order_finalize_container">
                                    <button id="CO_active_invoice_not_Invoiced_gid_container_finalize_btn" class="large_btn btn" 
                                            ng-class="{'active_btn' : (VORModel.vendorOrderLineItemGroupList.length != 0 && VORModel.VIHeader.Status != 'Invoiced')}"  
                                            ng-disabled='VORModel.VIGroupList.length == 0 || VORModel.VIHeader.Status == "Invoiced"' 
                                            ng-click="VORModel.finalizeOrder()" >FINALIZE INVOICE</button>
                                 </div>
                            </div>
                            </div>
                            
                    </div>
                        
            <div style="height: 200px;" id="CO_dummydiv" /> 
        
    </div>
    </div>

    <c:PartsChartPopup />
</body>
</html>
</apex:page>