<apex:page standardStylesheets="false" showChat="false" showHeader="false" sidebar="false" controller="NewViewCustomerCtrl">
    <html ng-app="viewCus">


    <head>
        <title>View Customer</title>
        
        <c:Css_and_Js />
        <c:NewViewCustomerStyle />  
        <c:NewDirPagination />
           
       
        <style>
            .round_btn{
                border-radius:3pt;
                padding:3px 0px;
                height: 24px;   
            }
            .rowGeneral .subsectionGeneral {
                padding-left: 10px;
                padding-right: 10px
            }
            .rowGeneral .subsectionGeneral_rightonly {
                padding-right: 10px
            }
            .main_section .rowGeneral {
                padding-right: 4%;
            }
            .Profile_pic {
                padding-right: 0px;
            }
            .rowGeneral .Active_Button {
                Padding: 0px;
                height: 24px;
            }
            .rowGeneral .Active_Button_row {
                Padding-right: 0px;
                margin-top: 12px;
            }
            .rowGeneral .see_more_button {
                padding-top: 0px;
                padding-bottom: 0px;
            }
            .rowGeneral .see_more_button_row {
                margin-top: 20px;
            }
            .rowGeneral .social_icon_row {
                margin-top: 12px;
            }
            .rowGeneral .social_icon_row a:hover{
                text-decoration: none;
            }
            .rowGeneral .icon_google {
                color: #d34836;
                font-size: 24px;
            }
            .rowGeneral .icon_in {
                color: #007bb6;
                font-size: 24px;
            }
            .rowGeneral .icon_fb {
                color: #3B5998;
                font-size: 24px;
            }
            .rowGeneral .icon_tweet {
                color: #00AEEF;
                font-size: 24px;
            }
            .favorite {
                font-size: 10px
            }
            .non_favorite {
                margin-left: 9px;
            }
            .label_favorite {
                margin-left: 5px;
            }
            .customer_general_column {
                padding-right: 1px;
            }
            .rowGeneral .general_info_customer {
                margin-top: 12px;
            }
            .rowGeneral .statistics_row {
                margin-top: 24px
            }
            .telemetry_Main {
                border-top: 1px solid #ECF0F1;
                margin-top: 24px;
            }
            .cou_plus_icon {
                margin-left: 10px;
                color: #939CA9;
            }
            .main_section_COU {
                margin-bottom: 48px;
                margin-top: 21px;
            }
            .main_section_COU .line {
                border-top: 1px solid #ECF0F1;
                margin: 0px 20px 0px 20px;
            }
            .main_section_COU_Header .actionRow .sectionText {
                font-weight: bold;
                color: #000000;
                margin-left: 24px;
            }
            .main_section_COU_Header {
                border-top: 1px solid #ECF0F1;
                margin: 0px 20px 0px 20px;
                padding-top: 24px;
                border-top: 1px solid #ECF0F1;
            }
            .gid_container_Customer .table {
                border: 0;
            }
            .main_section_COU_Header .actionRow .actionText {
                margin-left: 5px;
                color: #939CA9;
            }
            .clickable_row .first_img {
                height: 30px;
            }
            .gid_container_Customer .table th {
                border: none;
                padding-top: 15px;
                padding-bottom: 15px;
            }
            .gid_container_Customer .table tbody {
                border: none;
            }
            .gid_container_Customer .table tbody > tr > td {
                border: none;
                padding-top: 2px;
                padding-bottom: 2px;
                vertical-align: middle;
            }
            .gid_container_Customer .table tbody .tddropdown td {
                padding-top: 2px;
                padding-bottom: 2px;
                vertical-align: middle;
            }
            .angucomplete-dropdown {
                width: 100%;
                margin-top: 28px;
            }
            .gid_container_Customer .tableHeader {
                margin-left: -15px;
                margin-right: -15px;
            }
            .gid_container_Customer .S2 {
                margin-left: 12px;
                margin-right: 12px;
            }
            .gid_container_Customer table tr.edit_panel {
                background: #fff;
            }
            .gid_container_Customer table tr.edit_panel,
            .gid_container_Customer table tr.Editable_row {} .gid_container_Customer table tr.edit_panel.show_tr {
                display: table-row;
            }
            .gid_container_Customer table tr.edit_panel input[type="radio"] {
                float: left;
                position: relative;
            }
            .gid_container_Customer table tr.edit_panel td .edit_box .edit-body .editform_btn {
                position: absolute;
                right: 20px;
                top: 87px;
                width: 50px;
            }
            .gid_container_Customer table tr.edit_panel td {
                overflow: hidden;
                height: 0;
                padding-top: 5px;
            }
            .gid_container_Customer table tr.edit_panel td .edit_box {
                border: 1px dashed #A8A8A8;
                margin: 10px 5px;
                position: relative;
            }
            .gid_container_Customer table tr.edit_panel.animate_tr td {
                border-left: 3px solid #939393;
                height: auto;
                padding: 4px;
            }
            .gid_container_Customer table tr.edit_panel td .edit_box.ng-hide {
                height: 0;
            }
            .gid_container_Customer table tr.edit_panel td .edit_box {
                transition: all 0.5s ease;
            }
            .edit_box {
                transition: .5s linear all;
                height: 130px;
            }
            .gid_container_Customer table tr.edit_panel.animate_tr {
                margin-top: 10px;
                transition: all 0.5s ease;
            }
            .gid_container_Customer table tr.edit_panel td .edit_box .its-heading {
                position: absolute;
                left: 24px;
                top: -15px;
                min-width: 175px;
                background: #fff;
                min-height: 30px;
                padding: 6px;
                font-size: 14px;
                color: #939CA9;
                font-weight: bold;
            }
            .gid_container_Customer .table .clickable_row .edite_btn {
                height: 38px;
                width: 38px;
                float: left;
                padding: 4px;
                margin: 4px 0;
            }
            .gid_container_Customer table tr.edit_panel td .edit_box .edit-body {
                margin: 26px;
            }
            .animate-showContent {
                opacity: 1;
            }
            .animate-showContent.ng-hide-add.ng-hide-add-active,
            .animate-showContent.ng-hide-remove.ng-hide-remove-active {
                -webkit-transition: all ease-in-out 0.1s;
                transition: all ease-in-out 0.1s;
            }
            .animate-showContent.ng-hide {
                line-height: 0;
                opacity: 0;
                padding: 0 10px;
            }
            .caret {
                font-size: 16px
            }
            .statistics_row .tiles {
                padding-left: 10px;
                padding-right: 10px;
            }
            @media screen and (min-width: 1200px) {
                .mb-datepicker {
                    width: 350px;
                }
                .mb-datepicker table {
                    width: 350px;
                    border-spacing: 13px 5px;
                    border-collapse: inherit;
                }
                .mb-datepicker table tbody {
                    display: block;
                    border: 1px solid #B7BEC6;
                    border-collapse: separate;
                    margin: -13px;
                    margin-top: 2px;
                    border-radius: 1px;
                }
            }
            @media screen and (max-width: 1200px) {
                .mb-datepicker {
                    width: 300px;
                }
                .mb-datepicker table {
                    width: 300px;
                    border-spacing: 6px 5px;
                    border-collapse: inherit;
                }
                .mb-datepicker table tbody {
                    display: block;
                    border: 1px solid #B7BEC6;
                    border-collapse: separate;
                    margin: -6px;
                    margin-top: 2px;
                    border-radius: 1px;
                }
            }
            .mb-datepicker {
                background-color: #fff;
                margin-top: 0px;
                margin-left: 10px;
                font-family: 'Open Sans', sans-serif;
            }
            .mb-datepicker table tbody tr td.day-head {
                background-color: #fff;
                border-bottom: 1px solid #FFF;
            }
            .mb-datepicker table tbody tr td.day-head:hover {
                background-color: #fff;
                border-bottom: 1px solid #FFF;
            }
            .header-year-wrapper {
                padding-top: 5px;
                padding-bottom: 5px;
                color: white;
                font-family: \"Open Sans\", sans-serif;
             font-size: 16px;
                background-color: #B7BEC6;
            }
            .header-month {
                width: 66%;
            }
            .header-nav-wrapper {
                padding-top: 2px;
                padding-bottom: 1px;
                color: #fff;
                font-family: \"Open Sans\", sans-serif;
                font-size: 15px;
                background-color: #B7BEC6;
                text-transform: uppercase;
            }
            .header-nav-wrapper .header-item {
                 margin-top:2px
            }
            .mb-datepicker table tbody tr td {
                padding: 4px;
                color: #939CA9;
            }
            .day {
                color: #000 !important;
            }
            .mb-datepicker table tbody tr.days .day-item:hover {
                background-color: #FFF;
                color: #000 !important;
            }
            .today {
                border: 1px solid #00AEEF;
                background-color: #FFF !important;
                color: #000 !important;
            }
            .searchToAdd .input-group{
                border: 2px solid #fff;
                margin-top: -2px;
             }
            #SearchToAddElement > .form-control{
                border: none;
                box-shadow: none;
                height: 32px;
            }
            .disabledSearchToAddElement .angucomplete-holder .form-control  {
                background: #dddddd;
                pointer-events: none;
            }           
            .disabledSearchToAddElement .angucomplete-holder .form-control .anguinput  {
                background: #dddddd;
            }
            .emailBreak	{
                	word-break: break-all;
            }
            
            
            /* Added by pooja */
            .searchToAdd_ML110	{
            	margin-left: 110px;
            }
            
            .userNameblock_ML5	{
            	margin-left: 5px;
            }
            
            /* Added by Richa */
            .statistics_row .C7 > div {
                padding-top:20px;
                padding-left: 20px;
                padding-right: 20px;
                text-align: center;
            }
            /* Added by Richa */
        </style>
          
        
    
    <!--     <apex:includeScript value="{!URLFOR($Resource.AngularResources, 'js/googlemapapiv3.js') }" /> -->
    <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false"></script>
    <apex:includeScript value="{!$Resource.AngularMap}"/>

    <apex:stylesheet value="{!URLFOR($Resource.angular_calender, 'mbdatepicker.css')}"/>
    
    <apex:includeScript value="{!URLFOR($Resource.angular_calender, 'mbdatepicker.js')}"/>
    <apex:includeScript value="{!URLFOR($Resource.angular_calender, 'moment.js')}"/>
    <c:NewAddEditCustomer />
    <c:NewAddNewCOU />
    <c:NewAddEditCustomerContact />
    <c:NewTaxExemption />

    <script>
        var viewCus = angular.module('viewCus', ['BPGlobalHeader', 
        										'ngMap', 
        										'ngAnimate', 
        										'searchToAddModule', 
        										'materialDatePicker', 
        										'addNewCOUModule', 
        										'addNewContact', 
        										'taxExemptionModule',
        										'dir.listPagination', 
        										'ui-notification']);


        viewCus.controller('ViewCustomer', function ($scope, $timeout, CustomerInfoService, RelatedCustomersService, CustomerOwnedUnitsService, CustomerActiveOrdersService, CustomerContactsService, Notification) {
            // Variable declarations
            $scope.ViewCustomer = {};
            $scope.ViewCustomer.CustomerInfo = {};
            $scope.SearchToadd = {};
            $scope.CustomerModal = {};
            $scope.COUModal = {};
            $scope.ViewCustomer.ShowMore = true;
            $scope.ViewCustomer.customerId = "{!JSENCODE(URLENCODE($CurrentPage.parameters.id))}";
            $scope.ViewCustomer.showAllData = 1;
            $scope.ViewCustomer.activeAddress = "BillingAddress"
            $scope.ViewCustomer.addressOnMap = "";
            
            // Map variable to hold order of sorting
            var sortOrderMap = {
                "ASC"   :   "DESC",
                "DESC"  :   ""
            };
            
            // Pagination and sort related JSON
            $scope.ViewCustomer.COUPageSortAttrsJSON = {};
            $scope.ViewCustomer.ActiveOrdersPageSortAttrsJSON = {};
            $scope.ViewCustomer.customersPageSortAttrsJSON = {};
            $scope.ViewCustomer.contactsPageSortAttrsJSON = {};
            //var orgin   =  '{!JSENCODE($Organization.Street)}' + ',' + '{!JSENCODE($Organization.City)}' + ', ' + '{!JSENCODE($Organization.State)}' + ',' + '{!JSENCODE($Organization.Country)}' +',' + '{!JSENCODE($Organization.PostalCode)}';
            $scope.ViewCustomer.OriginAddress = '';
            // Method to set default page sort attributes JSON
            $scope.ViewCustomer.setDefaultPageSortAttrs = function() {
                
                $scope.ViewCustomer.COUPageSortAttrsJSON = {
                    ChangesCount    :   0,
                    CurrentPage     :   1,
                    PageSize        :   10,
                    Sorting :   [{
                        FieldName       :   "ItemDesc",
                        SortDirection   :   "ASC"
                    }]
                };
                try{
                    $scope.ViewCustomer.COUPageSortAttrsJSON.PageSize = '{!JSENCODE(TEXT(Related_List_Page_Size))}';
                } catch (ex){}
                

                $scope.ViewCustomer.ActiveOrdersPageSortAttrsJSON = {
                    ChangesCount    :   0,
                    CurrentPage     :   1,
                    PageSize        :   10,
                    Sorting :   [{
                        FieldName       :   "Name",
                        SortDirection   :   "ASC"
                    }]
                };
                try{
                    $scope.ViewCustomer.ActiveOrdersPageSortAttrsJSON.PageSize = '{!JSENCODE(TEXT(Related_List_Page_Size))}';
                } catch (ex){}
                

                $scope.ViewCustomer.customersPageSortAttrsJSON = {
                    ChangesCount    :   0,
                    CurrentPage     :   1,
                    PageSize        :   10,
                    Sorting :   [{
                        FieldName       :   "Item",
                        SortDirection   :   "ASC"
                    }]
                };
                try{
                    $scope.ViewCustomer.customersPageSortAttrsJSON.PageSize = '{!JSENCODE(TEXT(Related_List_Page_Size))}';
                } catch (ex){}
                
                $scope.ViewCustomer.contactsPageSortAttrsJSON = {
                    ChangesCount    :   0,
                    CurrentPage     :   1,
                    PageSize        :   10,
                    Sorting :   [{
                        FieldName       :   "Item",
                        SortDirection   :   "ASC"
                    }]
                };
                try{
                    $scope.ViewCustomer.contactsPageSortAttrsJSON.PageSize = '{!JSENCODE(TEXT(Related_List_Page_Size))}';
                } catch (ex){}


                $scope.ViewCustomer.TaxExemptionPageSortAttrsJSON = {
                    ChangesCount    :   0,
                    CurrentPage     :   1,
                    PageSize        :   10,
                    Sorting :   [{
                        FieldName       :   "ItemDesc",
                        SortDirection   :   "ASC"
                    }]
                };
                try{
                    $scope.ViewCustomer.TaxExemptionPageSortAttrsJSON.PageSize = '{!JSENCODE(TEXT(Related_List_Page_Size))}';
                } catch (ex){}
            }
            
            //Change Address type on Map
            $scope.ViewCustomer.changeActiveAddress = function (address) {
                $scope.ViewCustomer.activeAddress = address;
                if (address == "BillingAddress") {
                    $scope.ViewCustomer.addressOnMap = $scope.ViewCustomer.CustomerInfo.CustomerInfo.BillingStreet2 + ' ' + $scope.ViewCustomer.CustomerInfo.CustomerInfo.BillingStreet1 + ' ' + $scope.ViewCustomer.CustomerInfo.CustomerInfo.BillingCity + ' ' + $scope.ViewCustomer.CustomerInfo.CustomerInfo.BillingState + ' ' + $scope.ViewCustomer.CustomerInfo.CustomerInfo.BillingCountry + ' ' + $scope.ViewCustomer.CustomerInfo.CustomerInfo.BillingPostalCode
                } else {
                    $scope.ViewCustomer.addressOnMap = $scope.ViewCustomer.CustomerInfo.CustomerInfo.ShippingStreet2 + ' ' + $scope.ViewCustomer.CustomerInfo.CustomerInfo.ShippingStreet1 + ' ' + $scope.ViewCustomer.CustomerInfo.CustomerInfo.ShippingCity + ' ' + $scope.ViewCustomer.CustomerInfo.CustomerInfo.ShippingState + ' ' + $scope.ViewCustomer.CustomerInfo.CustomerInfo.ShippingCountry + ' ' + $scope.ViewCustomer.CustomerInfo.CustomerInfo.ShippingPostalCode
                }
            }

            $scope.ViewCustomer.helpText = {
                Info : 'Basic information',
                Statistics : 'All statistics',
                Vital_Statistics : 'Vital statistics',
                Telemetry : 'Metrics and Measurement',
                Related : 'Related Records',
                COU : 'Customer Owned Units',
                Customers : 'List of other customers related to the Customer',
                Contacts : 'List of contacts related to the Customer'
            };

            $scope.ViewCustomer.infoLabel = {
                OtherEmail : 'Other Email',
                OtherPhone : 'Other Phone',
                MobileNumberSMS : 'SMS Other',
                HomeEmail : 'HOME EMAIL',
                HomeNumber : 'Home Number',
                HomeNumberSMS : 'SMS Home',
                WorkEmail : 'Work Email',
                WorkNumber : 'Work Number',
                WorkNumberSMS : 'SMS Work'
            };

            $scope.ViewCustomer.displaySections = {
                'Info' : true,
                'Statistics' : true,
                'Related' : true,
                'ActivityStream' : true
            };

            //Load Function On Init function
            // Load Customer Infomration
            $scope.ViewCustomer.loadCustomerInfo = function () {
                var customerId = $scope.ViewCustomer.customerId;
                $scope.ViewCustomer.setDefaultPageSortAttrs();

                CustomerInfoService.getCustomerInfo(customerId, $scope.ViewCustomer.COUPageSortAttrsJSON, $scope.ViewCustomer.ActiveOrdersPageSortAttrsJSON, $scope.ViewCustomer.customersPageSortAttrsJSON, $scope.ViewCustomer.contactsPageSortAttrsJSON).then(function (customerInfo) {
                    if (customerInfo != {}
                        && customerInfo.CustomerInfo != null) {
                        $scope.ViewCustomer.CustomerInfo = customerInfo;
                        debug('New');
                        debug($scope.ViewCustomer.CustomerInfo);
                        $scope.ViewCustomer.ShowContent = true;
                        $scope.setAllData(customerInfo); 
                        $scope.ViewCustomer.changeActiveAddress('BillingAddress');
                    } else {
                        $scope.ViewCustomer.showAllData = 0;
                    }
                }, function (errorSearchResult) {
                    $scope.ViewCustomer.CustomerInfo = errorSearchResult;
                    $scope.ViewCustomer.ShowContent = false;
                    $scope.ViewCustomer.showAllData = 0;
                });
            }

            //Save response
            $scope.ViewCustomer.saveCustomer = function (result) {

                if (result.Id.length == 18) {
                    result.Id = result.Id.substring(0, 15);
                }
                if ($scope.ViewCustomer.customerId.length == 18) {
                    $scope.ViewCustomer.customerId = $scope.ViewCustomer.customerId.substring(0, 15);
                }

                if ($scope.ViewCustomer.customerId == result.Id) {
                    var customerId = $scope.ViewCustomer.customerId;

                    CustomerInfoService.getCustomerInfo(customerId, $scope.ViewCustomer.COUPageSortAttrsJSON, $scope.ViewCustomer.ActiveOrdersPageSortAttrsJSON, $scope.ViewCustomer.customersPageSortAttrsJSON, $scope.ViewCustomer.contactsPageSortAttrsJSON).then(function (customerInfo) {
                        $scope.ViewCustomer.CustomerInfo = customerInfo;
                        $scope.ViewCustomer.changeActiveAddress('BillingAddress');
                    });
                } else {
                    $scope.ViewCustomer.addUpdateCustomerRecord(result.Id, "Family");
                }
            }

            // show and Hide content
            $scope.ViewCustomer.showMoreDetails = function (status) {
                $scope.ViewCustomer.ShowMore = status;
            }

            // Method to set all data models in local models
            $scope.setAllData = function (customerInfo) {
                $scope.ViewCustomer.User = {
                    Name : '{!JSENCODE($User.FirstName)}' + ' ' + '{!JSENCODE($User.LastName)}',
                    Value : ''
                }

                // Set Customer Owned Units data
                $scope.ViewCustomer.CMOwnedUnits = [];
                $scope.ViewCustomer.TotalCOURecords = customerInfo.TotalCOURecords;
                $scope.ViewCustomer.UpdateOwnedUnitsLists(customerInfo.CustomerOwnedUnitList);
                
                $scope.ViewCustomer.OriginAddress = customerInfo.CompanyName.Address;
                

                // Set Customer Active Orders data
                $scope.ViewCustomer.ActiveOrders = [];
                $scope.ViewCustomer.TotalActiveOrderRecords = customerInfo.TotalActiveSalesOrderRecords;
                $scope.ViewCustomer.UpdateActiveOrdersLists(customerInfo.ActiveSalesOrderList);
                
                // Set related Customers data
                $scope.ViewCustomer.CMCustomers = [];
                $scope.ViewCustomer.TotalCustomerRecords = customerInfo.TotalCustomerRecords;
                $scope.ViewCustomer.UpdateRelatedCustomersLists(customerInfo.RelatedCustomerList);

                // Set Cusotomer contacts data
                $scope.ViewCustomer.CMContacts = [];
                $scope.ViewCustomer.TotalContactRecords = customerInfo.TotalContactRecords;
                $scope.ViewCustomer.UpdateCustomerContactsLists(customerInfo.ContactList);
                
                // Set Tax Exemption data
                $scope.ViewCustomer.TaxExemptions = [];
                $scope.ViewCustomer.TotalTaxExemptionRecords = customerInfo.TotalTaxExemptionRecords;
                $scope.ViewCustomer.UpdateTaxExemptionsLists(customerInfo.TaxExemptionList);
            }

            $scope.ViewCustomer.setPrefferedEmail = function () {

                if (angular.isDefined($scope.ViewCustomer.CustomerInfo.CustomerInfo)) {
                    if ($scope.ViewCustomer.CustomerInfo.CustomerInfo.PreferredEmail != null && $scope.ViewCustomer.CustomerInfo.CustomerInfo.PreferredEmail != "") {
                        return $scope.ViewCustomer.CustomerInfo.CustomerInfo[$scope.ViewCustomer.CustomerInfo.CustomerInfo.PreferredEmail];
                    } else if ($scope.ViewCustomer.CustomerInfo.CustomerInfo.Type == "Individual" && ($scope.ViewCustomer.CustomerInfo.CustomerInfo.PreferredEmail == "" || $scope.ViewCustomer.CustomerInfo.CustomerInfo.PreferredEmail == null)) {
                        return ($scope.ViewCustomer.CustomerInfo.CustomerInfo.HomeEmail != null && $scope.ViewCustomer.CustomerInfo.CustomerInfo.HomeEmail !== "") ? $scope.ViewCustomer.CustomerInfo.CustomerInfo.HomeEmail : ($scope.ViewCustomer.CustomerInfo.CustomerInfo.OtherEmail != null) ? $scope.ViewCustomer.CustomerInfo.CustomerInfo.OtherEmail : ""
                    } else if ($scope.ViewCustomer.CustomerInfo.CustomerInfo.Type == "Business" && ($scope.ViewCustomer.CustomerInfo.CustomerInfo.PreferredEmail == "" || $scope.ViewCustomer.CustomerInfo.CustomerInfo.PreferredEmail != null)) {
                        return ($scope.ViewCustomer.CustomerInfo.CustomerInfo.WorkEmail != null && $scope.ViewCustomer.CustomerInfo.CustomerInfo.WorkEmail !== "") ? $scope.ViewCustomer.CustomerInfo.CustomerInfo.WorkEmail : ($scope.ViewCustomer.CustomerInfo.CustomerInfo.OtherEmail != null) ? $scope.ViewCustomer.CustomerInfo.CustomerInfo.OtherEmail : ""
                    }
                }
            }

            $scope.ViewCustomer.setPrefferedPhone = function () {
                if (angular.isDefined($scope.ViewCustomer.CustomerInfo.CustomerInfo)) {
                    if ($scope.ViewCustomer.CustomerInfo.CustomerInfo.PreferredPhone != null && $scope.ViewCustomer.CustomerInfo.CustomerInfo.PreferredPhone != "") {
                        $scope.ViewCustomer.CustomerInfo.CustomerInfo.PreferredPhoneLabel = $scope.ViewCustomer.CustomerInfo.CustomerInfo.PreferredPhone;
                        return $scope.ViewCustomer.CustomerInfo.CustomerInfo[$scope.ViewCustomer.CustomerInfo.CustomerInfo.PreferredPhone];
                    } else if ($scope.ViewCustomer.CustomerInfo.CustomerInfo.Type == "Individual" && ($scope.ViewCustomer.CustomerInfo.CustomerInfo.PreferredPhone == null || $scope.ViewCustomer.CustomerInfo.CustomerInfo.PreferredPhone == "")) {
                        $scope.ViewCustomer.CustomerInfo.CustomerInfo.PreferredPhoneLabel = ($scope.ViewCustomer.CustomerInfo.CustomerInfo.HomeNumber != null && $scope.ViewCustomer.CustomerInfo.CustomerInfo.HomeNumber != "") ? 'HomeNumber' : ($scope.ViewCustomer.CustomerInfo.CustomerInfo.OtherPhone != null) ? 'OtherPhone' : "HomeNumber";
                        return ($scope.ViewCustomer.CustomerInfo.CustomerInfo.HomeNumber != null && $scope.ViewCustomer.CustomerInfo.CustomerInfo.HomeNumber != "") ? $scope.ViewCustomer.CustomerInfo.CustomerInfo.HomeNumber : ($scope.ViewCustomer.CustomerInfo.CustomerInfo.OtherPhone != null) ? $scope.ViewCustomer.CustomerInfo.CustomerInfo.OtherPhone : ""
                    } else if ($scope.ViewCustomer.CustomerInfo.CustomerInfo.Type == "Business" && ($scope.ViewCustomer.CustomerInfo.CustomerInfo.PreferredPhone == null || $scope.ViewCustomer.CustomerInfo.CustomerInfo.PreferredPhone == "")) {
                        $scope.ViewCustomer.CustomerInfo.CustomerInfo.PreferredPhoneLabel = ($scope.ViewCustomer.CustomerInfo.CustomerInfo.WorkNumber != null && $scope.ViewCustomer.CustomerInfo.CustomerInfo.WorkNumber != "") ? 'WorkNumber' : ($scope.ViewCustomer.CustomerInfo.CustomerInfo.OtherPhone != null) ? 'OtherPhone' : "WorkNumber";
                        return ($scope.ViewCustomer.CustomerInfo.CustomerInfo.WorkNumber != null && $scope.ViewCustomer.CustomerInfo.CustomerInfo.WorkNumber != "") ? $scope.ViewCustomer.CustomerInfo.CustomerInfo.WorkNumber : ($scope.ViewCustomer.CustomerInfo.CustomerInfo.OtherPhone != null) ? $scope.ViewCustomer.CustomerInfo.CustomerInfo.OtherPhone : ""
                    }
                } else {
                    return '';

                }
            }

            $scope.ViewCustomer.setPrefferedSMS = function () {
                if (angular.isDefined($scope.ViewCustomer.CustomerInfo.CustomerInfo)) {

                    if ($scope.ViewCustomer.CustomerInfo.CustomerInfo.PreferredSMS != null && $scope.ViewCustomer.CustomerInfo.CustomerInfo.PreferredSMS != "") {
                        $scope.ViewCustomer.CustomerInfo.CustomerInfo.PreferredSMSLabel = $scope.ViewCustomer.CustomerInfo.CustomerInfo.PreferredSMS;
                        return $scope.ViewCustomer.CustomerInfo.CustomerInfo[$scope.ViewCustomer.CustomerInfo.CustomerInfo.PreferredSMS];
                    } else if ($scope.ViewCustomer.CustomerInfo.CustomerInfo.Type == "Individual" && ($scope.ViewCustomer.CustomerInfo.CustomerInfo.PreferredSMS == null || $scope.ViewCustomer.CustomerInfo.CustomerInfo.PreferredSMS == "")) {
                        $scope.ViewCustomer.CustomerInfo.CustomerInfo.PreferredSMSLabel = ($scope.ViewCustomer.CustomerInfo.CustomerInfo.HomeNumberSMS != false) ? 'HomeNumberSMS' : ($scope.ViewCustomer.CustomerInfo.CustomerInfo.MobileNumberSMS != false) ? "MobileNumberSMS" : "HomeNumberSMS";
                        return ($scope.ViewCustomer.CustomerInfo.CustomerInfo.HomeNumberSMS != false) ? $scope.ViewCustomer.CustomerInfo.CustomerInfo.HomeNumber : ($scope.ViewCustomer.CustomerInfo.CustomerInfo.MobileNumberSMS != false) ? $scope.ViewCustomer.CustomerInfo.CustomerInfo.OtherPhone : ""
                    } else if ($scope.ViewCustomer.CustomerInfo.CustomerInfo.Type == "Business" && ($scope.ViewCustomer.CustomerInfo.CustomerInfo.PreferredSMS == null || $scope.ViewCustomer.CustomerInfo.CustomerInfo.PreferredSMS == "")) {
                        $scope.ViewCustomer.CustomerInfo.CustomerInfo.PreferredSMSLabel = ($scope.ViewCustomer.CustomerInfo.CustomerInfo.WorkNumberSMS != false) ? 'WorkNumberSMS' : ($scope.ViewCustomer.CustomerInfo.CustomerInfo.MobileNumberSMS != false) ? "MobileNumberSMS" : "WorkNumberSMS";
                        return ($scope.ViewCustomer.CustomerInfo.CustomerInfo.WorkNumberSMS != false) ? $scope.ViewCustomer.CustomerInfo.CustomerInfo.WorkNumber : ($scope.ViewCustomer.CustomerInfo.CustomerInfo.MobileNumberSMS != false) ? $scope.ViewCustomer.CustomerInfo.CustomerInfo.OtherPhone : ""
                    }
                }
            }

            //subhrant Update

            // Method to update the Customer owned units related list records in JSON model
            $scope.ViewCustomer.UpdateOwnedUnitsLists = function (CustomerOwnedUnitList) {
                $scope.ViewCustomer.CMOwnedUnits = CustomerOwnedUnitList;
                $scope.ViewCustomer.CMOwnedUnits_editRow = [];

                for (i = 0; i < $scope.ViewCustomer.CMOwnedUnits.length; i++) {
                    $scope.ViewCustomer.CMOwnedUnits_editRow.push({
                        isEdit : false,
                        radioValue : 0,
                        optionSelected : 0
                    });
                }
            }
            
            // Method to update the Customer Actie Orders related list records in JSON model
            $scope.ViewCustomer.UpdateActiveOrdersLists = function (ActiveSalesOrderList) {
                debug($scope.ViewCustomer.ActiveOrders);
                $scope.ViewCustomer.ActiveOrders = ActiveSalesOrderList;
                $scope.ViewCustomer.ActiveOrders_editRow = [];

                for (i = 0; i < $scope.ViewCustomer.ActiveOrders.length; i++) {
                    $scope.ViewCustomer.ActiveOrders_editRow.push({
                        isEdit : false,
                        radioValue : 0,
                        optionSelected : 0
                    });
                }
            }
            
            // Method to update the related customers list records in JSON model
            $scope.ViewCustomer.UpdateRelatedCustomersLists = function (RelatedCustomersList) {
                $scope.ViewCustomer.CMCustomers = RelatedCustomersList;
                $scope.ViewCustomer.CMCustomers_editRow = [];

                for (i = 0; i < $scope.ViewCustomer.CMCustomers.length; i++) {
                    $scope.ViewCustomer.CMCustomers_editRow.push({
                        isEdit : false,
                        radioValue : 0,
                        optionSelected : 0
                    });
                }
            }

            // Method to update the customer contacts list records in JSON model
            $scope.ViewCustomer.UpdateCustomerContactsLists = function (ContactList) {
                $scope.ViewCustomer.CMContacts = ContactList;
                $scope.ViewCustomer.CMContacts_editRow = [];

                for (i = 0; i < $scope.ViewCustomer.CMContacts.length; i++) {
                    $scope.ViewCustomer.CMContacts_editRow.push({
                        isEdit : false,
                        radioValue : 0,
                        optionSelected : 0
                    });
                }
            }


            // Method to update the customer contacts list records in JSON model
            $scope.ViewCustomer.UpdateTaxExemptionsLists = function (TaxExemptionList) {
                $scope.ViewCustomer.TaxExemptions = TaxExemptionList;
                $scope.ViewCustomer.TaxExemptions_editRow = [];

                for (i = 0; i < $scope.ViewCustomer.TaxExemptions.length; i++) {
                    $scope.ViewCustomer.TaxExemptions_editRow.push({
                        isEdit : false,
                        radioValue : 0,
                        optionSelected : 0
                    });
                }
            }


            // Identify durty owned units and save to server the units
            $scope.ViewCustomer.closeEditCustomerOwnedUnitRows = function (event) {
                $scope.ViewCustomer.UpdateOwnedUnitsLists($scope.ViewCustomer.CMOwnedUnits);
            }
            
            // Identify durty Active Orders and save to server the units
            $scope.ViewCustomer.closeEditCustomerActiveOrderRows = function (event) {
                $scope.ViewCustomer.UpdateActiveOrdersLists($scope.ViewCustomer.ActiveOrders);
            }

            // Identify durty customer records and save to server
            $scope.ViewCustomer.closeEditCustomerRows = function (event) {
                $scope.ViewCustomer.UpdateRelatedCustomersLists($scope.ViewCustomer.CMCustomers);
            }

            // Identify durty contacts and save to server
            $scope.ViewCustomer.closeEditContactRows = function (event) {
                $scope.ViewCustomer.UpdateCustomerContactsLists($scope.ViewCustomer.CMContacts);
            }

            // Edit owned unit and save previous unit to server
            $scope.ViewCustomer.editOwnedUnit = function (event, index) {
                $scope.ViewCustomer.CMOwnedUnits_editRow[index].radioValue = 0;
                
                var isEditModeEnabled = false;
                var durtyCustomerOwnedUnits = [];
                for (i = 0; i < $scope.ViewCustomer.CMOwnedUnits_editRow.length; i++) {
                    if ($scope.ViewCustomer.CMOwnedUnits_editRow[i].isEdit == true) {
                        isEditModeEnabled = true;
                        durtyCustomerOwnedUnits.push(JSON.stringify($scope.ViewCustomer.CMOwnedUnits[i]));
                    }
                    $scope.ViewCustomer.CMOwnedUnits_editRow[i].isEdit = false;
                }

                if (!isEditModeEnabled) {
                    $scope.ViewCustomer.CMOwnedUnits_editRow[index].isEdit = true;
                    setTimeout(function () {
                        angular.element(event.target).closest('tr').next().find('input').filter(':first').focus();
                    }, 10);
                } else {
                    // Save customer owned units to server
                    //$scope.ViewCustomer.SaveCustomerOwnedUnitsToserver(durtyCustomerOwnedUnits);
                }
            }
            
            // Edit Active Order and save previous record to server
            $scope.ViewCustomer.editActiveOrder = function (event, index) {
                $scope.ViewCustomer.ActiveOrders_editRow[index].radioValue = 0;
                
                var isEditModeEnabled = false;
                var durtyCustomerActiveOrders = [];
                for (i = 0; i < $scope.ViewCustomer.ActiveOrders_editRow.length; i++) {
                    if ($scope.ViewCustomer.ActiveOrders_editRow[i].isEdit == true) {
                        isEditModeEnabled = true;
                        durtyCustomerActiveOrders.push(JSON.stringify($scope.ViewCustomer.ActiveOrders[i]));
                    }
                    $scope.ViewCustomer.ActiveOrders_editRow[i].isEdit = false;
                }

                if (!isEditModeEnabled) {
                    $scope.ViewCustomer.ActiveOrders_editRow[index].isEdit = true;
                    setTimeout(function () {
                        angular.element(event.target).closest('tr').next().find('input').filter(':first').focus();
                    }, 10);
                } else {
                    // Save customer owned units to server
                }
            }

            // Edit customer and save previous customer to server
            $scope.ViewCustomer.editRelatedCustomer = function (event, index) {
                $scope.ViewCustomer.CMCustomers_editRow[index].radioValue = 0;
                
                var isEditModeEnabled = false;
                var durtyCustomers = [];
                for (i = 0; i < $scope.ViewCustomer.CMCustomers_editRow.length; i++) {
                    if ($scope.ViewCustomer.CMCustomers_editRow[i].isEdit == true) {
                        isEditModeEnabled = true;
                        durtyCustomers.push(JSON.stringify($scope.ViewCustomer.CMCustomers[i]));
                    }
                    $scope.ViewCustomer.CMCustomers_editRow[i].isEdit = false;
                }

                if (!isEditModeEnabled) {
                    $scope.ViewCustomer.CMCustomers_editRow[index].isEdit = true;
                    setTimeout(function () {
                        angular.element(event.target).closest('tr').next().find('input').filter(':first').focus();
                    }, 10);
                } else {
                    // Save customer owned units to server
                    //$scope.ViewCustomer.addUpdateCustomerRecord = function (relatedCustomerId, relation);
                }
            }

            // Edit related Contact and save previous contact to server
            $scope.ViewCustomer.editRelatedContact = function (event, index) {
                $scope.ViewCustomer.CMContacts_editRow[index].radioValue = 0;
                
                var isEditModeEnabled = false;
                var durtyContacts = [];
                for (i = 0; i < $scope.ViewCustomer.CMContacts_editRow.length; i++) {
                    if ($scope.ViewCustomer.CMContacts_editRow[i].isEdit == true) {
                        isEditModeEnabled = true;
                        durtyContacts.push(JSON.stringify($scope.ViewCustomer.CMContacts[i]));
                    }
                    $scope.ViewCustomer.CMContacts_editRow[i].isEdit = false;
                }

                if (!isEditModeEnabled) {
                    $scope.ViewCustomer.CMContacts_editRow[index].isEdit = true;
                    setTimeout(function () {
                        angular.element(event.target).closest('tr').next().find('input').filter(':first').focus();
                    }, 10);
                } else {
                    // Save related contacts to server
                    //$scope.ViewCustomer.updateContactsToServer(durtyContacts);
                }

            }
            
            
            // Edit Tax Exemption
            $scope.ViewCustomer.editTaxExemptions = function (event, index) {
                $scope.ViewCustomer.TaxExemptions_editRow[index].radioValue = 0;
                
                var isEditModeEnabled = false;
                for (i = 0; i < $scope.ViewCustomer.TaxExemptions_editRow.length; i++) {
                    if ($scope.ViewCustomer.TaxExemptions_editRow[i].isEdit == true) {
                        isEditModeEnabled = true;
                    }
                    $scope.ViewCustomer.TaxExemptions_editRow[i].isEdit = false;
                }
                if (!isEditModeEnabled) {
                    $scope.ViewCustomer.TaxExemptions_editRow[index].isEdit = true;
                } 
            }

            // Save method for customer owned units
            $scope.ViewCustomer.SaveCustomerOwnedUnitsToserver = function (selectedCOURecords) {
                var customerId = $scope.ViewCustomer.customerId;

                // Update customer to database and refresh list
                // Method to add/update customers JSON array and refresh related customers list
                CustomerOwnedUnitsService.addCustomerOwnedUnit(customerId, selectedCOURecords, $scope.ViewCustomer.COUPageSortAttrsJSON).then(function (relatedCOUList) {
                    // Set all the data models
                    $scope.ViewCustomer.TotalCOURecords = relatedCOUList.TotalCOURecords;
                    $scope.ViewCustomer.UpdateOwnedUnitsLists(relatedCOUList.CustomerOwnedUnitList);
                    setTimeout(function () {
                        $scope.ViewCustomer.COUPageSortAttrsJSON.ChangesCount++;
                    }, 10);
                    
                    if (angular.element('#AddNewCOU') != null) {
                        angular.element('#AddNewCOU').modal('hide');
                    }
                    
                    Notification.success("Saved successfully");
                }, function (errorSearchResult) {
                    $scope.ViewCustomer.CustomerInfo = errorSearchResult;
                    Notification.error("Some error occurred, please refresh the page");
                });
            }

            // Method to perform Delete operation for Customer Owned Unit in database
            $scope.ViewCustomer.removeCustomerOwnedUnitRecord = function (customerOwnedUnitId) {
                // Calculate for new page number of grid
                var gridNewPN = $scope.ViewCustomer.COUPageSortAttrsJSON.CurrentPage;
                if($scope.ViewCustomer.TotalCOURecords % $scope.ViewCustomer.COUPageSortAttrsJSON.PageSize == 1){
                    $scope.ViewCustomer.COUPageSortAttrsJSON.CurrentPage = (gridNewPN > 1) ? (gridNewPN - 1) : 1;
                }
                
                CustomerOwnedUnitsService.removeCustomerOwnedUnit($scope.ViewCustomer.customerId, customerOwnedUnitId, $scope.ViewCustomer.COUPageSortAttrsJSON).then(function (relatedCOUList) {
                    $scope.ViewCustomer.TotalCOURecords = relatedCOUList.TotalCOURecords;
                    $scope.ViewCustomer.UpdateOwnedUnitsLists(relatedCOUList.CustomerOwnedUnitList);
                    
                    setTimeout(function () {
                        $scope.ViewCustomer.COUPageSortAttrsJSON.ChangesCount++;
                    }, 10);
                    
                    Notification.success("Record removed successfully");
                }, function (errorSearchResult) {
                    $scope.ViewCustomer.CustomerInfo = errorSearchResult;
                    Notification.error("Some error occurred, please refresh the page");
                });
            }

            // Method used to get and update all related customers list
            $scope.ViewCustomer.getAndUpdateRelatedCustomers = function () {
                var customerId = $scope.ViewCustomer.customerId;
                RelatedCustomersService.getRelatedCustomers(customerId, $scope.ViewCustomer.customersPageSortAttrsJSON).then(function (relatedCustomers) {
                    // Set all the data models
                    $scope.ViewCustomer.TotalCustomerRecords = relatedCustomers.TotalCustomerRecords;
                    $scope.ViewCustomer.UpdateRelatedCustomersLists(relatedCustomers.RelatedCustomerList);
                    
                    setTimeout(function () {
                        $scope.ViewCustomer.customersPageSortAttrsJSON.ChangesCount++;
                    }, 10);
                }, function (errorSearchResult) {
                    $scope.ViewCustomer.CustomerInfo = errorSearchResult;
                });
            }

            // Callback method when a customer is selected from search box to add a new customer in related customers section
            $scope.ViewCustomer.selectCallBack = function (selectedRecord) {
                // If selected value is a Customer, then add the record in related cutomers list
                if (selectedRecord.originalObject.Info == 'Customer') {
                    var parentCustomerId = $scope.ViewCustomer.customerId;
                    var selectedRecordId = selectedRecord.originalObject.Value;

                    if (selectedRecordId.length == 18) {
                        selectedRecordId = selectedRecordId.substring(0, 15);
                    }
                    if (parentCustomerId.length == 18) {
                        parentCustomerId = parentCustomerId.substring(0, 15);
                    }
                    if (parentCustomerId == selectedRecordId) {
                        Notification.error('Can\'t add parent customer as child in related list');
                        return;
                    }
                    $scope.ViewCustomer.addUpdateCustomerRecord(selectedRecord.originalObject.Value, 'Family');

                } else if (selectedRecord.originalObject.Info == 'Contact') {
                    // ToDo
                } else if (selectedRecord.originalObject.Info == 'CustomerOwnedUnit') {
                    // ToDo
                }
            }

            // Add/Update action method for Related customer update
            // Create a JSON array for updated customer and update
            $scope.ViewCustomer.addUpdateCustomerRecord = function (relatedCustomerId, relation) {
                var parentCustomerId = $scope.ViewCustomer.customerId;
                var selectedCustomerRecords = [{
                        Id : relatedCustomerId,
                        Relation : relation,
                        ParentCustomer : parentCustomerId
                    }
                ];
                
                if(selectedCustomerRecords.Relation == ""){
                    // Calculate for new page number of grid
                    var gridNewPN = $scope.ViewCustomer.customersPageSortAttrsJSON.CurrentPage;
                    if($scope.ViewCustomer.TotalCustomerRecords % $scope.ViewCustomer.customersPageSortAttrsJSON.PageSize == 1){
                        $scope.ViewCustomer.customersPageSortAttrsJSON.CurrentPage = (gridNewPN > 1) ? (gridNewPN - 1) : 1;
                    }
                }
                
                // Update customer to database and refresh list
                // Method to add/update customers JSON array and refresh related customers list
                RelatedCustomersService.addRelatedCustomer(selectedCustomerRecords, $scope.ViewCustomer.customersPageSortAttrsJSON).then(function (relatedCustomers) {
                    // Set all the data models
                    $scope.ViewCustomer.TotalCustomerRecords = relatedCustomers.TotalCustomerRecords;
                    $scope.ViewCustomer.UpdateRelatedCustomersLists(relatedCustomers.RelatedCustomerList);
                    
                    setTimeout(function () {
                        $scope.ViewCustomer.customersPageSortAttrsJSON.ChangesCount++;
                    }, 10);
                    
                    Notification.success("Saved successfully");
                }, function (errorSearchResult) {
                    $scope.ViewCustomer.CustomerInfo = errorSearchResult;
                    Notification.error("Some error occurred, please refresh the page");
                });
            }

            // Add/Update action method for Related contact update
            // Create a JSON array for updated contact and update
            $scope.ViewCustomer.addUpdateContactRecord = function (relatedContactId, relation) {
                var parentCustomerId = $scope.ViewCustomer.customerId;

                var selectedContactRecords = [{
                        Id : relatedContactId,
                        Relation : relation,
                        ParentCustomer : parentCustomerId
                    }
                ];

                // Method to add/update customers JSON array and refresh related customers list
                CustomerContactsService.updateRelation(selectedContactRecords, $scope.ViewCustomer.contactsPageSortAttrsJSON).then(function (relatedContacts) {
                    // Set all the data models
                    $scope.ViewCustomer.TotalContactRecords = relatedContacts.TotalContactRecords;
                    $scope.ViewCustomer.UpdateCustomerContactsLists(relatedContacts.ContactList);
                    
                    setTimeout(function () {
                        $scope.ViewCustomer.contactsPageSortAttrsJSON.ChangesCount++;
                    }, 10);
                    Notification.success("Saved successfully");
                }, function (errorSearchResult) {
                    $scope.ViewCustomer.CustomerInfo = errorSearchResult;
                    Notification.error("Some error occurred, please refresh the page");
                });
            }

            // Method to save a Related contacts list to server which calls a service method
            $scope.ViewCustomer.updateContactsToServer = function (selectedContactRecords) {
                // Update customer to database and refresh list
                // Method to add/update customers JSON array and refresh related customers list
                CustomerContactsService.addCustomerContact(selectedContactRecords, $scope.ViewCustomer.contactsPageSortAttrsJSON).then(function (relatedContacts) {
                    // Set all the data models
                    $scope.ViewCustomer.TotalContactRecords = relatedContacts.TotalContactRecords;
                    $scope.ViewCustomer.UpdateCustomerContactsLists(relatedContacts.ContactList);
                    
                    setTimeout(function () {
                        $scope.ViewCustomer.contactsPageSortAttrsJSON.ChangesCount++;
                    }, 10);
                    Notification.success("Saved successfully");
                }, function (errorSearchResult) {
                    $scope.ViewCustomer.CustomerInfo = errorSearchResult;
                    Notification.error("Some error occurred, please refresh the page");
                });
            }

            // Method to perform Delete operation in database
            $scope.ViewCustomer.removeCustomerContactRecord = function (customerContactId) {
                // Calculate for new page number of grid
                var gridNewPN = $scope.ViewCustomer.contactsPageSortAttrsJSON.CurrentPage;
                if($scope.ViewCustomer.TotalContactRecords % $scope.ViewCustomer.contactsPageSortAttrsJSON.PageSize == 1){
                    $scope.ViewCustomer.contactsPageSortAttrsJSON.CurrentPage = (gridNewPN > 1) ? (gridNewPN - 1) : 1;
                }
                
                CustomerContactsService.removeCustomerContact($scope.ViewCustomer.customerId, customerContactId, $scope.ViewCustomer.contactsPageSortAttrsJSON).then(function (relatedCustomerContactList) {
                    $scope.ViewCustomer.TotalContactRecords = relatedCustomerContactList.TotalContactRecords;
                    $scope.ViewCustomer.UpdateCustomerContactsLists(relatedCustomerContactList.ContactList);
                    
                    setTimeout(function () {
                        $scope.ViewCustomer.contactsPageSortAttrsJSON.ChangesCount++;
                    }, 10);
                    
                    Notification.success("Saved successfully");
                }, function (errorSearchResult) {
                    $scope.ViewCustomer.CustomerInfo = errorSearchResult;
                    Notification.error("Some error occurred, please refresh the page");
                });
            }

            // Add/Update action method for Related Customer Owned Unit update
            // Create a JSON array for updated COU and update
            $scope.ViewCustomer.addUpdateCOURecord = function (couId) {
                var selectedCOURecords = [{
                        Id : couId
                    }
                ];

                $scope.ViewCustomer.SaveCustomerOwnedUnitsToserver(angular.toJson(selectedCOURecords));
            }

            // Related Customer Owned Unit: selected action method after row edit
            $scope.ViewCustomer.CM_OwnedUnits_GoAction = function (indexVal) {
                // selected radio value == 1 Means Edit the record via EditCOU popup window
                if ($scope.ViewCustomer.CMOwnedUnits_editRow[indexVal].radioValue == 1) {
                    $scope.ViewCustomer.openEditCustomerOwnedUnitPopup($scope.ViewCustomer.CMOwnedUnits[indexVal].Id);
                } else if ($scope.ViewCustomer.CMOwnedUnits_editRow[indexVal].radioValue == 2) {
                    // ToDo
                } else if ($scope.ViewCustomer.CMOwnedUnits_editRow[indexVal].radioValue == 3) {
                    // ToDo
                } else if ($scope.ViewCustomer.CMOwnedUnits_editRow[indexVal].radioValue == 4) {
                    // selected radio value == 2 Means delete the record from the customer Owned Unit
                    $scope.ViewCustomer.removeCustomerOwnedUnitRecord($scope.ViewCustomer.CMOwnedUnits[indexVal].Id);
                }
            }
            
            // Related Customer Actiev Order: selected action method after row edit
            $scope.ViewCustomer.CM_ActiveOrders_GoAction = function (indexVal) {
                // selected radio value == 1
                if ($scope.ViewCustomer.ActiveOrders_editRow[indexVal].radioValue == 1) {
                    // ToDo
                }
            }

            // Related Customers: selected action method after row edit
            $scope.ViewCustomer.CM_Customers_GoAction = function (indexVal) {
                // selected radio value == 1 Means Edit the record via EditCustomer popup window
                if ($scope.ViewCustomer.CMCustomers_editRow[indexVal].radioValue == 1) {
                    $scope.ViewCustomer.editRelatedCustomerPopUp($scope.ViewCustomer.CMCustomers[indexVal].Id);
                } else if ($scope.ViewCustomer.CMCustomers_editRow[indexVal].radioValue == 2) {
                    // selected radio value == 2 Means delete the record from the customers list
                    $scope.ViewCustomer.addUpdateCustomerRecord($scope.ViewCustomer.CMCustomers[indexVal].Id, "");
                }
            }

            // Related Customer Contact: selected action method after row edit
            $scope.ViewCustomer.CM_Contacts_GoAction = function (indexVal) {
                // selected radio value == 1 Means Edit the record via EditContact popup window
                if ($scope.ViewCustomer.CMContacts_editRow[indexVal].radioValue == 1) {
                    $scope.ViewCustomer.openEditContactPopup($scope.ViewCustomer.CMContacts[indexVal].Id);
                } else if ($scope.ViewCustomer.CMContacts_editRow[indexVal].radioValue == 2) {
                    // selected radio value == 2 Means delete the record from the customer related list
                    $scope.ViewCustomer.removeCustomerContactRecord($scope.ViewCustomer.CMContacts[indexVal].Id);
                }
            }


            // Tax Exemption : selected action method after row edit
            $scope.ViewCustomer.TaxExemption_GoAction = function (indexVal) {
                if ($scope.ViewCustomer.TaxExemptions_editRow[indexVal].radioValue == 0) {
                    $scope.ViewCustomer.openTaxExemptionsPopup();
                }
            }
            
            
            $scope.ViewCustomer.openTaxExemptionsPopup = function(){
                console.log('TaxExemptionPopupEvent');
                $scope.$broadcast('TaxExemptionPopupEvent', $scope.ViewCustomer.CustomerInfo.CustomerInfo.Id);
            }
            
            $scope.$on('TaxExemptionCallback', function (event, args) {
                console.log('TaxExemptionCallback');
                $scope.ViewCustomer.TotalTaxExemptionRecords = args.TotalTaxExemptionRecords; 
                $scope.ViewCustomer.UpdateTaxExemptionsLists(args.TaxExemptionList);
            });
            
            $scope.ViewCustomer.openTaxExemptionsPopup = function(){
                console.log('TaxExemptionPopupEvent');
                $scope.$broadcast('TaxExemptionPopupEvent', $scope.ViewCustomer.CustomerInfo.CustomerInfo.Id);
            }   

            $scope.ViewCustomer.openAddCustomerOwnedUnitPopup = function (event) {
                event.stopPropagation();
                debug($scope.ViewCustomer.CustomerInfo.CustomerModal);
                // Broadcast an event for Add Customer Owned Unit popup to open and set data
                $scope.$broadcast('AddCustomerOwnedUnitEvent',{
                customerMasterData : $scope.ViewCustomer.CustomerInfo.CustomerInfo.CustomerMasterData
                });
            }


            // Method to open EDIT customer owned unit popup
            $scope.ViewCustomer.openEditCustomerOwnedUnitPopup = function (selectedCOUId) {
                // Broadcast an event for Add Customer Owned Unit popup to open and set data
                $scope.$broadcast('EditCustomerOwnedUnitEvent', {
                    couId : selectedCOUId
                });
            }

            // Method to perform callback actions when a Customer Owned Unit record is saved to database
            // Add COU record to customer related COU list and refresh the list
            $scope.ViewCustomer.callbackAfterCOUSave = function () {
                // Broadcast an event for Add Customer Owned Unit popup to open and set data
                $scope.$broadcast('AddCustomerOwnedUnitEvent');
            }
            //END: Customer Owned Unit popup methods:

            // START: Customer Contact popup methods:
            // Method to call an event for Contact popup
            $scope.ViewCustomer.openAddContactPopup = function () {
                $scope.$broadcast('AddContactEvent', {
                    parentCustomerId : $scope.ViewCustomer.customerId
                });
            }

            // Method to open EDIT customer contact popup
            $scope.ViewCustomer.openEditContactPopup = function (selectedContactId) {
                // Broadcast an event for Add Customer Owned Unit popup to open and set data
                $scope.$broadcast('EditContactEvent', {
                    contactId : selectedContactId,
                    parentCustomerId : $scope.ViewCustomer.customerId
                });
            }
            
            $scope.ViewCustomer.editRelatedCustomerPopUp = function (relatedCustomer) {
                $scope.$broadcast('EditCustomerRelatedEvent', relatedCustomer);
            }
            
            $scope.setFocusToSearchBox = function () {
                angular.element('#SearchToaddCutomer').focus();
            }

            $scope.ViewCustomer.activeSidepanelink = '#InfoSection';
            $scope.ViewCustomer.selectedItem = 'Info';

            angular.element(document).off("scroll");
            angular.element(document).on("scroll", function () {
                $scope.ViewCustomer.onScroll();
            });

            $scope.ViewCustomer.sidepanelLink = function (event, relatedContent) {
                event.preventDefault();
                $scope.ViewCustomer.displaySections[relatedContent] = true;
                angular.element(document).off("scroll");
                var target = angular.element(angular.element(event.target.closest('a'))).attr("href");
                angular.element('html, body').stop().animate({
                    scrollTop : angular.element(target).offset().top - 120
                }, 500, function () {
                    angular.element(document).on("scroll", function () {
                        $scope.ViewCustomer.onScroll();
                    });
                    $scope.ViewCustomer.onScroll();
                });
            }

            $scope.ViewCustomer.onScroll = function () {
                var activeSidepanelink;
                var selectedItem;
                var heading = '';
                debug('****'+angular.element('#InfoSection').position().top);
                var scrollPos = angular.element(document).scrollTop();
                if (scrollPos < angular.element('#InfoSection').position().top + angular.element('#InfoSection').height() + 50) {
                    activeSidepanelink = '#InfoSection';
                    selectedItem = 'Info';
                } else if (scrollPos < angular.element('#StatisticsSection').position().top + angular.element('#StatisticsSection').height() + 50) {
                    activeSidepanelink = '#StatisticsSection';
                    selectedItem = 'Statistics';
                } else if (scrollPos < angular.element('#RelatedSection').position().top + angular.element('#RelatedSection').height() + 50) {
                    activeSidepanelink = '#RelatedSection';
                    selectedItem = 'Related';
                } else if (scrollPos < angular.element('#ActivitySection').position().top + angular.element('#ActivitySection').height() + 50) {
                    activeSidepanelink = '#ActivitySection';
                    selectedItem = 'ActivityStream';
                } else {  
                    activeSidepanelink = '#ActivitySection';
                    selectedItem = 'ActivityStream';
                }
                
                $scope.ViewCustomer.activeSidepanelink = activeSidepanelink;
                if (!$scope.$$phase) {
                    $scope.$digest();
                }
            }
            
            $scope.ViewCustomer.dropDownItem = function (event, selectedSection) {
                var activeSection = $scope.ViewCustomer.activeSidepanelink.replace('#','');
                $scope.ViewCustomer.selectedItem = selectedSection;
                if(activeSection != selectedSection) {
                    $scope.ViewCustomer.sidepanelLink(event, selectedSection);
                }
            }

            $scope.ViewCustomer.editCustomerDetails = function () {
                var CustomerId = $scope.ViewCustomer.customerId;
                $scope.$broadcast('EditCustomerEvent', CustomerId);
            }
            
            
            $scope.ViewCustomer.NewCustomer = function () {
               $scope.$broadcast('AddCustomerEvent');
            }
            
            $scope.ViewCustomer.CustomerContacts_recordSaveCallback = function(relatedCustomerContactList){
                $scope.ViewCustomer.Contacts_paginationControlsAction();
            }
            
            $scope.ViewCustomer.COUs_paginationControlsAction = function () {
                var CustomerId = $scope.ViewCustomer.customerId;
                CustomerOwnedUnitsService.getCustomerOwnedUnits( CustomerId,
                                                                 $scope.ViewCustomer.COUPageSortAttrsJSON
                                                                )
                .then(function(resultInfo) {
                    $scope.ViewCustomer.CMOwnedUnits = [];
                    $scope.ViewCustomer.TotalCOURecords = resultInfo.TotalCOURecords;
                    $scope.ViewCustomer.UpdateOwnedUnitsLists(resultInfo.CustomerOwnedUnitList);
                    
                    setTimeout(function () {
                        $scope.ViewCustomer.COUPageSortAttrsJSON.ChangesCount++;
                    }, 10);
                }, function(errorSearchResult) {
                    Notification.error('Some error occurred, please try again.');
                });
            }
            
            $scope.ViewCustomer.ActiveOrders_paginationControlsAction = function () {
                var CustomerId = $scope.ViewCustomer.customerId;
                CustomerActiveOrdersService.getCustomerActiveOrders(CustomerId,
                                                                    $scope.ViewCustomer.ActiveOrdersPageSortAttrsJSON
                                                                    )

                .then(function(resultInfo) {
                    $scope.ViewCustomer.ActiveOrders = [];
                    $scope.ViewCustomer.TotalActiveOrderRecords = resultInfo.TotalActiveSalesOrderRecords;
                    $scope.ViewCustomer.UpdateActiveOrdersLists(resultInfo.ActiveSalesOrderList);
                    
                    setTimeout(function () {
                        $scope.ViewCustomer.ActiveOrdersPageSortAttrsJSON.ChangesCount++;
                    }, 10);
                }, function(errorSearchResult) {
                    Notification.error('Some error occurred, please try again.');
                });
            }
            
            $scope.ViewCustomer.Customers_paginationControlsAction = function () {
                var CustomerId = $scope.ViewCustomer.customerId;
                RelatedCustomersService.getRelatedCustomers( CustomerId,
                                                               $scope.ViewCustomer.customersPageSortAttrsJSON
                                                             )
                .then(function(resultInfo) {
                    $scope.ViewCustomer.CMCustomers = [];
                    $scope.ViewCustomer.TotalCustomerRecords = resultInfo.TotalCustomerRecords;
                    $scope.ViewCustomer.UpdateRelatedCustomersLists(resultInfo.RelatedCustomerList);
                    
                    setTimeout(function () {
                        $scope.ViewCustomer.customersPageSortAttrsJSON.ChangesCount++;
                    }, 10);
                }, function(errorSearchResult) {
                    Notification.error('Some error occurred, please try again.');
                });
            }
            
            $scope.ViewCustomer.Contacts_paginationControlsAction = function () {
                var CustomerId = $scope.ViewCustomer.customerId;
                CustomerContactsService.getCustomerContacts( CustomerId,
                                                               $scope.ViewCustomer.contactsPageSortAttrsJSON
                                                             )
                .then(function(resultInfo) {
                    $scope.ViewCustomer.CMContacts = [];
                    $scope.ViewCustomer.TotalContactRecords = resultInfo.TotalContactRecords;
                    $scope.ViewCustomer.UpdateCustomerContactsLists(resultInfo.ContactList);
                    
                    setTimeout(function () {
                        $scope.ViewCustomer.contactsPageSortAttrsJSON.ChangesCount++;
                    }, 10);
                    
                    setTimeout(function () {
                        if(!$scope.$$phase) {
                            $scope.$digest();
                        }
                    }, 10);
                }, function(errorSearchResult) {
                    Notification.error('Some error occurred, please try again.');
                });
            }

        });

        viewCus.service("CustomerInfoService", function ($q) {
            this.getCustomerInfo = function (customerId, COUPageSortAttrsJSON, ActiveOrdersPageSortAttrsJSON, customersPageSortAttrsJSON, contactsPageSortAttrsJSON) {
                customerId = encodeString(customerId);
                COUPageSortAttrsJSON = encodeString(angular.toJson(COUPageSortAttrsJSON));
                ActiveOrdersPageSortAttrsJSON = encodeString(angular.toJson(ActiveOrdersPageSortAttrsJSON));
                customersPageSortAttrsJSON = encodeString(angular.toJson(customersPageSortAttrsJSON));
                contactsPageSortAttrsJSON = encodeString(angular.toJson(contactsPageSortAttrsJSON));
                var deferred = $q.defer();
                Visualforce.remoting.Manager.invokeAction(
                    '{!$RemoteAction.NewViewCustomerCtrl.getCustomerInfo}',
                    customerId, COUPageSortAttrsJSON, ActiveOrdersPageSortAttrsJSON, customersPageSortAttrsJSON, contactsPageSortAttrsJSON,
                    function (result, event) {
                    if (event.type == 'exception') {
                        deferred.reject(event.message);

                    } else {
                        var customerInfo = decodeString(result);
                        var find = '\'';
                        var re = new RegExp(find, 'g');
                        customerInfo = customerInfo.replace(re, '');
                        deferred.resolve(JSON.parse(customerInfo));
                    }
                }, {
                    escape : true

                });
                return deferred.promise;
            }
        });

        // Service related to Customer Owned units list
        viewCus.service("CustomerOwnedUnitsService", function ($q) {
            // Get method for retrival of a customer owned unit with specified Id
            this.getCustomerOwnedUnitById = function (couId) {
                couId = encodeString(couId);
                var deferred = $q.defer();
                Visualforce.remoting.Manager.invokeAction(
                    '{!$RemoteAction.NewViewCustomerCtrl.getCOURecordById}',
                    couId,
                    function (result, event) {
                    if (event.type == 'exception') {
                        deferred.reject(event.message);

                    } else {
                        var customerOwnedUnit = decodeString(result);
                        var find = '\'';
                        var re = new RegExp(find, 'g');
                        customerOwnedUnit = customerOwnedUnit.replace(re, '');
                        deferred.resolve(JSON.parse(customerOwnedUnit));
                    }
                }, {
                    escape : true

                });
                return deferred.promise;
            }

            // Get method for retrival of all related customer owned units
            this.getCustomerOwnedUnits = function (customerId, COUPageSortAttrsJSON) {
                customerId = encodeString(customerId);
                COUPageSortAttrsJSON = encodeString(angular.toJson(COUPageSortAttrsJSON));
                var deferred = $q.defer();
                Visualforce.remoting.Manager.invokeAction(
                    '{!$RemoteAction.NewViewCustomerCtrl.getCOUListByCustomerId}',
                    customerId, COUPageSortAttrsJSON,
                    function (result, event) {
                    if (event.type == 'exception') {
                        deferred.reject(event.message);

                    } else {
                        var customerOwnedUnits = decodeString(result);
                        var find = '\'';
                        var re = new RegExp(find, 'g');
                        customerOwnedUnits = customerOwnedUnits.replace(re, '');
                        deferred.resolve(JSON.parse(customerOwnedUnits));
                    }
                }, {
                    escape : true

                });
                return deferred.promise;
            }

            // Add/Update method for a customer owned unit to add in related customer owned units list
            this.addCustomerOwnedUnit = function (customerId, customerOwnedUnitJSON, COUPageSortAttrsJSON) {
                customerId = encodeString(customerId);
                customerOwnedUnitJSON = encodeString(customerOwnedUnitJSON);
                COUPageSortAttrsJSON = encodeString(angular.toJson(COUPageSortAttrsJSON));
                var deferred = $q.defer();
                Visualforce.remoting.Manager.invokeAction(
                    '{!$RemoteAction.NewViewCustomerCtrl.saveCOU}',
                    customerId, customerOwnedUnitJSON, COUPageSortAttrsJSON,
                    function (result, event) {
                    if (event.type == 'exception') {
                        deferred.reject(event.message);

                    } else {
                        var customerOwnedUnits = decodeString(result);
                        var find = '\'';
                        var re = new RegExp(find, 'g');
                        customerOwnedUnits = customerOwnedUnits.replace(re, '');
                        deferred.resolve(JSON.parse(customerOwnedUnits));
                    }
                }, {
                    escape : true

                });
                return deferred.promise;
            }

            // Remove method for a customer owned unit
            this.removeCustomerOwnedUnit = function (customerId, customerOwnedUnitId, COUPageSortAttrsJSON) {
                customerId = encodeString(customerId);
                customerOwnedUnitId = encodeString(customerOwnedUnitId);
                COUPageSortAttrsJSON = encodeString(angular.toJson(COUPageSortAttrsJSON));
                var deferred = $q.defer();
                Visualforce.remoting.Manager.invokeAction(
                    '{!$RemoteAction.NewViewCustomerCtrl.removeCOURecord}',
                    customerId, customerOwnedUnitId, COUPageSortAttrsJSON,
                    function (result, event) {
                    if (event.type == 'exception') {
                        deferred.reject(event.message);

                    } else {
                        var customerOwnedUnits = decodeString(result);
                        var find = '\'';
                        var re = new RegExp(find, 'g');
                        customerOwnedUnits = customerOwnedUnits.replace(re, '');
                        deferred.resolve(JSON.parse(customerOwnedUnits));
                    }
                }, {
                    escape : true

                });
                return deferred.promise;
            }
        });
        
        // Service related to Customer Active Orders list
        viewCus.service("CustomerActiveOrdersService", function ($q) {
            // Get method for retrival of all related customer active orders
            this.getCustomerActiveOrders = function (customerId, ActiveOrdersPageSortAttrsJSON) {
                customerId = encodeString(customerId);
                ActiveOrdersPageSortAttrsJSON = encodeString(angular.toJson(ActiveOrdersPageSortAttrsJSON));
                var deferred = $q.defer();
                Visualforce.remoting.Manager.invokeAction(
                    '{!$RemoteAction.NewViewCustomerCtrl.getActiveOrdersListByCustomerId}',
                    customerId, ActiveOrdersPageSortAttrsJSON,
                    function (result, event) {
                    if (event.type == 'exception') {
                        deferred.reject(event.message);

                    } else {
                        var customerActiveOrders = decodeString(result);
                        var find = '\'';
                        var re = new RegExp(find, 'g');
                        customerActiveOrders = customerActiveOrders.replace(re, '');
                        deferred.resolve(JSON.parse(customerActiveOrders));
                    }
                }, {
                    escape : true

                });
                return deferred.promise;
            }
        });

        // Service related to Customer related customers
        viewCus.service("RelatedCustomersService", function ($q) {

            // Get method for retrival of all related customers for customer Id
            this.getRelatedCustomers = function (customerId, customersPageSortAttrsJSON) {
                customerId = encodeString(customerId);
                customersPageSortAttrsJSON = encodeString(angular.toJson(customersPageSortAttrsJSON));
                var deferred = $q.defer();
                Visualforce.remoting.Manager.invokeAction(
                    '{!$RemoteAction.NewViewCustomerCtrl.getRelatedCustomerByCustomerId}',
                    customerId, customersPageSortAttrsJSON,
                    function (result, event) {
                    if (event.type == 'exception') {
                        deferred.reject(event.message);

                    } else {
                        var relatedCustomers = decodeString(result);
                        var find = '\'';
                        var re = new RegExp(find, 'g');
                        relatedCustomers = relatedCustomers.replace(re, '');
                        deferred.resolve(JSON.parse(relatedCustomers));
                    }
                }, {
                    escape : true

                });
                return deferred.promise;
            }

            // Add/Update method for a customer to add in related customers list
            this.addRelatedCustomer = function (customerJSON, customersPageSortAttrsJSON) {
                customerJSON = encodeString(angular.toJson(customerJSON));
                customersPageSortAttrsJSON = encodeString(angular.toJson(customersPageSortAttrsJSON));
                var deferred = $q.defer();
                Visualforce.remoting.Manager.invokeAction(
                    '{!$RemoteAction.NewViewCustomerCtrl.updateRelatedCustomer}',
                    customerJSON, customersPageSortAttrsJSON,
                    function (result, event) {
                    if (event.type == 'exception') {
                        deferred.reject(event.message);

                    } else {
                        var relatedCustomers = decodeString(result);
                        var find = '\'';
                        var re = new RegExp(find, 'g');
                        relatedCustomers = relatedCustomers.replace(re, '');
                        deferred.resolve(JSON.parse(relatedCustomers));
                    }
                }, {
                    escape : true

                });
                return deferred.promise;
            }
        });

        // Service related to Customer Contacts list
        viewCus.service("CustomerContactsService", function ($q) {
            // Get method for retrival of all related customer contacts
            this.getCustomerContacts = function (customerId, contactsPageSortAttrsJSON) {
                customerId = encodeString(customerId);
                contactsPageSortAttrsJSON = encodeString(angular.toJson(contactsPageSortAttrsJSON));
                var deferred = $q.defer();
                Visualforce.remoting.Manager.invokeAction(
                    '{!$RemoteAction.NewViewCustomerCtrl.getCustomerContactByCustomerId}',
                    customerId, contactsPageSortAttrsJSON,
                    function (result, event) {
                    if (event.type == 'exception') {
                        deferred.reject(event.message);

                    } else {
                        var customerContacts = decodeString(result);
                        var find = '\'';
                        var re = new RegExp(find, 'g');
                        customerContacts = customerContacts.replace(re, '');
                        deferred.resolve(JSON.parse(customerContacts));
                    }
                }, {
                    escape : true

                });
                return deferred.promise;
            }

            // Add/Update method for a customer contact to add in related customer contacts list
            this.addCustomerContact = function (customerCotnactJSON, contactsPageSortAttrsJSON) {
                customerCotnactJSON = encodeString(angular.toJson(customerCotnactJSON));
                contactsPageSortAttrsJSON = encodeString(angular.toJson(contactsPageSortAttrsJSON));
                var deferred = $q.defer();
                Visualforce.remoting.Manager.invokeAction(
                    '{!$RemoteAction.NewViewCustomerCtrl.updateCustomerContact}',
                    customerCotnactJSON, contactsPageSortAttrsJSON,
                    function (result, event) {
                    if (event.type == 'exception') {
                        deferred.reject(event.message);

                    } else {
                        var customerContacts = decodeString(result);
                        var find = '\'';
                        var re = new RegExp(find, 'g');
                        customerContacts = customerContacts.replace(re, '');
                        deferred.resolve(JSON.parse(customerContacts));
                    }
                }, {
                    escape : true

                });
                return deferred.promise;
            }

            // Add/Update method for a customer contact to add in related customer contacts list
            this.updateRelation = function (customerCotnactJSON, contactsPageSortAttrsJSON) {
                customerCotnactJSON = encodeString(angular.toJson(customerCotnactJSON));
                contactsPageSortAttrsJSON = encodeString(angular.toJson(contactsPageSortAttrsJSON));
                var deferred = $q.defer();
                Visualforce.remoting.Manager.invokeAction(
                    '{!$RemoteAction.NewViewCustomerCtrl.updateCustomerContactRelation}',
                    customerCotnactJSON, contactsPageSortAttrsJSON,
                    function (result, event) {
                    if (event.type == 'exception') {
                        deferred.reject(event.message);

                    } else {
                        var customerContacts = decodeString(result);
                        var find = '\'';
                        var re = new RegExp(find, 'g');
                        customerContacts = customerContacts.replace(re, '');
                        deferred.resolve(JSON.parse(customerContacts));
                    }
                }, {
                    escape : true

                });
                return deferred.promise;
            }

            // Remove method of Customer Contact Record
            this.removeCustomerContact = function (customerId, customerContactId, contactsPageSortAttrsJSON) {
                customerId = encodeString(customerId);
                customerContactId = encodeString(customerContactId);
                contactsPageSortAttrsJSON = encodeString(angular.toJson(contactsPageSortAttrsJSON));
                var deferred = $q.defer();
                Visualforce.remoting.Manager.invokeAction(
                    '{!$RemoteAction.NewViewCustomerCtrl.removeCustomerContactRecord}',
                    customerId, customerContactId, contactsPageSortAttrsJSON,
                    function (result, event) {
                    if (event.type == 'exception') {
                        deferred.reject(event.message);

                    } else {
                        var customerContactRec = decodeString(result);
                        var find = '\'';
                        var re = new RegExp(find, 'g');
                        customerContactRec = customerContactRec.replace(re, '');
                        deferred.resolve(JSON.parse(customerContactRec));
                    }
                }, {
                    escape : true

                });
                return deferred.promise;
            }
        });
    </script>
    </head>
    
        <body  ng-controller="ViewCustomer" ng-init="ViewCustomer.loadCustomerInfo()" ng-cloak="ng-cloak">
        <c:BPGlobalHeader />
        <div class="content">
        <div class="col-lg-2 col-md-2 sidePanel ">
            <div class="sidepaneluserinfo row">
                <!-- <div class="userimg">
                    <div style="float:left;background-color: #373c40; border-radius: 5px; padding: 1px; margin-right: 5px;">
                            <img  src="{!URLFOR($Resource.Images, 'star.png')}" style="height:35px; width:35px; padding: 5px;"/>
                    </div>
                </div> -->
                <div class="userNameblock userNameblock_ML5">
                    <p class="T3"> 
                    <span ng-show="ViewCustomer.CustomerInfo.CustomerInfo.Type == 'Individual'"> {{ViewCustomer.CustomerInfo.CustomerInfo.FirstName}} {{ViewCustomer.CustomerInfo.CustomerInfo.LastName}}</span>
                    <span ng-show="ViewCustomer.CustomerInfo.CustomerInfo.Type != 'Individual'"> {{ViewCustomer.CustomerInfo.CustomerInfo.BusinessName}} </span>
                    </p>
                    <p class="customerNumber">{{ViewCustomer.CustomerInfo.CustomerInfo.CustomerNumber}}</p>
                </div>
            </div>
            <div class="clearfix"></div>
            <div class="row statusRow">
                <span class="userType T3" ng-show="ViewCustomer.CustomerInfo.CustomerInfo.Type == 'Individual'">Individual</span>
                <span class="userType T3" ng-show="ViewCustomer.CustomerInfo.CustomerInfo.Type != 'Individual'">Business</span> <span class="divider">|</span>
                <span class="userStatus" ng-show="ViewCustomer.CustomerInfo.CustomerInfo.Active== true" >Active</span>
                <span class="userStatus" style="color:#E80000" ng-show="ViewCustomer.CustomerInfo.CustomerInfo.Active == false" >Deactive</span>
            </div>
            
            
            <div class="leftPanelLinks">
                <a class="row T10 mainSectionLink" ng-class="{'active' : ViewCustomer.activeSidepanelink =='#InfoSection'}" 
                    href="#InfoSection" ng-click="ViewCustomer.sidepanelLink($event, 'Info')" ><span class="alphabetLetter">A</span>Info</a>
                    
                <a class="row T10 mainSectionLink" ng-class="{'active' : ViewCustomer.activeSidepanelink =='#StatisticsSection'}" 
                    href="#StatisticsSection" ng-click="ViewCustomer.sidepanelLink($event, 'Statistics')" ><span class="alphabetLetter">B</span>Statistics</a>                    
                <a class="row T10 subSectionLink" href="#StatisticsSection" ng-click="ViewCustomer.sidepanelLink($event, 'Statistics')">
                    <span class="alphabetLetter"></span>Vital Statistics</a>
               <!--  <a class="row T10 subSectionLink" href="#TelemetryStatistics" ng-click="ViewCustomer.sidepanelLink($event, 'Statistics')">
                    <span class="alphabetLetter"></span>Telemetry</a> -->
                 
                <a class="row T10 mainSectionLink" ng-class="{'active' : ViewCustomer.activeSidepanelink =='#RelatedSection'}" 
                    href="#RelatedSection" ng-click="ViewCustomer.sidepanelLink($event, 'Related')" ><span class="alphabetLetter">C</span>Related</a>
<!--                 <a class="subSectionLink row T10" href="#RelatedSection" ng-click="ViewCustomer.sidepanelLink($event)"> -->
<!--                     <span class="alphabetLetter"></span>Active Orders</a> -->
                <a class="row T10 subSectionLink" href="#RelatedSection_Cou_Block" ng-click="ViewCustomer.sidepanelLink($event, 'Related')">
                    <span class="alphabetLetter"></span>Customer Owned Units</a>
                <a class="row T10 subSectionLink" href="#RelatedSection_ActiveOrders_Block" ng-click="ViewCustomer.sidepanelLink($event, 'Related')">
                    <span class="alphabetLetter"></span>Active Orders</a>
                <a class="row T10 subSectionLink" href="#RelatedSection_Customer_BLock" ng-click="ViewCustomer.sidepanelLink($event, 'Related')">
                    <span class="alphabetLetter"></span>Customers</a>
                <a class="row T10 subSectionLink" href="#RelatedSection_Contact_BLock" ng-click="ViewCustomer.sidepanelLink($event, 'Related')" 
                	ng-if="ViewCustomer.CustomerInfo.CustomerInfo.Type != 'Individual'">
                    <span class="alphabetLetter"></span>Contacts</a>
                <a class="row T10 subSectionLink" href="#RelatedSection_Tax_Exemption_BLock" ng-click="ViewCustomer.sidepanelLink($event, 'Related')">
                    <span class="alphabetLetter"></span>Tax Exemptions</a>
                 



                <!-- <a class="row T10 mainSectionLink" ng-class="{'active' : ViewCustomer.activeSidepanelink =='#ActivitySection'}" 
                    href="#ActivitySection" ng-click="ViewCustomer.sidepanelLink($event, 'ActivityStream')" ><span class="alphabetLetter">D</span>Activity Stream</a> -->
            </div>
            
        </div>
        <div class="col-lg-10 col-md-10 mainSection" style="margin-top: 98px;">
            <div class=" sectionHeader row fixedRow" >
                <div class="col-lg-4 col-md-4" ng-show="ViewCustomer.activeSidepanelink =='#InfoSection'">
                    <div class="fixedHeaderText">
                        <span class="headerlabel">
                        <i class="fa fa-angle-right" style="width:10px; padding: 0 3px;"
                            ng-show="!ViewCustomer.displaySections.Info"
                            ng-Click="ViewCustomer.displaySections.Info = true">
                        </i> 
                        <i class="fa fa-angle-down" style="width:10px;"
                            ng-show="ViewCustomer.displaySections.Info"
                            ng-Click="ViewCustomer.displaySections.Info = false">
                        </i> 
                        <span class="divider">|</span>
                        <span class="T2">A INFO</span>
                        </span>
                        <span class="ActionIcons pull-right">
                        <!-- <i class="fa fa-th"></i> -->
                        <i class="fa fa-question-circle" data-toggle="tooltip" title="{{ViewCustomer.helpText['Info']}}"></i>

                        </span> 
                    </div>
                </div>
                <div class="col-lg-4 col-md-4" ng-show="ViewCustomer.activeSidepanelink =='#StatisticsSection'">
                    <div class="fixedHeaderText">
                        <span class="headerlabel">
                        <i class="fa fa-angle-right" style="width:10px; padding: 0 3px;"
                            ng-show="!ViewCustomer.displaySections.Statistics"
                            ng-Click="ViewCustomer.displaySections.Statistics = true">
                        </i> 
                        <i class="fa fa-angle-down" style="width:10px;"
                            ng-show="ViewCustomer.displaySections.Statistics"
                            ng-Click="ViewCustomer.displaySections.Statistics = false">
                        </i> 
                        <span class="divider">|</span>
                        <span class="T2">B Statistics</span>
                        </span>
                        <span class="ActionIcons pull-right">
                        <!-- <i class="fa fa-th"></i> -->
                        <i class="fa fa-question-circle" data-toggle="tooltip" title="{{ViewCustomer.helpText['Statistics']}}"></i>

                        </span> 
                    </div>
                </div>
                <div class="col-lg-4 col-md-4" ng-show="ViewCustomer.activeSidepanelink =='#RelatedSection'">
                    <div class="fixedHeaderText">
                        <span class="headerlabel">
                        <i class="fa fa-angle-right" style="width:10px; padding: 0 3px;"
                            ng-show="!ViewCustomer.displaySections.Related"
                            ng-Click="ViewCustomer.displaySections.Related = true">
                        </i> 
                        <i class="fa fa-angle-down" style="width:10px;"
                            ng-show="ViewCustomer.displaySections.Related"
                            ng-Click="ViewCustomer.displaySections.Related = false">
                        </i> 
                        <span class="divider">|</span>
                        <span class="T2">C Related</span>
                        </span>
                        <span class="ActionIcons pull-right">
                        <!-- <i class="fa fa-th"></i> -->
                        <i class="fa fa-question-circle" data-toggle="tooltip" title="{{ViewCustomer.helpText['Related']}}"></i>

                        </span> 
                    </div>
                </div>
                <!-- <div class="col-lg-4 col-md-4" ng-show="ViewCustomer.activeSidepanelink =='#ActivitySection'">
                    <div class="fixedHeaderText">
                        <span class="headerlabel">
                        <i class="fa fa-angle-right" style="width:10px; padding: 0 3px;"
                            ng-show="!ViewCustomer.displaySections.ActivityStream"
                            ng-Click="ViewCustomer.displaySections.ActivityStream = true">
                        </i> 
                        <i class="fa fa-angle-down" style="width:10px;"
                            ng-show="ViewCustomer.displaySections.ActivityStream"
                            ng-Click="ViewCustomer.displaySections.ActivityStream = false">
                        </i> 
                        <span class="divider">|</span>
                        <span class="T2">D Activity Stream</span>
                        </span>
                        <span class="ActionIcons pull-right">
                        <i class="fa fa-th"></i>
                        <i class="fa fa-question-circle"></i>
                        </span> 
                    </div>
                </div> -->

            
                <div class="col-lg-8 col-md-8 fixedContent">
                    <button type="button" class="flatBtn" ng-click="ViewCustomer.editCustomerDetails()">EDIT</button>
                    <!-- <div class="fa-icons">
                        <i class="fa fa-floppy-o"></i>
                        <i class="fa fa-cog"></i>
                    </div> -->
                    <!-- <a href="#" class="newLink" ng-click="ViewCustomer.NewCustomer()">NEW</a> -->
                    <div class="col-lg-8 col-md-7 searchToAdd searchToAdd_ML110">
                        <div class="input-group">
                            <div class="input-group-btn">
                                <button type="button" class="btn C5 LabelBtn">
                                <span class="T5" style="color: #939CA9;">TO:</span>
                                <span style="color: #FFFFFF;">{{ViewCustomer.selectedItem}}</span>

                                </button>
                                <button type="button" class="btn C5 dropdown-toggle caretBtn" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <span class="caret"></span>
                                <span class="sr-only">Toggle Dropdown</span>
                                </button>
                                <ul class="dropdown-menu">
                                    <li><a href="#InfoSection" ng-click="ViewCustomer.dropDownItem($event, 'Info')">{!$Label.Page_Section_Info}</a></li>
                                    <li><a href="#StatisticsSection" ng-click="ViewCustomer.dropDownItem($event, 'Statistics')">{!$Label.Page_Section_Statistics}</a></li>
                                    <li><a href="#RelatedSection" ng-click="ViewCustomer.dropDownItem($event, 'Related')">{!$Label.Page_Section_Related}</a></li>
                                    <li><a href="#ActivitySection" ng-click="ViewCustomer.dropDownItem($event, 'ActivityStream')">{!$Label.Page_Section_ActivityStream}</a></li>





                                    <li role="separator" class="divider"></li>
                                    <li class="text-uppercase"><a href="#">{!$Label.Label_Advanced} {!$Label.Label_Search}</a></li>
                                           

                                </ul>
                            </div>
                            <!-- /btn-group -->
                            <div class="inner-addon right-addon" ng-class="{'disabledSearchToAddElement' : (ViewCustomer.CustomerInfo.CustomerInfo.Id == '' || ViewCustomer.CustomerInfo.CustomerInfo.Id == null)}">

                                <i class="fa fa-search fa-flip-horizontal"></i>
                                <c:SearchToAdd />
                                <!-- <input class="header-search form-control"  placeholder="search to Add Related" type="text" /> -->
                            </div>
                        </div>
                        <!-- /input-group -->
                    </div>
                </div>
            </div>
            <div id="InfoSection" >
                <div class="main_section row" ng-show="ViewCustomer.displaySections.Info">
                    <p class="actionRow T2">
                        <span class="sectionText">General</span>
                        <!-- <span class="actionText">Actions</span> -->
                        <span class="ActionIcons">
                        <!-- <i class="fa fa-th"></i> -->
                        <i class="fa fa-question-circle" data-toggle="tooltip" title="General Information"></i>

                        </span> 
                    </p>
                    <div class="row rowGeneral" >
                        <div class="col-md-4 col-lg-4 subsectionGeneral_rightonly">
                            <div  class="row">
                                <div class="col-md-5 col-lg-5 " >
                                    <div  class="row ">
                                        <div class="col-md-12 col-lg-12  Profile_pic">
                                            <img src="{!URLFOR($Resource.Images, 'profile_default.jpg')}" style="height:120px;width:100%"/>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-7 col-lg-7" >
                                    <div class="row">
                                        <div class="col-md-12 col-lg-12">
                                            <div class="T1">
                                                <span ng-if="ViewCustomer.CustomerInfo.CustomerInfo.Type == 'Individual'"> {{ViewCustomer.CustomerInfo.CustomerInfo.FirstName}} {{ViewCustomer.CustomerInfo.CustomerInfo.LastName}}</span>
                                                <span ng-if="ViewCustomer.CustomerInfo.CustomerInfo.Type != 'Individual'"> {{ViewCustomer.CustomerInfo.CustomerInfo.BusinessName}} </span>
                                            </div>
                                            <div class="T7">
                                                <span ng-if="ViewCustomer.CustomerInfo.CustomerInfo.Type == 'Individual' && ViewCustomer.CustomerInfo.CustomerInfo.Nickname != ''">
                                                "{{ViewCustomer.CustomerInfo.CustomerInfo.Nickname}}"
                                                </span>
                                            </div>
                                            <!-- <div class="row">
                                                <div class="col-md-12 col-lg-12" >
                                                    <div style="float:left;background-color: #373c40; border-radius: 5px; padding: 1px; margin-right: 5px;">
                                                            <img  src="{!URLFOR($Resource.Images, 'star.png')}" style="height:35px; width:35px; padding: 5px;"/>
                                                    </div>
                                                    <div style="margin-left:20px;padding-top:10px ;padding-left:24px" class="T7">
                                                        Gamification
                                                    </div>
                                                </div>
                                            </div> -->
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row" >
                                <div class="col-md-5 col-lg-5 " >
                                    <div  class="row ">
                                        <div class="col-md-12 col-lg-12 Active_Button_row ">
                                            <button class="form-control C10 T4 Active_Button round_btn" ng-if="ViewCustomer.CustomerInfo.CustomerInfo.Active== true">ACTIVE</button> 
                                            <button class="form-control C9 T4 Active_Button round_btn" ng-if="ViewCustomer.CustomerInfo.CustomerInfo.Active ==false" >DEACTIVE</button>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-7 col-lg-7 " >
                                    <div  class="social_icon_row">
                                        <span>
	                                        <a href="{{ViewCustomer.CustomerInfo.CustomerInfo.TwitterLink}}" target="_blank" ng-if="ViewCustomer.CustomerInfo.CustomerInfo.TwitterLink != ''">
	                                        	<i class="fa fa-twitter-square icon_tweet"></i>
	                                        </a>
	                                        <!-- <a href="#" target="_blank" ng-if="ViewCustomer.CustomerInfo.CustomerInfo.TwitterLink == ''">
	                                        	<i class="fa fa-twitter-square icon_tweet"></i>
	                                        </a> -->
                                        </span>
                                        <span>
	                                        <a href="{{ViewCustomer.CustomerInfo.CustomerInfo.FacebookLink}}" target="_blank" ng-if="ViewCustomer.CustomerInfo.CustomerInfo.FacebookLink != ''">
	                                        	<i class="fa fa-facebook-square icon_fb"></i>  
	                                        </a>
	                                       <!--  <a href="#" target="_blank" ng-if="ViewCustomer.CustomerInfo.CustomerInfo.FacebookLink == ''">
	                                        	<i class="fa fa-facebook-square icon_fb"></i>  
	                                        </a> -->
                                        </span>
                                        <span>
	                                        <a href="{{ViewCustomer.CustomerInfo.CustomerInfo.LinkedInLink}}" target="_blank" ng-if="ViewCustomer.CustomerInfo.CustomerInfo.LinkedInLink != ''">
	                                        	<i class="fa fa-linkedin-square icon_in"></i>  
	                                        </a>
	                                        <!-- <a href="#" target="_blank" ng-if="ViewCustomer.CustomerInfo.CustomerInfo.LinkedInLink == ''">
	                                        	<i class="fa fa-linkedin-square icon_in"></i>  
	                                        </a> -->
                                        </span>
                                    </div>
                                </div>
                            </div>
                            <div class="general_info_customer">
                               <div class="row" ng-if="(ViewCustomer.setPrefferedEmail() != '')"><!-- condition added by pooja -->
                                    <div class="col-lg-4 col-md-4  customer_general_column">
                                        <span style="padding-top:10px;">    
                                        <i class="fa fa-star orange favorite" ></i><label class="T7 label_favorite" for="labelFirstName">Send Email  </label>
                                        </span>
                                    </div>
                                    <div  class="col-lg-8 col-md-8 " >
                                        <span class="blue T3_1 emailBreak"  ng-bind="ViewCustomer.setPrefferedEmail()"> </span>
                                    </div>
                                </div> 
                                <div class="row" ng-if="(ViewCustomer.setPrefferedPhone() != '')"><!-- condition added by pooja -->
                                    <div class="col-lg-4 col-md-4 customer_general_column"> 
                                        <span style="padding-top:10px;">    
                                        <i class="fa fa-star orange favorite" ></i><label class="T7 label_favorite" for="labelFirstName">Call Mobile</label>
                                        </span>
                                    </div>
                                    <div  class="col-lg-8 col-md-8" >
                                        <span class=" T3"  ng-bind="ViewCustomer.setPrefferedPhone()"> </span>
                                    </div>
                                </div>
                                <div class="row" ng-if="(ViewCustomer.setPrefferedSMS() != '')"><!-- condition added by pooja -->
                                    <div class="col-lg-4 col-md-4 customer_general_column">
                                        <span style="padding-top:10px;">    
                                        <i class="fa fa-star orange favorite" ></i><label class="T7 label_favorite" for="labelFirstName">SMS Mobile</label>
                                        </span>
                                    </div>
                                    <div  class="col-lg-8 col-md-8" >
                                        <span class="blue T3"  ng-bind="ViewCustomer.setPrefferedSMS();"> </span>
                                    </div>
                                </div>
                                <div class="row" ng-if="ViewCustomer.CustomerInfo.CustomerInfo.Fax != undefined || ViewCustomer.CustomerInfo.CustomerInfo.Fax != null">
                                    <div class="col-lg-4 col-md-4 customer_general_column">
                                        <span style="padding-top:10px;">
                                            <div class="non_favorite"><label class="T7 label_favorite" for="labelFirstName">Send Fax  </label></div>
                                        </span>
                                    </div>
                                    <div  class="col-lg-8 col-md-8" >
                                        <span class="blue T3"  >{{ViewCustomer.CustomerInfo.CustomerInfo.Fax}} </span>
                                    </div>
                                </div>
                                <div class="MoreSectionContent animate-showContent"  ng-show="ViewCustomer.ShowMore==false">
                                    <div class="row " ng-show="ViewCustomer.CustomerInfo.CustomerInfo.PreferredEmail != 'HomeEmail' && ViewCustomer.CustomerInfo.CustomerInfo.Type == 'Individual'  &&  ViewCustomer.CustomerInfo.CustomerInfo.PreferredEmail != '' 
                                        && ViewCustomer.CustomerInfo.CustomerInfo.HomeEmail != ''">
                                        <div class="col-lg-4 col-md-4 customer_general_column">
                                            <span style="padding-top:10px;">
                                                <div class="non_favorite"><label class="T7 label_favorite" for="labelFirstName">Home Email  </label></div>
                                            </span>
                                        </div>
                                        <div  class="col-lg-8 col-md-8" >
                                            <span class="blue T3_1 emailBreak"  >{{ViewCustomer.CustomerInfo.CustomerInfo.HomeEmail}} </span>
                                        </div>
                                    </div>
                                    <div class="row " ng-show="ViewCustomer.CustomerInfo.CustomerInfo.PreferredEmail != 'WorkEmail' && ViewCustomer.CustomerInfo.CustomerInfo.Type == 'Business' 
                                        && ViewCustomer.CustomerInfo.CustomerInfo.WorkEmail != ''" >
                                        <div class="col-lg-4 col-md-4 customer_general_column">
                                            <span style="padding-top:10px;">
                                                <div class="non_favorite"><label class="T7 label_favorite" for="labelFirstName">Work Email</label></div>
                                            </span>
                                        </div>
                                        <div  class="col-lg-8 col-md-8" >
                                            <span class="blue T3_1 emailBreak"  >{{ViewCustomer.CustomerInfo.CustomerInfo.WorkEmail}} </span>
                                        </div>
                                    </div>
                                    <div class="row " ng-show="ViewCustomer.CustomerInfo.CustomerInfo.PreferredEmail != 'OtherEmail' && ViewCustomer.CustomerInfo.CustomerInfo.OtherEmail != ''" >
                                        <div class="col-lg-4 col-md-4 customer_general_column">
                                            <span style="padding-top:10px;">
                                                <div class="non_favorite"><label class="T7 label_favorite" for="labelFirstName">Other Email</label></div>
                                            </span>
                                        </div>
                                        <div  class="col-lg-8 col-md-8" >
                                            <span class="blue T3_1 emailBreak"  >{{ViewCustomer.CustomerInfo.CustomerInfo.OtherEmail}} </span>
                                        </div>
                                    </div>
                                    <div class="row " ng-show="ViewCustomer.CustomerInfo.CustomerInfo.HomeNumberSMS==true && ViewCustomer.CustomerInfo.CustomerInfo.Type == 'Individual' 
                                        && ViewCustomer.CustomerInfo.CustomerInfo.PreferredPhoneLabel != 'HomeNumber'
                                        && ViewCustomer.CustomerInfo.CustomerInfo.HomeNumber != ''" >
                                        <div class="col-lg-4 col-md-4 customer_general_column">
                                            <span style="padding-top:10px;">
                                                <div class="non_favorite"><label class="T7 label_favorite" for="labelFirstName">Call Home</label></div>
                                            </span>
                                        </div>
                                        <div  class="col-lg-8 col-md-8" >
                                            <span class="blue T3"  >{{ViewCustomer.CustomerInfo.CustomerInfo.HomeNumber}} </span>
                                        </div>
                                    </div>
                                    <div class="row "  ng-show="ViewCustomer.CustomerInfo.CustomerInfo.HomeNumberSMS==true && ViewCustomer.CustomerInfo.CustomerInfo.Type == 'Individual' && 
                                        ViewCustomer.CustomerInfo.CustomerInfo.PreferredPhoneLabel != 'HomeNumber' && ViewCustomer.CustomerInfo.CustomerInfo.HomeNumber != ''">
                                        <div class="col-lg-4 col-md-4 customer_general_column">
                                            <span style="padding-top:10px;">
                                                <div class="non_favorite"><label class="T7 label_favorite" for="labelFirstName">SMS Home</label></div>
                                            </span>
                                        </div>
                                        <div  class="col-lg-8 col-md-8" >
                                            <span class="blue T3"  >{{ViewCustomer.CustomerInfo.CustomerInfo.HomeNumber}} </span>
                                        </div>
                                    </div>
                                    <div class="row "  ng-show="ViewCustomer.CustomerInfo.CustomerInfo.Type == 'Business' && ViewCustomer.CustomerInfo.CustomerInfo.PreferredPhoneLabel != 'WorkNumber'
                                        && ViewCustomer.CustomerInfo.CustomerInfo.WorkNumber != ''">
                                        <div class="col-lg-4 col-md-4 customer_general_column">
                                            <span style="padding-top:10px;">
                                                <div class="non_favorite"><label class="T7 label_favorite" for="labelFirstName">Call Work</label></div>
                                            </span>
                                        </div>
                                        <div  class="col-lg-8 col-md-8" >
                                            <span class="blue T3"  >{{ViewCustomer.CustomerInfo.CustomerInfo.WorkNumber}} </span>
                                        </div>
                                    </div>
                                    <div class="row " ng-show="ViewCustomer.CustomerInfo.CustomerInfo.PreferredSMSLabel != 'WorkNumberSMS' && ViewCustomer.CustomerInfo.CustomerInfo.WorkNumber != ''
                                        && ViewCustomer.CustomerInfo.CustomerInfo.PreferredPhoneLabel != 'WorkNumberSMS'">
                                        <div class="col-lg-4 col-md-4 customer_general_column">
                                            <span style="padding-top:10px;">
                                                <div class="non_favorite"><label class="T7 label_favorite" for="labelFirstName">SMS Work</label></div>
                                            </span>
                                        </div>
                                        <div  class="col-lg-8 col-md-8" >
                                            <span class="blue T3"  >{{ViewCustomer.CustomerInfo.CustomerInfo.WorkNumber}} </span>
                                        </div>
                                    </div>
                                    <div class="row "  ng-show="ViewCustomer.CustomerInfo.CustomerInfo.PreferredPhoneLabel != 'OtherPhone' &&
                                        ViewCustomer.CustomerInfo.CustomerInfo.OtherPhone != ''">
                                        <div class="col-lg-4 col-md-4 customer_general_column">
                                            <span style="padding-top:10px;">
                                                <div class="non_favorite"><label class="T7 label_favorite" for="labelFirstName">Call Other</label></div>
                                            </span>
                                        </div>
                                        <div  class="col-lg-8 col-md-8" >
                                            <span class="blue T3"  >{{ViewCustomer.CustomerInfo.CustomerInfo.OtherPhone}} </span>
                                        </div>
                                    </div>
                                    <div class="row "   ng-show="ViewCustomer.CustomerInfo.CustomerInfo.PreferredSMSLabel != 'MobileNumberSMS' && ViewCustomer.CustomerInfo.CustomerInfo.OtherPhone != '' &&  ViewCustomer.CustomerInfo.CustomerInfo.MobileNumberSMS ==true">

                                        <div class="col-lg-4 col-md-4 customer_general_column">
                                            <span style="padding-top:10px;">
                                                <div class="non_favorite"><label class="T7 label_favorite" for="labelFirstName">SMS Other</label></div>
                                            </span>
                                        </div>
                                        <div  class="col-lg-8 col-md-8" >
                                            <span class="blue T3"  >{{ViewCustomer.CustomerInfo.CustomerInfo.OtherPhone}} </span>
                                        </div>
                                    </div>
                                    <div class="row "   ng-show="ViewCustomer.CustomerInfo.CustomerInfo.JobTitle != ''">
                                        <div class="col-lg-4 col-md-4 customer_general_column">
                                            <span style="padding-top:10px;">
                                                <div class="non_favorite"><label class="T7 label_favorite" for="labelFirstName">Job Title</label></div>
                                            </span>
                                        </div>
                                        <div  class="col-lg-8 col-md-8" >
                                            <span class="blue T3"  >{{ViewCustomer.CustomerInfo.CustomerInfo.JobTitle}} </span>
                                        </div>
                                    </div>
                                    <div class="row "   ng-show="ViewCustomer.CustomerInfo.CustomerInfo.Company != ''">
                                        <div class="col-lg-4 col-md-4 customer_general_column">
                                            <span style="padding-top:10px;">
                                                <div class="non_favorite"><label class="T7 label_favorite" for="labelFirstName">Company</label></div>
                                            </span>
                                        </div>
                                        <div  class="col-lg-8 col-md-8" >
                                            <span class="blue T3"  >{{ViewCustomer.CustomerInfo.CustomerInfo.Company}} </span>
                                        </div>
                                    </div>
                                    <div class="row "   ng-show="ViewCustomer.CustomerInfo.CustomerInfo.Birthdate != null">
                                        <div class="col-lg-4 col-md-4 customer_general_column">
                                            <span style="padding-top:10px;">
                                                <div class="non_favorite"><label class="T7 label_favorite" for="labelFirstName">Birthday</label></div>
                                            </span>
                                        </div>
                                        <div  class="col-lg-8 col-md-8" >
                                            <span class="blue T3"  >{{ViewCustomer.CustomerInfo.CustomerInfo.Birthdate | date:'MMM d, y'}}  </span>
                                        </div>
                                    </div>
                                    <!-- <div class="row "   ng-show="ViewCustomer.CustomerInfo.CustomerInfo.SalesTaxName != ''">
                                        <div class="col-lg-4 col-md-4 customer_general_column">
                                            <span style="padding-top:10px;">
                                                <div class="non_favorite"><label class="T7 label_favorite" for="labelFirstName">Sales Tax</label></div>
                                            </span>
                                        </div>
                                        <div  class="col-lg-8 col-md-8" >
                                            <span class="blue T3"  >{{ViewCustomer.CustomerInfo.CustomerInfo.SalesTaxName}}</span>
                                        </div>
                                    </div> -->
                                    <div class="row "   ng-show="ViewCustomer.CustomerInfo.CustomerInfo.PriceLevelName != ''">
                                        <div class="col-lg-4 col-md-4 customer_general_column">
                                            <span style="padding-top:10px;">
                                                <div class="non_favorite"><label class="T7 label_favorite" for="labelFirstName">Price Level</label></div>
                                            </span>
                                        </div>
                                        <div  class="col-lg-8 col-md-8" >
                                            <span class="blue T3"  >{{ViewCustomer.CustomerInfo.CustomerInfo.PriceLevelName}}</span>
                                        </div>
                                    </div>
                                    <div class="row "   ng-show="ViewCustomer.CustomerInfo.CustomerInfo.PurchaseTaxName != ''">
                                        <div class="col-lg-4 col-md-4 customer_general_column">
                                            <span style="padding-top:10px;">
                                                <div class="non_favorite"><label class="T7 label_favorite" for="labelFirstName">Vendor Tax</label></div>
                                            </span>
                                        </div>
                                        <div  class="col-lg-8 col-md-8" >
                                            <span class="blue T3"  >{{ViewCustomer.CustomerInfo.CustomerInfo.PurchaseTaxName}}</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-12 col-lg-12 see_more_button_row " ng-show="ViewCustomer.ShowMore ==true">
                                        <button class="form-control C5 T4 see_more_button round_btn"  ng-click="ViewCustomer.showMoreDetails(false)">SEE MORE...</button>
                                    </div>
                                    <div class="col-md-12 col-lg-12 see_more_button_row " ng-show="ViewCustomer.ShowMore ==false">
                                        <button class="form-control C5 T4 see_more_button round_btn"  ng-click="ViewCustomer.showMoreDetails(true)">SEE LESS...</button> 
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-offset-2 col-lg-offset-2 col-md-4 col-lg-4 subsectionGeneral">  
                            <div class="row" ng-show="ViewCustomer.CustomerInfo.CustomerInfo.IsBothAddressSame ==false" >
                                <div class=" col-lg-4 col-md-4 " style="padding-left:10px ;text-align:center;cursor:pointer">
                                    <div class="T4 round_btn" ng-click="ViewCustomer.changeActiveAddress('BillingAddress')"  
                                        ng-class="{ C11: ViewCustomer.activeAddress=='BillingAddress' ,  C5: ViewCustomer.activeAddress=='ShippingAddress'}" > BILLING </div>
                                </div>
                                
                                
                                <div class=" col-lg-4 col-md-4 "  style="padding-left:10px;text-align:center;cursor:pointer" >
                                    <div class="T4 round_btn" ng-class="{ C5: ViewCustomer.activeAddress=='BillingAddress' ,  C11: ViewCustomer.activeAddress=='ShippingAddress'}" ng-click="ViewCustomer.changeActiveAddress('ShippingAddress')" > SHIPPING </div>
                                </div>
                            </div>
                            <div class="row"  ng-show="ViewCustomer.CustomerInfo.CustomerInfo.IsBothAddressSame==true">
                                <div class=" col-lg-4 col-md-4 " style="padding-left:10px ;text-align:center;cursor:pointer">
                                    <div class="C11 T4 round_btn"  ng-click="ViewCustomer.changeActiveAddress('ShippingAddress')" > ADDRESS </div>
                                </div>
                            </div>
                            <div class="row" >
                                <div class="col-lg-12 col-md-12" style="padding:10px" >
                                    <map zoom="12" center="37.7699298, -122.4469157" style="height:160px " >
                                        <directions 
                                            draggable="false"
                                            panel="directions-panel" 
                                            travel-mode="DRIVING"
                                            origin="{{ViewCustomer.OriginAddress}}"
                                            destination="{{ViewCustomer.addressOnMap}}">
                                        </directions>
                                    </map>
                                </div>
                            </div>
                            <div class="row">  
                                <div class="col-lg-12 col-md-12" style="padding:10px">
                                        
                                    <p class="T3"  ng-show="ViewCustomer.CustomerInfo.CustomerInfo.IsBothAddressSame ==false" >
                                        <b ng-show="ViewCustomer.activeAddress=='ShippingAddress'" >Shipping Address</b>
                                        <b ng-show="ViewCustomer.activeAddress=='BillingAddress'" >Billing Address</b>
                                    </p>
                                    <p class="T3"  ng-show="ViewCustomer.CustomerInfo.CustomerInfo.IsBothAddressSame ==true" >
                                        <b> Address</b>
                                    </p>
                                    
                                    <div ng-show="ViewCustomer.CustomerInfo.CustomerInfo.IsBothAddressSame ==false" >
                                            <div ng-show="ViewCustomer.activeAddress=='ShippingAddress'">
                                                <p class="T7" >{{ViewCustomer.CustomerInfo.CustomerInfo.ShippingStreet1}} {{ViewCustomer.CustomerInfo.CustomerInfo.ShippingStreet2}}</p>
                                                <p class="T7" >{{ViewCustomer.CustomerInfo.CustomerInfo.ShippingCity}}  {{ViewCustomer.CustomerInfo.CustomerInfo.ShippingState}}</p>
                                                <p class="T7" >{{ViewCustomer.CustomerInfo.CustomerInfo.ShippingCountry}}   {{ViewCustomer.CustomerInfo.CustomerInfo.ShippingPostalCode}}</p>
                                            </div>
                                            <div ng-show="ViewCustomer.activeAddress=='BillingAddress'">
                                                <p class="T7" >{{ViewCustomer.CustomerInfo.CustomerInfo.BillingStreet1}} {{ViewCustomer.CustomerInfo.CustomerInfo.BillingStreet2}}</p>
                                                <p class="T7" >{{ViewCustomer.CustomerInfo.CustomerInfo.BillingCity}}  {{ViewCustomer.CustomerInfo.CustomerInfo.BillingState}}</p>
                                                <p class="T7" >{{ViewCustomer.CustomerInfo.CustomerInfo.BillingCountry}}   {{ViewCustomer.CustomerInfo.CustomerInfo.BillingPostalCode}}</p>
                                            </div>
                                            
                                    </div>
                                    <div ng-show="ViewCustomer.CustomerInfo.CustomerInfo.IsBothAddressSame ==true" >
                                                <p class="T7" >{{ViewCustomer.CustomerInfo.CustomerInfo.BillingStreet1}} {{ViewCustomer.CustomerInfo.CustomerInfo.BillingStreet2}}</p>
                                                <p class="T7" >{{ViewCustomer.CustomerInfo.CustomerInfo.BillingCity}}  {{ViewCustomer.CustomerInfo.CustomerInfo.BillingState}}</p>
                                                <p class="T7" >{{ViewCustomer.CustomerInfo.CustomerInfo.BillingCountry}}   {{ViewCustomer.CustomerInfo.CustomerInfo.BillingPostalCode}}</p>
                                    </div>
                                    
                                </div>
                            </div>
                        </div>
                        <!-- <div class="col-md-4 col-lg-4 subsectionGeneral">
                            <mb-datepicker element-id='date1'
                                input-class="testClass"
                                input-name="testName"
                                arrows="arrows"
                                calendar-header="header"
                                date="date"
                                date-format="YYYY-MM-DD" ></mb-datepicker>
                        </div> -->
                    </div>
                </div>
            </div>
            <div class="sectionHeader row">
                <div class="col-lg-4 col-lg-5">
                    <div class="fixedHeaderText">
                        <span class="headerlabel">
                        <i class="fa fa-angle-right" style="width:10px; padding: 0 3px;"
                            ng-show="!ViewCustomer.displaySections.Statistics"
                            ng-Click="ViewCustomer.displaySections.Statistics = true">
                        </i> 
                        <i class="fa fa-angle-down" style="width:10px;"
                            ng-show="ViewCustomer.displaySections.Statistics"
                            ng-Click="ViewCustomer.displaySections.Statistics = false">
                        </i> 
                        <span class="divider">|</span>
                        <span class="T2">B Statistics</span>
                        </span>
                        <span class="ActionIcons pull-right">
                        <!-- <i class="fa fa-th"></i> -->
                        <i class="fa fa-question-circle" data-toggle="tooltip" title="{{ViewCustomer.helpText['Statistics']}}"></i>

                        </span> 
                    </div>
                </div>
            </div>
            <div id="StatisticsSection" >
                <div class="main_section row" ng-show="ViewCustomer.displaySections.Statistics">
                    <div id="VitalStatistics">
                        <p class="actionRow T2">
                            <span class="sectionText">Vital Statistics</span>
                            <!-- <span class="actionText">Actions</span> -->
                            <span class="ActionIcons">
                            <!-- <i class="fa fa-th"></i> -->
                            <i class="fa fa-question-circle" data-toggle="tooltip" title="{{ViewCustomer.helpText['Vital_Statistics']}}"></i>

                            </span> 
                        </p>
                        <div class="row statistics_row">
                            <div  style="  height:84px ; float :left ; margin-left: 1%;" class="C7" >
                                            <div>
                                                <div class="T4" style="width: 100%" > ORDERS LIFETIME</div>
                                                <div class="T13"  style="width: 100%" ng-show="ViewCustomer.CustomerInfo.OrdersLifetime != null" >{{ViewCustomer.CustomerInfo.OrdersLifetime}}</div>
                                                <div class="T13"  style="width: 100%" ng-show="ViewCustomer.CustomerInfo.OrdersLifetime == null" >0</div>
                                            </div> 
                                    </div>
                                    <div  style="  height:84px ; float :left ; margin-left: 1%;" class="C7" >
                                            <div>
                                                <div class="T4"  style="width: 100%"> OPEN ORDERS</div>
                                                <div class="T13"  style="width: 100%" ng-show="ViewCustomer.CustomerInfo.OpenOrders != null"> {{ViewCustomer.CustomerInfo.OpenOrders}}</div>
                                                <div class="T13"  style="width: 100%" ng-show="ViewCustomer.CustomerInfo.OpenOrders == null"> 0</div>
                                            </div> 
                                    </div>
                                    <div  style="  height:84px ; float :left ; margin-left: 1%;" class="C7" >
                                            <div>
                                                <div class="T4" style="width: 100%"  > AVERAGE SPEND PER ORDER </div>
                                                <div class="T13"  style="width: 100%" ng-show="ViewCustomer.CustomerInfo.AverageSpendPerHour != null" > ${{ViewCustomer.CustomerInfo.AverageSpendPerHour | number : 2}}</div>
                                                <div class="T13"  style="width: 100%" ng-show="ViewCustomer.CustomerInfo.AverageSpendPerHour == null" > $0</div>
                                            </div> 
                                    </div> 
                                    <div  style="  height:84px ; float :left ; margin-left: 1%;" class="C7" >
                                            <div>
                                                <div>
                                                    <div class="T4" style="width: 100%" > LAST VISIT </div>
                                                    <div class="T13" style="width: 100%;" ng-show="ViewCustomer.CustomerInfo.LastVisit != ''" > {{ViewCustomer.CustomerInfo.LastVisit}}</div>
                                                    <div class="T13" style="width: 100%"  ng-show="ViewCustomer.CustomerInfo.LastVisit == ''"  > 0</div>
                                                </div>  
                                            </div>  
                                    </div>
                                    <!-- <div  style="  height:84px ; float :left ; margin-left: 1%;" class="C7" >
                                            <div style="padding-top:20px;padding-left: 10%;padding-right: 10%;text-align: center;" >
                                                <div class="T4" style="width: 100%" >EVENT  ATTENDENCE </div>
                                                <div class="T13" style="width: 100%" > 98% </div>
                                            </div> 
                                    </div> -->
                                    <!-- <div  style="  height:84px ; float :left ; margin-left: 1%;" class="C7" >
                                            <div style="padding-top:20px;padding-left: 10%;padding-right: 10%;text-align: center;" >
                                                <div class="T4"  style="width: 100%" > UPSELL SUCESS </div>
                                                <div class="T13"  style="width: 100%" > 39%</div>
                                            </div> 
                                    </div> -->
                        </div>
                    </div>
                    
                    <!-- <div id="TelemetryStatistics">
                        <div class="telemetry_Main">
                            <p class="actionRow T2 ">
                                <span class="sectionText">Telemetry</span>
                                <span class="actionText">Actions</span>
                                <span class="ActionIcons">
                                <i class="fa fa-th"></i>
                                <i class="fa fa-question-circle" data-toggle="tooltip" title="{{ViewCustomer.helpText['Telemetry']}}"></i>

                                </span> 
                            </p>
                        </div>
                    </div> -->
                </div>
            </div>
            <div class="sectionHeader row">
                <div class="col-lg-4 col-lg-5">
                    <div class="fixedHeaderText">
                        <span class="headerlabel">
                        <i class="fa fa-angle-right" style="width:10px; padding: 0 3px;"
                            ng-show="!ViewCustomer.displaySections.Related"
                            ng-Click="ViewCustomer.displaySections.Related = true">
                        </i> 
                        <i class="fa fa-angle-down" style="width:10px;"
                            ng-show="ViewCustomer.displaySections.Related"
                            ng-Click="ViewCustomer.displaySections.Related = false">
                        </i> 
                        <span class="divider">|</span>
                        <span class="T2">C Related</span>
                        </span>
                        <span class="ActionIcons pull-right">
                        <!-- <i class="fa fa-th"></i> -->
                        <i class="fa fa-question-circle" data-toggle="tooltip" title="{{ViewCustomer.helpText['Related']}}"></i>

                        </span> 
                    </div>
                </div>
            </div>
            <div id="RelatedSection" >
                <div ng-show="ViewCustomer.displaySections.Related">
                    <div id="RelatedSection_Cou_Block">
                        <div class="main_section_COU row">
                            <div class="main_section_COU_Header row" >
                                <p class="actionRow T2">
                                    <span class="sectionText">Customer Owned Units <i class="fa fa-plus cou_plus_icon " ng-click="ViewCustomer.openAddCustomerOwnedUnitPopup($event)"></i></span>
                                    <!-- <span class="actionText">Actions</span> -->
                                    <span class="ActionIcons">
                                    <!-- <i class="fa fa-th"></i> -->
                                    <i class="fa fa-question-circle" data-toggle="tooltip" title="{{ViewCustomer.helpText['COU']}}"></i>

                                    </span> 
                                </p>
                            </div>
                            <div class="gid_container T6" id="CM_Owned_UnitsGrid_Empty_Div" 
                                ng-show="ViewCustomer.CMOwnedUnits.length == 0" style="padding-left: 44px;">
                                {!$Label.Label_No_Records_Found}
                            </div>
                            <div ng-show="ViewCustomer.CMOwnedUnits.length != 0">
                                <div class="gid_container_Customer" id="Customer_Owned_Units" >
                                    <table class="table" id="CM_Owned_UnitsGrid">
                                        <col width="1%"  />
                                        <col width="3%"  />
                                        <col width="8%"  />
                                        <col width="16%" />
                                        <col width="11%"  />
                                        <col width="12%" />
                                        <col width="17%" />
                                        <col width="10%"  />
                                        <col width="8%" />
                                        <col width="13%"  />
                                        <col width="1%"  />











                                        <tr  class="tableHeader T3 C2">
                                            <th></th>
                                            <th></th>
                                            <th>YEAR</th>
                                            <th>MAKE</th>
                                            <th>MODEL</th>
                                            <th>SUB MODEL</th>
                                            <th>VIN</th>
                                            <th>PLATE</th>
                                            <th>MILEAGE</th>
                                            <th>COLOR</th>
                                            <th></th>
                                        </tr>












                                        <tbody ng-repeat="ownedUnit in ViewCustomer.CMOwnedUnits" >
                                            <!-- Display rows -->

                                            <tr class="clickable_row" id="row1" rel="owned_unit_row{{$index}}_edit"  ng-click="ViewCustomer.editOwnedUnit($event, $index)"
                                                ng-blur = "ViewCustomer.editOwnedUnit($event, $index)"  ng-class-even="'C2'"   >
                                                <td style="background:#fff"></td>
                                                <td id="CM_Owned_Units_block_grid_container_tbody_tr_td_1_{{$index}}" >
                                                    <a href="" class="edite_btn" rel="row1_edit">
                                                        <img src="{!URLFOR($Resource.Images, 'user-3.png')}" class="first_img" /> 
                                                    </a>
                                                </td>


                                                <td id="CM_Owned_Units_block_grid_container_tbody_tr_td_2_{{$index}}" class="T7">  <span>{{ownedUnit.Year}}</span> </td>
                                                <td id="CM_Owned_Units_block_grid_container_tbody_tr_td_3_{{$index}}" class="T7 " ><u>  {{ownedUnit.MakeName}}</u></td>
                                                <td id="CM_Owned_Units_block_grid_container_tbody_tr_td_4_{{$index}}" class="T7">  {{ownedUnit.ModelName}} </td>
                                                <td id="CM_Owned_Units_block_grid_container_tbody_tr_td_5_{{$index}}" class="T7">  {{ownedUnit.SubModelName}}      </td>
                                                <td id="CM_Owned_Units_block_grid_container_tbody_tr_td_6_{{$index}}"  class="T7"> {{ownedUnit.VIN}}           </td>
                                                <td id="CM_Owned_Units_block_grid_container_tbody_tr_td_7_{{$index}}" class="T7">  {{ownedUnit.Plate}}         </td>
                                                <td id="CM_Owned_Units_block_grid_container_tbody_tr_td_8_{{$index}}" class="T7">  {{ownedUnit.Mileage}}       </td>
                                                <td id="CM_Owned_Units_block_grid_container_tbody_tr_td_9_{{$index}}" class="T7 ">  {{ownedUnit.Color}}     </td>
                                                <td style="background:#fff"></td>
                                            </tr>

                                            <!-- action editable Row -->
                                            <tr ng-show="ViewCustomer.CMOwnedUnits_editRow[$index].isEdit" class="edit_panel sample-show-hide" id="owned_unit_row{{$index}}_edit">
                                                <td style="background:#fff"></td>
                                                <td colspan="9" id="CM_Owned_Units_block_grid_container_tbody_expandtr_td_1_{{$index}}">
                                                    <div id="CM_Owned_Units_block_grid_container_tbody_expandtr_edit_box_{{$index}}" class="edit_box col-lg-9 col-md-9" ng-show="ViewCustomer.CMOwnedUnits_editRow[$index].isEdit">
                                                        <div class="its-heading" id="CM_Owned_Units_block_grid_container_tbody_expandtr_edit_box_its-heading_{{$index}}">
                                                            <img src="{!URLFOR($Resource.icon_images, 'images/edit_icon.png')}" class="img_action"/>
                                                            <span>Actions (4 Available)</span>
                                                        </div>

                                                        <div id="CM_Owned_Units_block_grid_container_tbody_expandtr_edit_box_its-heading_edit-body_{{$index}}" class="edit-body">
                                                            <form>
                                                                <!-- Edit link as action -->


                                                                <div class="radio" id="CM_Owned_Units_block_grid_container_tbody_expandtr_edit_box_its-heading_edit-body_{{$index}}_radio_1">
                                                                    <label>

                                                                    <input type="radio" name="optionsRadios" id="optionsRadios1" value="1"
                                                                        ng-model= "ViewCustomer.CMOwnedUnits_editRow[$index].radioValue"/>
                                                                    <span>

                                                                    <i class="fa fa-pencil-square-o"></i>
                                                                    Edit
                                                                    </span>
                                                                    </label>
                                                                </div>
                                                                <!-- Schedule Service as action -->





                                                                <div class="radio" id="CM_Owned_Units_block_grid_container_tbody_expandtr_edit_box_its-heading_edit-body_{{$index}}_radio_2">
                                                                    <label>

                                                                    <input type="radio" name="optionsRadios" id="optionsRadios2" value="2"
                                                                        ng-model= "ViewCustomer.CMOwnedUnits_editRow[$index].radioValue"/>
                                                                    <span>

                                                                    <i class="fa fa-pencil-square-o"></i>
                                                                    Schedule Service
                                                                    </span>
                                                                    </label>
                                                                </div>




                                                                <!-- Transfer to another customer as action -->
                                                                <div class="radio" id="CM_Owned_Units_block_grid_container_tbody_expandtr_edit_box_its-heading_edit-body_{{$index}}_radio_3">
                                                                    <label>

                                                                    <input type="radio" name="optionsRadios" id="optionsRadios3" value="3"
                                                                        ng-model= "ViewCustomer.CMOwnedUnits_editRow[$index].radioValue"/>
                                                                    <span>

                                                                    <i class="fa fa-pencil-square-o"></i>
                                                                    Transfer to another customer
                                                                    </span>
                                                                    </label>
                                                                </div>
                                                                <!-- Remove link as action -->





                                                                <div class="radio" id="CM_Owned_Units_block_grid_container_tbody_expandtr_edit_box_its-heading_edit-body_{{$index}}_radio_4">
                                                                    <label>

                                                                    <input type="radio" name="optionsRadios" id="optionsRadios4" value="4"
                                                                        ng-model= "ViewCustomer.CMOwnedUnits_editRow[$index].radioValue"/>
                                                                    <span>
                                                                    <i class="fa fa-times"></i>
                                                                    Remove Link
                                                                    </span>
                                                                    </label>
                                                                </div>
                                                                <!-- Action button (Go) -->







                                                                <a href="" id="CM_Owned_Units_block_grid_container_tbody_expandtr_edit_box_its-heading_edit-body_{{$index}}_go_btn" 
                                                                    class="btn C11 T4 addmoreinfoBtn editform_btn" role="button"
                                                                    ng-click="ViewCustomer.CM_OwnedUnits_GoAction($index)"> Go  </a>                                
                                                            </form>
                                                        </div>
                                                    </div>
                                                </td>




                                                <td style="background:#fff"></td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                





                                <!-- Pagination container -->
                                <div class="row pagination_container" id="COU_Items_Pagination" style="margin-left: 10px; margin-right: 0;"
                                    ng-if="ViewCustomer.TotalCOURecords != undefined" >
                                    <list-pagination id-value = "COU_Items_Pagination_" 
                                                    total-records-length = "ViewCustomer.TotalCOURecords"
                                                    page-size = "ViewCustomer.COUPageSortAttrsJSON.PageSize"
                                                    current-page = "ViewCustomer.COUPageSortAttrsJSON.CurrentPage"
                                                    changes-count = "ViewCustomer.COUPageSortAttrsJSON.ChangesCount"
                                                    pagination-control-method = "ViewCustomer.COUs_paginationControlsAction" />
                                </div>
                            </div>
                        </div>


                        <!--   <p class="actionRow T2">
                            <span class="sectionText">Customers</span>
                            <span class="actionText">Actions</span>
                            <span class="ActionIcons">
                                <i class="fa fa-th"></i>
                                <i class="fa fa-question-circle"></i>
                            </span> 
                            </p>
                            
                            <p class="actionRow T2">
                            <span class="sectionText">Contacts</span>
                            <span class="actionText">Actions</span>
                            <span class="ActionIcons">
                                <i class="fa fa-th"></i>
                                <i class="fa fa-question-circle"></i>
                            </span> 
                            </p> -->
                    </div>
                    
                    <!-- START: Active Orders section (Customer Orders) -->
                    <div id="RelatedSection_ActiveOrders_Block" ng-show="ViewCustomer.ActiveOrders.length != 0">
                        <div class="main_section_COU row">
                            <div class="main_section_COU_Header row" >
                                <p class="actionRow T2">
                                    <span class="sectionText">Active Orders</span>
                                    <!-- <span class="actionText">Actions</span> -->
                                    <span class="ActionIcons">
                                    <!-- <i class="fa fa-th"></i> -->
                                    <i class="fa fa-question-circle" data-toggle="tooltip" title="Active Orders"></i>

                                    </span> 
                                </p>
                            </div>
                            <div class="gid_container_Customer" id="Customer_Active_Orders" >
                                <table class="table" id="Active_Orders_Grid">
                                    <col width="1%"  />
                                    <col width="3%"  />
                                    <col width="12%"  />
                                    <col width="12%" />
                                    <col width="12%"  />
                                    <col width="12%" />
                                    <col width="12%" />
                                    <col width="1%"  />
                                    <tr  class="tableHeader T3 C2">
                                        <th></th>
                                        <th></th>
                                        <th>{!$Label.CO_Object_Short_Display_Label}</th>
                                        <th>{!$Label.Label_Status}</th>
                                        <th>{!$Label.Label_Total}</th>
                                        <th>Total Deposit</th>
                                        <th>Total Payment</th>
                                        <th></th>
                                    </tr>
                                    <tbody ng-repeat="activeOrder in ViewCustomer.ActiveOrders" >
                                        <!-- Display rows -->
                                        <tr class="clickable_row" id="row1" ng-class-even="'C2'"   >
                                            <td style="background:#fff"></td>
                                            <td id="CM_Active_Orders_block_grid_container_tbody_tr_td_1_{{$index}}" >
                                                <a href="" class="edite_btn" rel="row1_edit">
                                                    <img src="{!URLFOR($Resource.Images, 'user-3.png')}" class="first_img" /> 
                                                </a>
                                            </td>
                                            <td id="CM_Owned_Units_block_grid_container_tbody_tr_td_2_{{$index}}" class="T7">  <u>{{activeOrder.CONumber}}</u></td>
                                            <td id="CM_Owned_Units_block_grid_container_tbody_tr_td_3_{{$index}}" class="T7 "> {{activeOrder.Status}}</td>
                                            <td id="CM_Owned_Units_block_grid_container_tbody_tr_td_4_{{$index}}" class="T7">  {{activeOrder.TotalOrderValue | currency }} </td>
                                            <td id="CM_Owned_Units_block_grid_container_tbody_tr_td_5_{{$index}}" class="T7">  {{activeOrder.TotalDepositValue | currency }}  </td>
                                            <td id="CM_Owned_Units_block_grid_container_tbody_tr_td_6_{{$index}}"  class="T7"> {{activeOrder.TotalPaymentValue | currency }}</td>
                                            <td style="background:#fff"></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            
                            <!-- Pagination container -->
                            <div class="row pagination_container" id="Active_Orders_Pagination" style="margin-left: 10px; margin-right: 0;"
                                ng-if="ViewCustomer.TotalActiveOrderRecords != undefined" >
                                <list-pagination id-value = "Active_Orders_Pagination_" 
                                                total-records-length = "ViewCustomer.TotalActiveOrderRecords"
                                                page-size = "ViewCustomer.ActiveOrdersPageSortAttrsJSON.PageSize"
                                                current-page = "ViewCustomer.ActiveOrdersPageSortAttrsJSON.CurrentPage"
                                                changes-count = "ViewCustomer.ActiveOrdersPageSortAttrsJSON.ChangesCount"
                                                pagination-control-method = "ViewCustomer.ActiveOrders_paginationControlsAction" />
                            </div>
                        </div>
                    </div>
                    <!-- END: Active Orders section (Customer Orders) -->
                    
                    <div id="RelatedSection_Customer_BLock">
                        <div class="main_section_COU row">
                            <div class="main_section_COU_Header row" >
                                <p class="actionRow T2">
                                    <span class="sectionText">Customer <i class="fa fa-plus cou_plus_icon " ng-click="setFocusToSearchBox();"></i></span>
                                    <!-- <span class="actionText">Actions</span> -->
                                    <span class="ActionIcons">
                                    <!-- <i class="fa fa-th"></i> -->
                                    <i class="fa fa-question-circle" data-toggle="tooltip" title="{{ViewCustomer.helpText['Customers']}}"></i>

                                    </span> 
                                </p>
                            </div>
                            <div class="gid_container T6" id="Customers_Empty_Div" 
                                ng-show="ViewCustomer.CMCustomers.length == 0" style="padding-left: 44px;">
                                {!$Label.Label_No_Records_Found}
                            </div>
                            <div ng-show="ViewCustomer.CMCustomers.length != 0">
                                <div class="gid_container_Customer" id="Customers_Div" >

                                    <table class="table" id="CustomersGrid">
                                        <col width="1%"  />
                                        <col width="4%"  />
                                        <col width="17%"  />
                                        <col width="20%"  />
                                        <col width="17%" />
                                        <col width="25%"  />
                                        <col width="15%" />
                                        <col width="1%"  />








                                        <tr  class="tableHeader T3 C2">
                                            <th></th>
                                            <th></th>


                                            <th>CUSTOMER NUMBER</th>
                                            <th>CUSTOMER NAME</th>
                                            <th>PHONE NUMBER</th>
                                            <th>EMAIL ADDRESS</th>
                                            <th>RELATION</th>
                                            <th></th>
                                        </tr>






                                        <tbody  ng-repeat="indivCustomer in ViewCustomer.CMCustomers" >
                                            <!-- Display rows -->

                                            <tr class="clickable_row tddropdown"  id="row1" rel="rel_customer_row{{$index}}_edit" 
                                                ng-click="ViewCustomer.editRelatedCustomer($event, $index)"  ng-class-even="'C2'"  >
                                                <td style="background:#fff"></td>
                                                <td id="CM_Customers_block_grid_container_tbody_tr_td_1_{{$index}}">
                                                    <a href="" class="edite_btn C5" rel="row1_edit">
                                                    <img src="{!URLFOR($Resource.Images, 'star.png')}"  class="first_img" />
                                                    </a>
                                                </td>


                                                <td id="CM_Customers_block_grid_container_tbody_tr_td_2_{{$index}}" class="T7">    <span>{{indivCustomer.CustomerNumber}}</span>   </td>
                                                <td id="CM_Customers_block_grid_container_tbody_tr_td_3_{{$index}}" class="T7">    <u>{{indivCustomer.CustomerName}}</u>           </td>
                                                <td id="CM_Customers_block_grid_container_tbody_tr_td_4_{{$index}}" class="T7">
                                                    {{indivCustomer.PhoneNumber}}
                                                    <i class="fa fa-star orange favorite" ng-show="indivCustomer.IsPreferredPhone && indivCustomer.PhoneNumber != ''"></i>
                                                    <i class="fa fa-star-o" ng-show="!indivCustomer.IsPreferredPhone && indivCustomer.PhoneNumber != null && indivCustomer.PhoneNumber != ''"></i>
                                                </td>

                                                <td id="CM_Customers_block_grid_container_tbody_tr_td_5_{{$index}}" class="T7" >
                                                    {{indivCustomer.Email}}

                                                    <i class="fa fa-star orange favorite" ng-show="indivCustomer.IsPreferredEmail && indivCustomer.Email != ''"></i>
                                                    <i class="fa fa-star-o" ng-show="!indivCustomer.IsPreferredEmail && indivCustomer.Email != null && indivCustomer.Email != ''"></i>
                                                </td>

                                                <td id="CM_Customers_block_grid_container_tbody_tr_td_6_{{$index}}" class="T7 " >
                                                    <select class="form-control T7 input-sm  " ng-model="indivCustomer.Relation" 
                                                        ng-click="$event.stopPropagation();"
                                                        ng-change="ViewCustomer.addUpdateCustomerRecord(indivCustomer.Id, indivCustomer.Relation)">
                                                        <option value="Family">Family</option>
                                                        <option value="Friend">Friend</option>
                                                        <option value="Employee">Employee</option>
                                                        <option value="Co-Worker">Co-Worker</option>
                                                        <option value="Employer">Employer</option>
                                                    </select>
                                                </td>


                                                <td style="background:#fff"></td>
                                            </tr>

                                            <!-- Actions row in case editable row -->
                                            <tr ng-show="ViewCustomer.CMCustomers_editRow[$index].isEdit" class="edit_panel sample-show-hide" id="rel_customer_row{{$index}}_edit">
                                                <td style="background:#fff"></td>
                                                <td colspan="6" id="CM_Customers_block_grid_container_tbody_expandtr_td_1_{{$index}}">
                                                    <div id="CM_Customers_block_grid_container_tbody_expandtr_edit_box_{{$index}}" 
                                                        class="edit_box col-lg-9 col-md-9" 
                                                        ng-show="ViewCustomer.CMCustomers_editRow[$index].isEdit">
                                                        <div class="its-heading" id="CM_Customers_block_grid_container_tbody_expandtr_edit_box_its-heading_{{$index}}">
                                                            <img src="{!URLFOR($Resource.icon_images, 'images/edit_icon.png')}" styleClass="img_action"/>
                                                            <span>Actions (2 Available)</span>
                                                        </div>

                                                        <div id="CM_Customers_block_grid_container_tbody_expandtr_edit_box_its-heading_edit-body_{{$index}}" class="edit-body">
                                                            <form>
                                                                <!-- Edit link as action -->


                                                                <div class="radio" id="CM_Customers_block_grid_container_tbody_expandtr_edit_box_its-heading_edit-body_{{$index}}_radio_1">
                                                                    <label>

                                                                    <input type="radio" name="optionsRadios" id="optionsRadios2" value="1"
                                                                        ng-model= "ViewCustomer.CMCustomers_editRow[$index].radioValue"/>
                                                                    <span>

                                                                    <i class="fa fa-pencil-square-o"></i>
                                                                    Edit
                                                                    </span>
                                                                    </label>
                                                                </div>
                                                                <!-- Remove link as action -->





                                                                <div class="radio" id="CM_Customers_block_grid_container_tbody_expandtr_edit_box_its-heading_edit-body_{{$index}}_radio_2">
                                                                    <label>

                                                                    <input type="radio" name="optionsRadios" id="optionsRadios2" value="2"
                                                                        ng-model= "ViewCustomer.CMCustomers_editRow[$index].radioValue"/>
                                                                    <span>
                                                                    <i class="fa fa-times"></i>
                                                                    Remove Link
                                                                    </span>
                                                                    </label>
                                                                </div>
                                                                <!-- Action button (Go) -->







                                                                <a href="" id="CM_Customers_block_grid_container_tbody_expandtr_edit_box_its-heading_edit-body_{{$index}}_go_btn" class="btn C11 T4 addmoreinfoBtn editform_btn" role="button"
                                                                    ng-click="ViewCustomer.CM_Customers_GoAction($index)">  Go  </a>                                
                                                            </form>
                                                        </div>
                                                    </div>
                                                </td>




                                                <td style="background:#fff"></td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                <!-- Pagination container -->
                                <div class="row pagination_container" id="Customers_Pagination" style="margin-left: 10px;margin-right: 0;" 
                                    ng-if="ViewCustomer.TotalCustomerRecords != undefined" >
                                    <list-pagination id-value = "Customers_Pagination_" 
                                                    total-records-length = "ViewCustomer.TotalCustomerRecords"
                                                    page-size = "ViewCustomer.customersPageSortAttrsJSON.PageSize"
                                                    current-page = "ViewCustomer.customersPageSortAttrsJSON.CurrentPage"
                                                    changes-count = "ViewCustomer.customersPageSortAttrsJSON.ChangesCount"
                                                    pagination-control-method = "ViewCustomer.Customers_paginationControlsAction" />
                                </div>
                                



                            </div>











                        </div>
                    </div>
                    <div id="RelatedSection_Contact_BLock" ng-if="ViewCustomer.CustomerInfo.CustomerInfo.Type != 'Individual'">
                        <div class="main_section_COU row">
                            <div class="main_section_COU_Header row" >
                                <p class="actionRow T2">
                                    <span class="sectionText">Contact <i class="fa fa-plus cou_plus_icon " ng-click="ViewCustomer.openAddContactPopup()"></i></span>
                                    <!-- <span class="actionText">Actions</span> -->
                                    <span class="ActionIcons">
                                    <!-- <i class="fa fa-th"></i> -->
                                    <i class="fa fa-question-circle" data-toggle="tooltip" title="{{ViewCustomer.helpText['Contacts']}}"></i>

                                    </span> 
                                </p>
                            </div>
                            <div class="gid_container T6" id="CM_Owned_UnitsGrid_Empty_Div" 
                                ng-show="ViewCustomer.CMContacts.length == 0" style="padding-left: 44px;">
                                {!$Label.Label_No_Records_Found}
                            </div>
                            <div ng-show="ViewCustomer.CMContacts.length != 0">
                                <div class="gid_container_Customer" id="Contact_Div" >

                                    <table class="table" id="ContactGrid">
                                        <col width="1%"  />
                                        <col width="4%"  />
                                        <col width="16%"  />
                                        <col width="26%"  />
                                        <col width="17%" />
                                        <col width="22%"  />
                                        <col width="13%" />
                                        <col width="1%"  />








                                        <tr  class="tableHeader T3 C2">
                                            <th></th>
                                            <th></th>
                                            <th>FIRST NAME</th>
                                            <th>LAST NAME</th>
                                            <th>PHONE NUMBER</th>
                                            <th>EMAIL ADDRESS</th>
                                            <th>RELATION</th>
                                            <th></th>
                                        </tr>









                                        <tbody  ng-repeat="indivContact in ViewCustomer.CMContacts" >
                                            <!-- Display rows -->

                                            <tr class="clickable_row" id="row1" rel="rel_contact_row{{$index}}_edit" 
                                                ng-click="ViewCustomer.editRelatedContact($event, $index)"
                                                ng-blur = "ViewCustomer.editRelatedContact($event, $index)" ng-class-even="'C2'" >
                                                <td style="background:#fff"></td>
                                                <td id="CM_Contacts_block_grid_container_tbody_tr_td_1_{{$index}}">
                                                    <a href="" class="edite_btn C5" rel="row1_edit">
                                                    <img src="{!URLFOR($Resource.Images, 'star.png')}"  class="first_img" />
                                                    </a>
                                                </td>


                                                <td id="CM_Contacts_block_grid_container_tbody_tr_td_2_{{$index}}">     <span>{{indivContact.FirstName}}</span> </td>
                                                <td id="CM_Contacts_block_grid_container_tbody_tr_td_3_{{$index}}">     {{indivContact.LastName}}               </td>
                                                <td id="CM_Contacts_block_grid_container_tbody_tr_td_4_{{$index}}">
                                                    {{indivContact.Phone}}

                                                    <i class="fa fa-star orange" ng-show="indivContact.PreferredPhone && indivContact.Phone != ''"></i>
                                                    <i class="fa fa-star-o" ng-show="!indivContact.PreferredPhone && indivContact.Phone != null && indivContact.Phone != ''"></i>
                                                </td>

                                                <td id="CM_Contacts_block_grid_container_tbody_tr_td_5_{{$index}}">
                                                    {{indivContact.Email}}

                                                    <i class="fa fa-star orange" ng-show="indivContact.PreferredEmail && indivContact.Email != ''"></i>
                                                    <i class="fa fa-star-o" ng-show="!indivContact.PreferredEmail && indivContact.Email != null && indivContact.Email != ''"></i>
                                                </td>

                                                <td id="CM_Contacts_block_grid_container_tbody_tr_td_6_{{$index}}" >
                                                    <select class="form-control" ng-model="indivContact.Relation" 
                                                        ng-change="ViewCustomer.addUpdateContactRecord(indivContact.Id, indivContact.Relation)" 
                                                        ng-click="$event.stopPropagation();">
                                                        <option value="Family">Family</option>
                                                        <option value="Friend">Friend</option>
                                                        <option value="Employee">Employee</option>
                                                        <option value="Co-Worker">Co-Worker</option>
                                                        <option value="Employer">Employer</option>
                                                    </select>
                                                </td>


                                                <td style="background:#fff"></td>
                                            </tr>

                                            <!-- Actions row in case editable row -->
                                            <tr ng-show="ViewCustomer.CMContacts_editRow[$index].isEdit" class="edit_panel sample-show-hide" id="rel_contact_row{{$index}}_edit">
                                                <td style="background:#fff"></td>
                                                <td colspan="6" id="CM_Contacts_block_grid_container_tbody_expandtr_td_1_{{$index}}">
                                                    <div id="CM_Contacts_block_grid_container_tbody_expandtr_edit_box_{{$index}}" 
                                                        class="edit_box col-lg-9 col-md-9" 
                                                        ng-show="ViewCustomer.CMContacts_editRow[$index].isEdit">
                                                        <div class="its-heading" id="CM_Contacts_block_grid_container_tbody_expandtr_edit_box_its-heading_{{$index}}">
                                                            <img src="{!URLFOR($Resource.icon_images, 'images/edit_icon.png')}" styleClass="img_action"/>
                                                            <span>Actions (2 Available)</span>
                                                        </div>

                                                        <div id="CM_Contacts_block_grid_container_tbody_expandtr_edit_box_its-heading_edit-body_{{$index}}" class="edit-body">
                                                            <form>
                                                                <!-- Edit link as action -->


                                                                <div class="radio" id="CM_Contacts_block_grid_container_tbody_expandtr_edit_box_its-heading_edit-body_{{$index}}_radio_1">
                                                                    <label>

                                                                    <input type="radio" name="optionsRadios" id="optionsRadios2" value="1"
                                                                        ng-model= "ViewCustomer.CMContacts_editRow[$index].radioValue"/>
                                                                    <span>

                                                                    <i class="fa fa-pencil-square-o"></i>
                                                                    Edit
                                                                    </span>
                                                                    </label>
                                                                </div>
                                                                <!-- Remove link as action -->





                                                                <div class="radio" id="CM_Contacts_block_grid_container_tbody_expandtr_edit_box_its-heading_edit-body_{{$index}}_radio_2">
                                                                    <label>

                                                                    <input type="radio" name="optionsRadios" id="optionsRadios2" value="2"
                                                                        ng-model= "ViewCustomer.CMContacts_editRow[$index].radioValue"/>
                                                                    <span>
                                                                    <i class="fa fa-times"></i>
                                                                    Remove Link
                                                                    </span>
                                                                    </label>
                                                                </div>
                                                                <!-- Action button (Go) -->







                                                                <a href="" id="CM_Contacts_block_grid_container_tbody_expandtr_edit_box_its-heading_edit-body_{{$index}}_go_btn" class="btn C11 T4 addmoreinfoBtn editform_btn" role="button"

                                                                    ng-click="ViewCustomer.CM_Contacts_GoAction($index)">   Go  </a>                                
                                                            </form>
                                                        </div>
                                                    </div>
                                                </td>




                                                <td style="background:#fff"></td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>





                                <!-- Pagination container -->
                                <div class="row pagination_container" id="Contacts_Pagination" style="margin-left: 10px;margin-right: 0;"
                                    ng-if="ViewCustomer.TotalContactRecords != undefined" >
                                    <list-pagination id-value = "Contacts_Pagination_" 
                                                    total-records-length = "ViewCustomer.TotalContactRecords"
                                                    page-size = "ViewCustomer.contactsPageSortAttrsJSON.PageSize"
                                                    current-page = "ViewCustomer.contactsPageSortAttrsJSON.CurrentPage"
                                                    changes-count = "ViewCustomer.contactsPageSortAttrsJSON.ChangesCount"
                                                    pagination-control-method = "ViewCustomer.Contacts_paginationControlsAction" />
                                </div>
                            </div>
                        </div>
                        
                        
                    </div>
                
                    <!--  START: Tax Exemption -->
                    <div id="RelatedSection_Tax_Exemption_BLock">
                        <div class="main_section_COU row">
                            <div class="main_section_COU_Header row" >
                                <p class="actionRow T2">
                                    <span class="sectionText">Tax Exemptions
                                        <i class="fa fa-plus cou_plus_icon " ng-click="ViewCustomer.openTaxExemptionsPopup()"></i>
                                    </span>
                                    <!-- <span class="actionText">Actions</span> -->
                                    <span class="ActionIcons">
                                    <!-- <i class="fa fa-th"></i> -->
                                    <i class="fa fa-question-circle"></i>
                                    </span> 
                                </p>
                            </div>
                            <div class="gid_container_Customer" id="Customer_Owned_Units" >
                                <table class="table" id="CM_Owned_UnitsGrid">
                                    <col width="1%"  />
                                    <col width="4%"  />
                                    <col width="25%"  />
                                    <col width="25%"  />
                                    <col width="44%" />
                                    <col width="1%"  />
                                    <tr  class="tableHeader T3 C2">
                                        <th></th>
                                        <th></th>
                                        <th>TAX NAME</th>
                                        <th>TAX RATE</th>
                                        <th>APPLIES TO</th>
                                        <th></th>
                                    </tr>
                                    <tbody  ng-repeat="taxItem in ViewCustomer.TaxExemptions" >
                                        <!-- Display rows -->
                                        <tr class="clickable_row" id="row1" rel="rel_contact_row{{$index}}_edit" 
                                            ng-click="ViewCustomer.editTaxExemptions($event, $index)"
                                            ng-blur = "ViewCustomer.editTaxExemptions($event, $index)" ng-class-even="'C2'" >
                                            <td style="background:#fff"></td>
                                            <td id="CM_Contacts_block_grid_container_tbody_tr_td_1_{{$index}}">
                                                <a href="" class="edite_btn" rel="row1_edit" style="padding: 13px 5px;">
                                                    <i class="fa fa-list  Plr5 FC7 F18 first_img"></i>
                                                </a>
                                            </td>
                                            <td id="CM_Contacts_block_grid_container_tbody_tr_td_2_{{$index}}">     
                                                <span>{{taxItem.SalesTaxName}}</span> 
                                            </td>
                                            <td id="CM_Contacts_block_grid_container_tbody_tr_td_3_{{$index}}">     
                                                {{taxItem.Rate}}%               
                                            </td>
                                            <td id="CM_Contacts_block_grid_container_tbody_tr_td_4_{{$index}}">
                                                {{taxItem.Description}}
                                            </td>
                                            <td style="background:#fff"></td>
                                        </tr>
                                        <!-- Actions row in case editable row -->
                                        <tr ng-show="ViewCustomer.TaxExemptions_editRow[$index].isEdit" class="edit_panel sample-show-hide" id="rel_contact_row{{$index}}_edit">
                                            <td style="background:#fff"></td>
                                            <td colspan="4" id="CM_Contacts_block_grid_container_tbody_expandtr_td_1_{{$index}}">
                                                <div id="CM_Contacts_block_grid_container_tbody_expandtr_edit_box_{{$index}}" 
                                                    class="edit_box col-lg-9 col-md-9" 
                                                    ng-show="ViewCustomer.TaxExemptions_editRow[$index].isEdit">
                                                    <div class="its-heading" id="CM_Contacts_block_grid_container_tbody_expandtr_edit_box_its-heading_{{$index}}">
                                                        <img src="{!URLFOR($Resource.icon_images, 'images/edit_icon.png')}" styleClass="img_action"/>
                                                        <span>Action (1 Available)</span>
                                                    </div>
                                                    <div id="CM_Contacts_block_grid_container_tbody_expandtr_edit_box_its-heading_edit-body_{{$index}}" class="edit-body">
                                                        <form>
                                                            <!-- Edit link as action -->
                                                            <div class="radio" id="CM_Contacts_block_grid_container_tbody_expandtr_edit_box_its-heading_edit-body_{{$index}}_radio_2">
                                                                <label>
                                                                <input type="radio" name="optionsRadios" id="optionsRadios0" value="0"
                                                                    ng-model= "ViewCustomer.TaxExemptions_editRow[$index].radioValue"/>
                                                                <span>
                                                                <i class="fa fa-times"></i>
                                                                    Edit Exemptions
                                                                </span>
                                                                </label> 
                                                            </div>
                                                            <!-- Action button (Go) -->
                                                            <a href="" id="CM_Contacts_block_grid_container_tbody_expandtr_edit_box_its-heading_edit-body_{{$index}}_go_btn" 
                                                                class="btn C11 T4 addmoreinfoBtn editform_btn" role="button"
                                                                ng-click="ViewCustomer.TaxExemption_GoAction($index)">   Go  </a>                                 
                                                        </form>   
                                                    </div>
                                                </div>
                                            </td>
                                            <td style="background:#fff"></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            
                            <!-- Pagination container -->
                            <div class="row pagination_container" id="Contacts_Pagination" style="margin-left: 10px;margin-right: 0;"
                                ng-if="ViewCustomer.TotalTaxExemptionRecords != undefined" >
                                <list-pagination id-value = "Contacts_Pagination_" 
                                                total-records-length = "ViewCustomer.TotalTaxExemptionRecords"
                                                page-size = "ViewCustomer.TaxExemptionPageSortAttrsJSON.PageSize"
                                                current-page = "ViewCustomer.TaxExemptionPageSortAttrsJSON.CurrentPage"
                                                changes-count = "ViewCustomer.TaxExemptionPageSortAttrsJSON.ChangesCount"
                                                pagination-control-method = "ViewCustomer.Contacts_paginationControlsAction" />
                            </div>
                        </div>
                    </div>
                    
                     <!-- END : Tax Exemption -->
                </div>
            </div>
            <!-- <div class="sectionHeader row">
                <div class="col-lg-4 col-lg-5">
                    <div class="fixedHeaderText">
                        <span class="headerlabel">
                        <i class="fa fa-angle-right" style="width:10px; padding: 0 3px;"
                            ng-show="!ViewCustomer.displaySections.ActivityStream"
                            ng-Click="ViewCustomer.displaySections.ActivityStream = true">
                        </i> 
                        <i class="fa fa-angle-down" style="width:10px;"
                            ng-show="ViewCustomer.displaySections.ActivityStream"
                            ng-Click="ViewCustomer.displaySections.ActivityStream = false">
                        </i> 
                        <span class="divider">|</span>
                        <span class="T2">D Activity Stream</span>
                        </span>
                        <span class="ActionIcons pull-right">
                        <i class="fa fa-th"></i>
                        <i class="fa fa-question-circle"></i>
                        </span> 
                    </div>
                </div>
            </div> -->

            <!-- <div id="ActivitySection" >
                <div class="main_section row" ng-show="ViewCustomer.displaySections.ActivityStream">
                    <p class="actionRow T2">
                        <span class="sectionText">Activity Stream</span>
                        <span class="actionText">Actions</span>
                        <span class="ActionIcons">
                        <i class="fa fa-th"></i>
                        <i class="fa fa-question-circle"></i>
                        </span> 
                    </p>
                </div>
            </div> -->

            <div style="height:600px; background: #E6EBEC; margin: 0 -15px;" />
            </div>
        </div>
    </body>
    
    </html>
</apex:page>